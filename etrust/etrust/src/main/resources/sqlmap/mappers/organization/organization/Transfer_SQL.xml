<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.coway.trust.biz.organization.organization.impl.TransferMapper">

	<select id="selectMemberLevel" parameterType="Map" resultType="egovMap">
	<![CDATA[
			SELECT Project1.MEM_ORG_DESC_ID MEM_ORG_DESC_ID  ,
		       Project1.MEM_ORG_LVL CODE_ID  ,
		       Project1.C1 CODE_NAME  
		     FROM ( SELECT Extent1.MEM_ORG_DESC_ID MEM_ORG_DESC_ID  ,
		                Extent1.MEM_ORG_LVL MEM_ORG_LVL  ,
		                utils.str(UTILS.CONVERT_TO_NUMBER(Extent1.MEM_ORG_DESC_ID,19,0)) || ' - ' || Extent1.MEM_ORG_DESC C1  
		         FROM ORG0012D Extent1
		          WHERE  ( Extent1.MEM_ORG_LVL > 0 )
		                   AND ( Extent1.MEM_ORG_LVL < 4 )
		                   AND ( Extent1.MEM_TYPE_ID = #{memberType}) ) Project1
		  ORDER BY Project1.MEM_ORG_LVL ASC
		  ]]>
	</select>
	
	<select id="selectFromTransfer" parameterType="Map" resultType="egovMap">
    <![CDATA[
            SELECT Project1.MEM_ID CODE_ID  ,
		       Project1.MEM_UP_ID MEM_UP_ID  ,
		       Project1.MEM_LVL MEM_LVL  ,
		       Project1.DEPT_CODE DEPT_CODE  ,
		       Project1.ORG_UPD_USER_ID ORG_UPD_USER_ID  ,
		       Project1.ORG_UPD_DT ORG_UPD_DT  ,
		       Project1.PREV_DEPT_CODE PREV_DEPT_CODE  ,
		       Project1.PREV_GRP_CODE PREV_GRP_CODE  ,
		       Project1.PREV_MEM_ID_ID PREV_MEM_ID_ID  ,
		       Project1.PREV_MEM_LVL PREV_MEM_LVL  ,
		       Project1.ORG_STUS_CODE_ID ORG_STUS_CODE_ID  ,
		       Project1.PR_CODE PR_CODE  ,
		       Project1.PR_MEM_ID PR_MEM_ID  ,
		       Project1.GRAND_PR_CODE GRAND_PR_CODE  ,
		       Project1.GRAND_PR_MEM_ID GRAND_PR_MEM_ID  ,
		       Project1.LAST_DEPT_CODE LAST_DEPT_CODE  ,
		       Project1.LAST_GRP_CODE LAST_GRP_CODE  ,
		       Project1.LAST_ORG_CODE LAST_ORG_CODE  ,
		       Project1.LAST_TOP_ORG_CODE LAST_TOP_ORG_CODE  ,
		       Project1.BRNCH_ID BRNCH_ID  ,
		       Project1.MEMBERID1 MEMBERID1  ,
		       Project1.MEM_CODE MEM_CODE  ,
		       Project1.MEM_TYPE MEM_TYPE  ,
		       Project1.NAME NAME  ,
		       Project1.FULL_NAME FULL_NAME  ,
		       Project1.PASSWD PASSWD  ,
		       Project1.NRIC NRIC  ,
		       Project1.DOB DOB  ,
		       Project1.GENDER GENDER  ,
		       Project1.RACE RACE  ,
		       Project1.MARTL MARTL  ,
		       Project1.NATION NATION  ,
		       Project1.ADDR1 ADDR1  ,
		       Project1.ADDR2 ADDR2  ,
		       Project1.ADDR3 ADDR3  ,
		       Project1.ADDR4 ADDR4  ,
		       Project1.AREAL AREAL  ,
		       Project1.POST_CODE POST_CODE  ,
		       Project1.STATE STATE  ,
		       Project1.CNTY CNTY  ,
		       Project1.TEL_OFFICE TEL_OFFICE  ,
		       Project1.TEL_HUSE TEL_HUSE  ,
		       Project1.TEL_MOBILE TEL_MOBILE  ,
		       Project1.EMAIL EMAIL  ,
		       Project1.SPUSE_CODE SPUSE_CODE  ,
		       Project1.SPOUSE_NAME SPOUSE_NAME  ,
		       Project1.SPOUSE_NRIC SPOUSE_NRIC  ,
		       Project1.SPOUSE_OCPAT SPOUSE_OCPAT  ,
		       Project1.SPOUSE_TEL_CNTC SPOUSE_TEL_CNTC  ,
		       Project1.SPOUSE_DOB SPOUSE_DOB  ,
		       Project1.EDC_LEV EDC_LEV  ,
		       Project1.LANG LANG  ,
		       Project1.BANK BANK  ,
		       Project1.BANK_ACC_NO BANK_ACC_NO  ,
		       Project1.SPONS_CODE SPONS_CODE  ,
		       Project1.JOIN_DT JOIN_DT  ,
		       Project1.RESIGN_DT RESIGN_DT  ,
		       Project1.TRM_DT TRM_DT  ,
		       Project1.RENEW_DT RENEW_DT  ,
		       Project1.AGRMNT_NO AGRMNT_NO  ,
		       Project1.BRNCH BRNCH  ,
		       Project1.STUS STUS  ,
		       Project1.SYNC_CHK SYNC_CHK  ,
		       Project1.RANK RANK  ,
		       Project1.TRNSPRT TRNSPRT  ,
		       Project1.PROMO_DT PROMO_DT  ,
		       Project1.TR_NO TR_NO  ,
		       Project1.CRT_DT CRT_DT  ,
		       Project1.CRT_USER_ID CRT_USER_ID  ,
		       Project1.UPD_DT UPD_DT  ,
		       Project1.UPD_USER_ID UPD_USER_ID  ,
		       Project1.MEM_IS_OUT_SRC MEM_IS_OUT_SRC  ,
		       Project1.APLICNT_ID APLICNT_ID  ,
		       Project1.BIZ_TYPE BIZ_TYPE  ,
		       Project1.HSPTLZ HSPTLZ  ,
		       Project1.C1 CODE_NAME 
		  FROM ( SELECT Extent1.MEM_ID MEM_ID  ,
		                Extent1.MEM_UP_ID MEM_UP_ID  ,
		                Extent1.MEM_LVL MEM_LVL  ,
		                Extent1.DEPT_CODE DEPT_CODE  ,
		                Extent1.ORG_UPD_USER_ID ORG_UPD_USER_ID  ,
		                Extent1.ORG_UPD_DT ORG_UPD_DT  ,
		                Extent1.PREV_DEPT_CODE PREV_DEPT_CODE  ,
		                Extent1.PREV_GRP_CODE PREV_GRP_CODE  ,
		                Extent1.PREV_MEM_ID_ID PREV_MEM_ID_ID  ,
		                Extent1.PREV_MEM_LVL PREV_MEM_LVL  ,
		                Extent1.ORG_STUS_CODE_ID ORG_STUS_CODE_ID  ,
		                Extent1.PR_CODE PR_CODE  ,
		                Extent1.PR_MEM_ID PR_MEM_ID  ,
		                Extent1.GRAND_PR_CODE GRAND_PR_CODE  ,
		                Extent1.GRAND_PR_MEM_ID GRAND_PR_MEM_ID  ,
		                Extent1.LAST_DEPT_CODE LAST_DEPT_CODE  ,
		                Extent1.LAST_GRP_CODE LAST_GRP_CODE  ,
		                Extent1.LAST_ORG_CODE LAST_ORG_CODE  ,
		                Extent1.LAST_TOP_ORG_CODE LAST_TOP_ORG_CODE  ,
		                Extent1.BRNCH_ID BRNCH_ID  ,
		                Extent2.MEM_ID MEMBERID1  ,
		                Extent2.MEM_CODE MEM_CODE  ,
		                Extent2.MEM_TYPE MEM_TYPE  ,
		                Extent2.NAME NAME  ,
		                Extent2.FULL_NAME FULL_NAME  ,
		                Extent2.PASSWD PASSWD  ,
		                Extent2.NRIC NRIC  ,
		                Extent2.DOB DOB  ,
		                Extent2.GENDER GENDER  ,
		                Extent2.RACE RACE  ,
		                Extent2.MARTL MARTL  ,
		                Extent2.NATION NATION  ,
		                Extent2.ADDR1 ADDR1  ,
		                Extent2.ADDR2 ADDR2  ,
		                Extent2.ADDR3 ADDR3  ,
		                Extent2.ADDR4 ADDR4  ,
		                Extent2.AREAL AREAL  ,
		                Extent2.POST_CODE POST_CODE  ,
		                Extent2.STATE STATE  ,
		                Extent2.CNTY CNTY  ,
		                Extent2.TEL_OFFICE TEL_OFFICE  ,
		                Extent2.TEL_HUSE TEL_HUSE  ,
		                Extent2.TEL_MOBILE TEL_MOBILE  ,
		                Extent2.EMAIL EMAIL  ,
		                Extent2.SPUSE_CODE SPUSE_CODE  ,
		                Extent2.SPOUSE_NAME SPOUSE_NAME  ,
		                Extent2.SPOUSE_NRIC SPOUSE_NRIC  ,
		                Extent2.SPOUSE_OCPAT SPOUSE_OCPAT  ,
		                Extent2.SPOUSE_TEL_CNTC SPOUSE_TEL_CNTC  ,
		                Extent2.SPOUSE_DOB SPOUSE_DOB  ,
		                Extent2.EDC_LEV EDC_LEV  ,
		                Extent2.LANG LANG  ,
		                Extent2.BANK BANK  ,
		                Extent2.BANK_ACC_NO BANK_ACC_NO  ,
		                Extent2.SPONS_CODE SPONS_CODE  ,
		                Extent2.JOIN_DT JOIN_DT  ,
		                Extent2.RESIGN_DT RESIGN_DT  ,
		                Extent2.TRM_DT TRM_DT  ,
		                Extent2.RENEW_DT RENEW_DT  ,
		                Extent2.AGRMNT_NO AGRMNT_NO  ,
		                Extent2.BRNCH BRNCH  ,
		                Extent2.STUS STUS  ,
		                Extent2.SYNC_CHK SYNC_CHK  ,
		                Extent2.RANK RANK  ,
		                Extent2.TRNSPRT TRNSPRT  ,
		                Extent2.PROMO_DT PROMO_DT  ,
		                Extent2.TR_NO TR_NO  ,
		                Extent2.CRT_DT CRT_DT  ,
		                Extent2.CRT_USER_ID CRT_USER_ID  ,
		                Extent2.UPD_DT UPD_DT  ,
		                Extent2.UPD_USER_ID UPD_USER_ID  ,
		                Extent2.MEM_IS_OUT_SRC MEM_IS_OUT_SRC  ,
		                Extent2.APLICNT_ID APLICNT_ID  ,
		                Extent2.BIZ_TYPE BIZ_TYPE  ,
		                Extent2.HSPTLZ HSPTLZ  ,
		                Extent1.DEPT_CODE || ' - ' || Extent2.NAME C1  
		         FROM ORG0005D Extent1
		                JOIN ORG0001D Extent2   ON Extent1.MEM_ID = Extent2.MEM_ID
		          WHERE  ( Extent1.DEPT_CODE IS NOT NULL )
		                   AND ( '''' <> Extent1.DEPT_CODE )
		                   AND ( 1 = Extent2.STUS )
		                   AND ( Extent2.MEM_TYPE = #{memberType} )
		                   AND ( Extent1.MEM_LVL = #{memberLevel} ) ) Project1
		  ORDER BY Project1.DEPT_CODE ASC
          ]]>
    </select>
    <select id="selectTransferList" parameterType="Map" resultType="egovMap">
		    SELECT Project1.MEM_ID CODE_ID  ,
		       Project1.MEM_CODE MEM_CODE  ,
		       Project1.C1 CODE_NAME  
		  FROM ( SELECT Extent1.MEM_ID MEM_ID  ,
		                Extent1.MEM_CODE MEM_CODE  ,
		                Extent2.DEPT_CODE DEPT_CODE  ,
		                Extent1.MEM_CODE || ' - ' || Extent1.NAME C1  
		         FROM ORG0001D Extent1
		                JOIN ORG0005D Extent2   ON Extent1.MEM_ID = Extent2.MEM_ID
		          WHERE  ( Extent1.STUS IN ( 1,8 )
		                  )
		                   AND ( Extent1.MEM_TYPE =  #{memberType} )
		                   AND ( Extent2.MEM_UP_ID = #{memberUpId} ) ) Project1
		  ORDER BY Project1.DEPT_CODE ASC
		  </select>
</mapper>