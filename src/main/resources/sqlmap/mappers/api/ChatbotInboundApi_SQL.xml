<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.api.impl.ChatbotInboundApiMapper">

    <select id="checkAccess" parameterType="Map" resultType="egovMap">
        SELECT *
        FROM API0001M
        WHERE API_USER_STUS_ID = 1
            AND API_USER_NAME = #{userName}
            AND API_KEY = #{key}
    </select>

    <select id="verifyCustIdentity" parameterType="Map" resultType="egovMap">
        SELECT
		    B.CUST_ID,
		    B.NAME AS CUST_NAME,
		    B.NRIC AS CUST_NRIC,
		    B.NATION AS CUST_NATION,
		    C.CODE AS CUST_TYPE
		FROM SAL0027D A
		JOIN SAL0029D B ON B.CUST_ID = A.CUST_ID
		LEFT JOIN SYS0013M C ON C.CODE_ID = B.TYPE_ID
		WHERE A.STUS_CODE_ID = 9
		AND B.STUS_CODE_ID = 1
		AND (A.TEL_M1 = #{custPhoneNo} OR A.TEL_M1 = #{custPhoneNoWoutCode})
		ORDER BY C.CODE_ID
    </select>
</mapper>
