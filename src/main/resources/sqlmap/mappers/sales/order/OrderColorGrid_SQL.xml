<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.sales.order.impl.OrderColorGridMapper">

  <select id="colorGridList" parameterType="Map" resultType="egovMap">
    SELECT D1.ORD_ID ,
           D1.ORD_NO ,
           D1.APP_TYPE_CODE ,
           D1.CUST_NAME ,
           D1.CUST_IC   ,
           D1.STK_CODE   ,
           D1.SALESMAN_CODE  ,
           D1.TOP_ORG_CODE  ,
           D1.ORG_CODE  ,
           D1.GRP_CODE  ,
           D1.DEPT_CODE  ,
           D1.MEM_CODE ,
           D1.IS_NET  ,
           D1.NET_MONTH   ,
           D1.INSTALL_STUS_ID ,
           D1.INSTALL_STUS ,
           D1.INSTALL_FAIL_RESN,
           D1.COM_DT ,
           D1.PAY_COM_DT ,
           D1.PROMO_CODE ,
           D1.PROMO_DESC ,
      <!-- D1.MAIL_CNT_TEL_M ,
           D1.MAIL_CNT_TEL_O ,
           D1.MAIL_CNT_TEL_R ,
           D1.MAIL_CNT_TEL_F ,
           D1.INST_CNT_TEL_M ,
           D1.INST_CNT_TEL_O ,
           D1.INST_CNT_TEL_R ,
           D1.INST_CNT_TEL_F ,
           D1.CUST_ID , -->
           D1.C1 ,
           D1.ORD_DT ,
           D1.STUS_ID ,
           D1.STUS_CODE ,
           D1.C5 ,
           D1.C6 ,
           D1.C7 ,
           D1.C8 ,
           D1.C9
    FROM ( SELECT DISTINCT F1.OrderID1 ORD_ID ,
                           F1.ORD_NO ,
                           F1.APP_TYPE_CODE ,
                           UPPER(F1.CUST_NAME) CUST_NAME,
                           UPPER(F1.CUST_IC) CUST_IC,
                           F1.STK_CODE ,
                           UPPER(F1.SALESMAN_CODE) SALESMAN_CODE ,
                           F1.TOP_ORG_CODE ,
                           UPPER(F1.ORG_CODE) ORG_CODE ,
                           UPPER(F1.GRP_CODE) GRP_CODE ,
                           UPPER(F1.DEPT_CODE) DEPT_CODE ,
                           F1.MEM_CODE ,
                           F1.IS_NET ,
                           F1.NET_MONTH ,
                           F1.INSTALL_STUS_ID ,
                           F1.INSTALL_STUS ,
                           F1.INSTALL_FAIL_RESN ,
                           F1.COM_DT ,
                           F1.PAY_COM_DT ,
                           UPPER(F1.PROMO_CODE) PROMO_CODE ,
                           F1.PROMO_DESC ,
                      <!-- F1.MAIL_CNT_TEL_M ,
                           F1.MAIL_CNT_TEL_O ,
                           F1.MAIL_CNT_TEL_R ,
                           F1.MAIL_CNT_TEL_F ,
                           F1.INST_CNT_TEL_M ,
                           F1.INST_CNT_TEL_O ,
                           F1.INST_CNT_TEL_R ,
                           F1.INST_CNT_TEL_F ,
                           E4.CUST_ID , -->
                           1 C1 ,
                           CASE WHEN ( F1.ORD_DT IS NOT NULL )
                                  THEN F1.ORD_DT
                                  ELSE TO_DATE('1900-01-01', 'YYYY-MM-DD') END ORD_DT ,
                           CASE WHEN ( F1.STUS_ID IS NOT NULL )
                                  THEN F1.STUS_ID
                                  ELSE 0 END STUS_ID ,
                           CASE WHEN ( F1.STUS_CODE IS NOT NULL )
                                  THEN F1.STUS_CODE
                                  ELSE ' ' END STUS_CODE ,
                           CASE WHEN ( F1.APP_TYPE_ID IS NOT NULL )
                                  THEN F1.APP_TYPE_ID
                                  ELSE 0 END C5 ,
                           CASE WHEN ( F1.STK_ID IS NOT NULL )
                                  THEN F1.STK_ID
                                  ELSE 0 END C6 ,
                           F1.PV_MONTH C7 ,
                           F1.PV_YEAR C8 ,
                           F1.TOT_OTSTND C9
           FROM ( SELECT E1.ORD_ID OrderID1 ,
                         E1.ORD_NO  ,
                         E1.ORD_DT  ,
                         E1.APP_TYPE_ID  ,
                         E1.APP_TYPE_CODE  ,
                         E1.CUST_NAME  ,
                         E1.CUST_IC  ,
                         E1.STK_ID  ,
                         E1.STK_CODE  ,
                         E1.SALESMAN_CODE  ,
                         E1.STUS_ID  ,
                         E1.STUS_CODE  ,
                         E1.TOP_ORG_CODE  ,
                         E1.ORG_CODE  ,
                         E1.GRP_CODE  ,
                         E1.DEPT_CODE  ,
                         E1.MEM_CODE,
                         E1.IS_NET  ,
                         E1.NET_MONTH  ,
                         E1.PV_MONTH  ,
                         E1.PV_YEAR  ,
                         E1.INSTALL_STUS_ID  ,
                         E1.INSTALL_STUS  ,
                         E1.INSTALL_FAIL_RESN  ,
                         E1.COM_DT  ,
                         E1.PAY_COM_DT  ,
                         E1.TOT_OTSTND  ,
                         E1.PROMO_CODE  ,
                         E1.PROMO_DESC ,
                         1
                    <!-- E2.MAIL_CNT_TEL_M  ,
                         E2.MAIL_CNT_TEL_O  ,
                         E2.MAIL_CNT_TEL_R  ,
                         E2.MAIL_CNT_TEL_F  ,
                         E3.INST_CNT_TEL_M ,
                         E3.INST_CNT_TEL_O ,
                         E3.INST_CNT_TEL_R ,
                         E3.INST_CNT_TEL_F  -->
                         FROM (

                         <!-- SELECT FROM VIEW SUBSTITUE (SAL1008V) -->
                         SELECT * FROM (
                         SELECT  som.SALES_ORD_ID ORD_ID,
                              som.SALES_ORD_NO ORD_NO,
                              som.SALES_DT ORD_DT,
                              som.APP_TYPE_ID,
                              apptype.CODE APP_TYPE_CODE,
                              c.NAME CUST_NAME,
                              c.NRIC CUST_IC,
                              sod.ITM_STK_ID STK_ID,
                              '( ' || stk.STK_CODE || ' ) ' || stk.STK_DESC STK_CODE,
                              NVL (mem.MEM_CODE, ' ') SALESMAN_CODE,
                              som.STUS_CODE_ID STUS_ID,
                              S.CODE STUS_CODE,
                              NVL (mo.TOP_ORG_CODE, ' ') TOP_ORG_CODE,
                              NVL (mo.ORG_CODE, ' ') ORG_CODE,
                              NVL (mo.GRP_CODE, ' ') GRP_CODE,
                              NVL (mo.DEPT_CODE, ' ') DEPT_CODE,
                              NVL (mo.MEM_CODE, ' ') MEM_CODE,

                              (CASE WHEN NVL (som.PV_MONTH, 0) <![CDATA[>]]> 0 THEN 1 ELSE 0 END) IS_NET,
                              (CASE
                                  WHEN NVL (som.PV_MONTH, 0) <![CDATA[>]]> 0
                                  THEN
                                     (CASE
                                         WHEN NVL(som.PV_MONTH, 0) <![CDATA[<]]> 10
                                         THEN
                                               '0'
                                            || NVL (som.PV_MONTH, 0)
                                            || '/'
                                            || NVL (som.PV_YEAR, 0)
                                         ELSE
                                            NVL (som.PV_MONTH, 0) || '/' || NVL (som.PV_YEAR, 0)
                                      END)
                                  ELSE
                                     '-'
                               END)
                                 NET_MONTH,
                              NVL (som.PV_MONTH, 0) PV_MONTH,
                              NVL (som.PV_YEAR, 0) PV_YEAR,
                              NVL (ie.STUS_CODE_ID, 0) INSTALL_STUS_ID,
                              NVL (instStatus.CODE, '-') INSTALL_STUS,
                              NVL (instReason.RESN_DESC, '-') INSTALL_FAIL_RESN,
                              NVL (som.COMM_DT, TO_DATE ('01/01/1900', 'dd/mm/yyyy')) COM_DT,
                              NVL (som.PAY_COM_DT, TO_DATE ('01/01/1900', 'dd/mm/yyyy'))
                                 PAY_COM_DT,
                              0 TOT_CNT,
                              0 TOT_OTSTND,
                              NVL (promo.PROMO_CODE, ' ') PROMO_CODE,
                              NVL (promo.PROMO_DESC, ' ') PROMO_DESC,
                              som.MEM_ID,
                              mem.MEM_TYPE,
                              C.TYPE_ID CUST_TYPE_ID,
                              C.CORP_TYPE_ID,
                              CASE
                                WHEN NVL(som.PCKAGE_BINDING_NO,0) > 0 THEN 3
                                ELSE NVL(SOM.EX_TRADE,0) END SALES_TYPE,
                              som.PRE_ORD_ID ,
                              som.ECOMM_ORD_ID
                             ,
                          stk.STK_CTGRY_ID

                         FROM SAL0001D som
                              JOIN SAL0002D sod ON som.SALES_ORD_ID = sod.SALES_ORD_ID
                              JOIN SYS0038M S ON S.STUS_CODE_ID = som.STUS_CODE_ID
                              JOIN SYS0026M stk ON stk.STK_ID = sod.ITM_STK_ID
                              JOIN SYS0013M apptype ON apptype.CODE_ID = som.APP_TYPE_ID
                              JOIN SAL0029D c ON c.CUST_ID = som.CUST_ID
                              JOIN ORG1001V mo ON mo.MEM_ID = som.MEM_ID
                              LEFT JOIN ORG0001D mem ON mem.MEM_ID = som.MEM_ID
                              LEFT JOIN SAL0017D promo ON promo.PROMO_ID = som.PROMO_ID
                              LEFT JOIN
                              SAL0046D ie
                                 ON     ie.SALES_ORD_ID = som.SALES_ORD_ID
                                    AND ie.INSTALL_ENTRY_ID =
                                           FN_GET_SAL0046D_MAX_ID (som.SALES_ORD_ID, '3')
                              LEFT JOIN SAL0047D ir ON ir.ENTRY_ID = ie.INSTALL_ENTRY_ID AND ir.STUS_CODE_ID <![CDATA[<>]]> 8
                              LEFT JOIN SYS0038M instStatus
                                 ON instStatus.STUS_CODE_ID = ir.STUS_CODE_ID
                              LEFT JOIN SYS0032M instReason ON instReason.RESN_ID = ir.FAIL_ID
                              WHERE (som.STUS_CODE_ID <![CDATA[<>]]> 8)
                              AND som.APP_TYPE_ID <![CDATA[<>]]> 5764

                        <if test="cmbAppTypeList != null and cmbAppTypeList != ''">
                          AND som.APP_TYPE_ID IN
                            <foreach item="item" collection="cmbAppTypeList" index="index" open="(" separator="," close=")">
                              #{item}
                            </foreach>
                        </if>
                        <if test="cmbCondition != null and cmbCondition != ''">
                        AND
                        <foreach item="item" collection="cmbCondition" index="index" open="(" separator="OR" close=")">

                          <if test="item == 1 ">
                              ( som.STUS_CODE_ID = 1 )
                          </if>
                          <if test="item == 2 ">
                              ( som.STUS_CODE_ID = 10 )
                          </if>
                          <if test="item == 3 ">
                             (
                                    som.STUS_CODE_ID = 4
                                AND NVL (som.PV_YEAR, 0) <![CDATA[>]]> 0
                                AND NVL (som.PV_MONTH, 0) <![CDATA[>]]> 0
                              )
                          </if>
                          <if test="item == 4 ">
                             (
                                    som.STUS_CODE_ID = 4
                                AND NVL (som.PV_YEAR, 0) = 0
                                AND NVL (som.PV_MONTH, 0) = 0
                              )
                          </if>
                          <if test="item == 5 ">
                             (
                                    NVL (ie.STUS_CODE_ID, 0) = 21
                                AND som.STUS_CODE_ID != 10
                              )
                          </if>
                          <if test="item == 6 ">
                             (
                                    NVL (ie.STUS_CODE_ID, 0) = 1
                                AND som.STUS_CODE_ID != 10
                              )
                          </if>
                        </foreach>

                        </if>

                        <if test="orgCode != null and orgCode != ''">
                            AND NVL (mo.ORG_CODE, '') = #{orgCode}
                          </if>
                          <if test="grpCode != null and grpCode != ''">
                            AND NVL (mo.GRP_CODE, '') = #{grpCode}
                          </if>
                          <if test="deptCode != null and deptCode != ''">
                            AND NVL (mo.DEPT_CODE, '') = #{deptCode}
                          </if>
<!--                           <if test="memCode != null and memCode != ''" > -->
<!--                             AND NVL (mo.MEM_CODE, ' ') = #{memCode} -->
<!--                           </if> -->
                           <if test="memID!= null and memID != ''" >
                            AND NVL (mo.MEM_ID, '') = #{memID}
                          </if>
                          <if test="ordNo != null and ordNo != ''">
                            AND som.SALES_ORD_NO = #{ordNo}
                          </if>
                          <if test="custName != null and custName != ''">
                            AND c.NAME LIKE '%'|| #{custName} || '%'
                          </if>
                          <if test="custIc != null and custIc != ''">
                            AND c.NRIC LIKE '%'|| #{custIc} || '%'
                          </if>
                          <if test="createStDate != null and createStDate != ''">
                            AND som.SALES_DT <![CDATA[>=]]> TO_DATE(#{createStDate}||' 00:00:00', 'DD/MM/YYYY HH24:MI:SS')
                          </if>
                          <if test="createEnDate != null and createEnDate != ''">
                            AND som.SALES_DT <![CDATA[<=]]> TO_DATE(#{createEnDate} ||' 23:59:59', 'DD/MM/YYYY HH24:MI:SS')
                          </if>
                          <if test="cmbProduct != null and cmbProduct != ''">
                            <!-- AND E1.STK_ID = #{cmbProduct} -->
                              AND sod.ITM_STK_ID IN
                              <foreach item="item" collection="cmbProduct" index="index" open="(" separator="," close=")">
                                    #{item}
                              </foreach>
                          </if>
                          <if test="netSalesMonth != null and netSalesMonth != ''">
                          <!-- AND E1.PV_YEAR = #{pvYear}
                               AND E1.PV_MONTH = #{pvMonth} -->
                            AND NVL (som.PV_YEAR, 0) = EXTRACT(YEAR FROM TO_DATE(#{netSalesMonth},'MM/YYYY'))
                            AND NVL (som.PV_MONTH, 0) = EXTRACT(MONTH FROM TO_DATE(#{netSalesMonth},'MM/YYYY'))
                          </if>
                          <if test="salesmanCode != null and salesmanCode != ''">
                            AND NVL (mem.MEM_CODE, '') = #{salesmanCode}
                          </if>
                          <if test="promoCode != null and promoCode != ''">
                            AND NVL (promo.PROMO_CODE, '') = #{promoCode}
                          </if>
                          <if test="memtype != null and memtype != ''">
                            AND mem.MEM_TYPE = #{memtype}
                          </if>
                          <if test="cmbCustomerType != null and cmbCustomerType != ''">
                              AND C.TYPE_ID IN
                              <foreach item="item" collection="cmbCustomerType" index="index" open="(" separator="," close=")">
                                    #{item}
                              </foreach>
                          </if>
                          <if test="cmbCorpTypeId != null and cmbCorpTypeId != ''">
                              AND C.CORP_TYPE_ID IN
                              <choose>
                              <when test="Individual !=null and Individual !=''">
                                  <foreach item="item" collection="cmbCorpTypeId" index="index" open="(" separator="," close=" ">
                                      #{item}
                                  </foreach>
                                   ,0)
                              </when>
                              <otherwise>
                                  <foreach item="item" collection="cmbCorpTypeId" index="index" open="(" separator="," close=")">
                                      #{item}
                                 </foreach>
                              </otherwise>
                             </choose>
                          </if>

                        <if test="cmbProductCtgry != null and cmbProductCtgry != ''">
                          AND stk.STK_CTGRY_ID IN
                            <foreach item="item" collection="cmbProductCtgry" index="index" open="(" separator="," close=")">
                              #{item}
                            </foreach>
                        </if>

                        <if test='isEKeyin != null and isEKeyin != ""'>
                           AND NVL(som.PRE_ORD_ID,0) > 0
                         </if>
                         <if test='isECommerce != null and isECommerce != ""'>
                           AND NVL(som.ECOMM_ORD_ID,0) > 0
                         </if>
                         ) E
                         <if test="cmbSalesType != null and cmbSalesType != ''">
                          WHERE E.SALES_TYPE IN
                            <foreach item="item" collection="cmbSalesType" index="index" open="(" separator="," close=")">
                              #{item}
                            </foreach>
                        </if>

                         <!-- SELECT vC.ORD_ID ,
                                       vC.ORD_NO ,
                                       vC.ORD_DT ,
                                       vC.APP_TYPE_ID ,
                                       vC.APP_TYPE_CODE ,
                                       vC.CUST_NAME ,
                                       vC.CUST_IC ,
                                       vC.STK_ID ,
                                       vC.STK_CODE ,
                                       vC.SALESMAN_CODE ,
                                       vC.STUS_ID ,
                                       vC.STUS_CODE ,
                                       vC.TOP_ORG_CODE ,
                                       vC.ORG_CODE ,
                                       vC.GRP_CODE ,
                                       vC.DEPT_CODE ,
                                       vC.MEM_CODE ,
                                       vC.IS_NET ,
                                       vC.NET_MONTH ,
                                       vC.PV_MONTH ,
                                       vC.PV_YEAR ,
                                       vC.INSTALL_STUS_ID ,
                                       vC.INSTALL_STUS ,
                                       vC.INSTALL_FAIL_RESN ,
                                       vC.COM_DT ,
                                       vC.PAY_COM_DT ,
                                       vC.TOT_CNT ,
                                       vC.TOT_OTSTND ,
                                       vC.PROMO_CODE ,
                                       vC.PROMO_DESC ,
                                       vC.MEM_TYPE ,
                                       vC.CUST_TYPE_ID ,
                                       vC.CORP_TYPE_ID ,
                                       vC.SALES_TYPE ,
                                       vC.PRE_ORD_ID ,
                                       vC.ECOMM_ORD_ID ,
                                       vC.STK_CTGRY_ID
                                FROM SAL1008V vC --> <!-- Optimization - change to direct call from sub query than from view. Hui Ding 2021-09-23-->

                                 ) E1

                        <if test="contactNum != null and contactNum != ''">
                        /*
                          JOIN (SELECT vM.ORD_ID
                                FROM SAL1011V vM
                                WHERE vM.MAIL_CNT_TEL_M = contactNum
                                   OR vM.MAIL_CNT_TEL_O = contactNum
                                   OR vM.MAIL_CNT_TEL_F = contactNum
                                   OR vM.MAIL_CNT_TEL_R = contactNum
                          ) E2 ON E2.ORD_ID = E1.ORD_ID
                          JOIN ( SELECT vI.ORD_ID
                                 FROM SAL1010V vI
                                 WHERE vI.INST_CNT_TEL_M = contactNum
                                    OR vI.INST_CNT_TEL_F = contactNum
                                    OR vI.INST_CNT_TEL_O = contactNum
                                    OR vI.INST_CNT_TEL_R = contactNum
                          ) E3 ON E3.ORD_ID = E1.ORD_ID
                        */
                        JOIN (
                            SELECT A.SALES_ORD_ID
                            FROM SAL0001D A
                            JOIN SAL0027D C ON A.CUST_CNT_ID = C.CUST_CNTC_ID
                            WHERE TEL_M1 = #{contactNum}
                            OR TEL_O = #{contactNum}
                            OR TEL_R = #{contactNum}
                            OR TELF = #{contactNum}
                        ) E2 ON E2.SALES_ORD_ID = E1.ORD_ID
                        JOIN (
                            SELECT A.SALES_ORD_ID
                            FROM sal0045d A
                            JOIN SAL0027D B ON B.CUST_CNTC_ID = A.CNT_ID
                            WHERE B.TEL_M1 = #{contactNum}
                            OR B.TEL_O = #{contactNum}
                            OR B.TEL_R = #{contactNum}
                            OR B.TELF = #{contactNum}
                        ) E3 ON E3.SALES_ORD_ID = E1.ORD_ID
                        </if>

                        <!-- JOIN ( SELECT vM.ORD_ID ,
                                      vM.MAIL_CNTY ,
                                      vM.MAIL_STATE ,
                                      vM.MAIL_AREA ,
                                      vM.MAIL_POST_CODE ,
                                      vM.MAIL_CNT_NAME ,
                                      vM.MAIL_CNT_NRIC ,
                                      vM.MAIL_CNT_EMAIL ,
                                      vM.MAIL_CNT_TEL_M ,
                                      vM.MAIL_CNT_TEL_O ,
                                      vM.MAIL_CNT_TEL_R ,
                                      vM.MAIL_CNT_TEL_F ,
                                      vM.MAIL_CNT_GENDER ,
                                      vM.BILL_GRP_NO ,
                                      vM.BILL_STATE_EMAIL ,
                                      vM.BILL_STATE ,
                                      vM.BILL_SMS ,
                                      vM.BILL_POST ,
                                      vM.MAIL_CNTC_ID ,
                                      vM.MAIL_ADDR_ID ,
                                      vM.MAIL_CNT_DEPT ,
                                      vM.MAIL_CNT_POST
                               FROM SAL1011V vM ) E2 ON E2.ORD_ID = E1.ORD_ID
                        JOIN ( SELECT vI.ORD_ID ,
                                      vI.INST_COUNTRY ,
                                      vI.INST_STATE ,
                                      vI.INST_AREA ,
                                      vI.INST_POSTCODE ,
                                      vI.INST_CNT_NAME ,
                                      vI.INST_CNT_NRIC ,
                                      vI.INST_CNT_EMAIL ,
                                      vI.INST_CNT_TEL_M ,
                                      vI.INST_CNT_TEL_O ,
                                      vI.INST_CNT_TEL_R ,
                                      vI.INST_CNT_TEL_F ,
                                      vI.INST_CNT_GENDER ,
                                      vI.FIRST_INSTALL_NO ,
                                      vI.FIRST_INSTALL_CT_CODE ,
                                      vI.FIRST_INSTALL_CT_NAME ,
                                      vI.FIRST_INSTALL_DT ,
                                      vI.FIRST_INSTALL_REM ,
                                      vI.FIRST_INSTALL_SIRIM_NO ,
                                      vI.FIRST_INSTALL_SERIAL_NO ,
                                      vI.LAST_INSTALL_NO ,
                                      vI.LAST_INSTALL_CT_CODE ,
                                      vI.LAST_INSTALL_CT_NAME ,
                                      vI.LAST_INSTALL_DT ,
                                      vI.LAST_INSTALL_REM ,
                                      vI.LAST_INSTALL_SIRIM_NO ,
                                      vI.LAST_INSTALL_SERIAL_NO ,
                                      vI.DSC_ID ,
                                      vI.DSC_CODE ,
                                      vI.DSC_NAME ,
                                      vI.INSTCT ,
                                      vI.PREFER_INST_DT ,
                                      vI.PREFER_INST_TM ,
                                      vI.INSTALL_ADDR_ID ,
                                      vI.INSTALL_CNTC_ID ,
                                      vI.INST_CNT_DEPT ,
                                      vI.INST_CNT_POST ,
                                      vI.VRIFY_REM
                                FROM SAL1010V vI ) E3 ON E3.ORD_ID = E1.ORD_ID -->

                        <!--WHERE  1 = 1


                         <if test="cmbCondition == 1 ">
                            AND E1.STUS_ID = 1
                        </if>
                        <if test="cmbCondition == 2 ">
                          AND E1.STUS_ID = 10
                        </if>
                        <if test="cmbCondition == 3 ">
                            AND E1.STUS_ID = 4
                            AND E1.PV_YEAR <![CDATA[>]]> 0
                            AND E1.PV_MONTH <![CDATA[>]]> 0
                        </if>
                        <if test="cmbCondition == 4 ">
                            AND E1.STUS_ID = 4
                            AND E1.PV_YEAR = 0
                            AND E1.PV_MONTH = 0
                        </if>
                        <if test="cmbCondition == 5 ">
                            AND E1.INSTALL_STUS_ID = 21
                            AND E1.STUS_ID != 10
                        </if>
                        <if test="cmbCondition == 6 ">
                            AND E1.INSTALL_STUS_ID = 1
                            AND E1.STUS_ID != 10
                        </if> -->




           ) F1
          <!--   LEFT JOIN ORG0001D MEM ON MEM.MEM_CODE = F1.MEM_CODE
           JOIN SYS0013M S13 ON S13.CODE_ID = MEM.MEM_TYPE AND CODE_MASTER_ID = 1
           JOIN SAL0029D S29 ON S29.NRIC = F1.CUST_IC-->
          WHERE 1 = 1
           <!-- <if test="memtype != null and memtype != ''">
            AND MEM_TYPE = #{memtype}
          </if> -->
    ) D1
    ORDER BY D1.ORD_ID DESC
  </select>

  <select id="colorGridCmbProduct" resultType="egovMap">
    SELECT S.STK_ID CODE_ID
         , S.STK_CODE || ' - ' || S.STK_DESC CODE_NAME
         , C.CODE_NAME GROUP_CD
    FROM SYS0026M S, SAL0016M P, SYS0013M C
    WHERE S.STK_ID = P.STK_ID
      AND S.STK_CTGRY_ID = C.CODE_ID
      AND S.IS_NCV <![CDATA[<>]]> 1
      AND S.STUS_CODE_ID = 1
      AND S.STK_TYPE_ID = 61
      AND P.AMT <![CDATA[>]]> 0
    GROUP BY s.STK_ID,
             s.STK_CODE,
             s.STK_DESC,
             c.CODE_NAME
    ORDER BY c.CODE_NAME,
             s.STK_DESC
  </select>

    <select id="getMemID" parameterType="Map" resultType="String">
    SELECT E1.MEM_ID
    FROM ORG0001D E1
    WHERE 1=1
     <if test="memCode != null and memCode != ''" >
           AND  E1.MEM_CODE = #{memCode}
      </if>
  </select>


</mapper>