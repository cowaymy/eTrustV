<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.sales.ccpApi.impl.PreCcpRegisterApiMapper">

<select id="selectPreCcpRegisterList" parameterType="Map" resultType="egovMap">
		SELECT
		      PRECCP_SEQ
		    , CUST_NAME
		    , CUST_IC
		    , CUST_MOBILENO
		    , CUST_EMAIL
		    , TO_CHAR(CRT_DT,'YYYY/MM/DD') CRT_DT
		    , CASE WHEN CHS_STATUS = 'GREEN'   THEN CHS_STATUS
		           WHEN CHS_STATUS = 'YELLOW'  THEN CHS_STATUS || '_' || CHS_RSN
		                                       ELSE '-'
		      END CHS_STATUS
		    , TO_CHAR(CRT_DT,'YYYY/MM/DD') CRT_DT
		    , CUST_ID
		FROM SAL0343D
		WHERE DISAB = 0
		 <if test="reqstDtFrom != null and reqstDtFrom != '' and reqstDtTo != null and reqstDtTo != ''">
            AND TO_CHAR(CRT_DT, 'YYYYMMDD') BETWEEN #{reqstDtFrom} AND #{reqstDtTo}
        </if>
        <if test="selectType != null and selectType != '' ">
            <choose>
                <when test='selectType.equals("1") and selectKeyword != null and selectKeyword != ""'>
                    AND CUST_NAME LIKE  '%' || #{selectKeyword} || '%'
                </when>
                <when test='selectType.equals("2") and selectKeyword != null and selectKeyword != ""'>
                    AND CUST_IC LIKE  '%' || #{selectKeyword} || '%'
                </when>
            </choose>
        </if>
</select>

</mapper>