<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.scm.impl.ScmReportMapper">

<!-- Business Plan Report -->
<select id="selectPlanVer" parameterType="Map" resultType="egovMap">
SELECT CASE WHEN A.ID = 1 THEN CASE WHEN A.ID = B.ID THEN B.ID ELSE A.ID END
            ELSE B.ID END AS ID
     , CASE WHEN A.ID = 1 THEN CASE WHEN A.ID = B.ID THEN B.NAME ELSE A.NAME END
            ELSE B.NAME END AS NAME
  FROM (SELECT 1 AS ID, '[1]' AS NAME FROM DUAL) A
  FULL OUTER JOIN (
        SELECT A.VER AS ID
             , '[' || A.VER || '] - ' || TO_CHAR(A.CRT_DT, 'DD/MM/YYYY') AS NAME
          FROM SCM0061M A
         WHERE A.YEAR = #{planYear}
        ) B ON (A.ID = B.ID)
 ORDER BY A.ID
</select>
<select id="selectBusinessPlanSummary" parameterType="Map" resultType="egovMap">
</select>
<select id="selectBusinessPlanDetail" parameterType="Map" resultType="egovMap">
</select>

<!-- Sales Plan Accuracy -->
<select id="selectSalesAccuracyWeeklyDetailHeader" parameterType="Map" resultType="egovMap">
SELECT TEAM
     , STOCK_CODE
     , SALES_ORD_QTY
     , SALES_ACC_PER
     , START_WEEK
     , END_WEEK
     , W1_SCM_WEEK, W2_SCM_WEEK, W3_SCM_WEEK, W4_SCM_WEEK, W5_SCM_WEEK, W6_SCM_WEEK, W7_SCM_WEEK, W8_SCM_WEEK, W9_SCM_WEEK
     , W10_SCM_WEEK, W11_SCM_WEEK, W12_SCM_WEEK, W13_SCM_WEEK, W14_SCM_WEEK, W15_SCM_WEEK, W16_SCM_WEEK
  FROM (
        SELECT DECODE(A.RNO, 1, '1', 2, '2', 3, '3', 4, '4', 5, '5', 6, '6', 7, '7', 8, '8', 9, '9'
                           , 10, '10', 11, '11', 12, '12', 13, '13', 14, '14', 15, '15', 16, '16') AS RNO
             , A.TEAM, A.STOCK_CODE, A.SALES_ORD_QTY, A.SALES_ACC_PER, A.START_WEEK, A.END_WEEK, A.SCM_WEEK
          FROM (
                SELECT ROW_NUMBER() OVER (PARTITION BY A.SCM ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC) AS RNO
                     , 'team' AS TEAM
                     , 'stockCode' AS STOCK_CODE
                     , 'salesOrdQty' AS SALES_ORD_QTY
                     , 'salesAccPer' AS SALES_ACC_PER
                     , 'startWeek' AS START_WEEK
                     , 'endWeek' AS END_WEEK
                     , 'W' || LPAD(A.SCM_WEEK, 2, '0') AS SCM_WEEK
                  FROM (
                        SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK, 1 AS SCM
                          FROM SCM0018M A
                             , (
                                SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
                                     , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
                                  FROM (
                                        SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                                          FROM SCM0018M A
                                         WHERE A.SCM_YEAR = #{weeklyCalcYear}
                                           AND A.SCM_WEEK = #{weeklyCalcWeek}
                                        ) A
                                ) B
                         WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
                           AND A.SCM_MONTH || A.SCM_WEEK != '121'
                        ) A
                ) A
        )
 PIVOT (
        MAX(SCM_WEEK) SCM_WEEK
        FOR RNO IN (1 AS W1, 2 AS W2, 3 AS W3, 4 AS W4, 5 AS W5, 6 AS W6, 7 AS W7, 8 AS W8, 9 AS W9
                  , 10 AS W10, 11 AS W11, 12 AS W12, 13 AS W13, 14 AS W14, 15 AS W15, 16 AS W16)
        )
</select>
<select id="selectSalesAccuracyMonthlyDetailHeader" parameterType="Map" resultType="egovMap">
SELECT TEAM
     , STOCK_CODE
     , SALES_ORD_QTY
     , SALES_ACC_PER
     , START_WEEK
     , END_WEEK
     , W1_SCM_WEEK, W2_SCM_WEEK, W3_SCM_WEEK, W4_SCM_WEEK, W5_SCM_WEEK, W6_SCM_WEEK, W7_SCM_WEEK, W8_SCM_WEEK, W9_SCM_WEEK
     , W10_SCM_WEEK, W11_SCM_WEEK, W12_SCM_WEEK, W13_SCM_WEEK, W14_SCM_WEEK, W15_SCM_WEEK, W16_SCM_WEEK
  FROM (
        SELECT DECODE(A.RNO, 1, '1', 2, '2', 3, '3', 4, '4', 5, '5', 6, '6', 7, '7', 8, '8', 9, '9'
                           , 10, '10', 11, '11', 12, '12', 13, '13', 14, '14', 15, '15', 16, '16') AS RNO
             , A.TEAM, A.STOCK_CODE, A.SALES_ORD_QTY, A.SALES_ACC_PER, A.START_WEEK, A.END_WEEK, A.SCM_WEEK
          FROM (
                SELECT ROW_NUMBER() OVER (PARTITION BY A.SCM ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC) AS RNO
                     , 'team' AS TEAM
                     , 'stockCode' AS STOCK_CODE
                     , 'salesOrdQty' AS SALES_ORD_QTY
                     , 'salesAccPer' AS SALES_ACC_PER
                     , 'startWeek' AS START_WEEK
                     , 'endWeek' AS END_WEEK
                     , 'W' || LPAD(A.SCM_WEEK, 2, '0') AS SCM_WEEK
                  FROM (
                        SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK, 1 AS SCM
                          FROM SCM0018M A
                             , (
                                SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
                                     , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
                                  FROM (
                                        SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                                          FROM SCM0018M A
                                         WHERE A.SCM_YEAR = #{monthlyCalcYear}
                                           AND A.SCM_MONTH = #{monthlyCalcMonth}
                                           AND A.IS_SPLT = 0
                                        ) A
                                ) B
                         WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
                           AND A.SCM_MONTH || A.SCM_WEEK != '121'
                        ) A
                ) A
        )
 PIVOT (
        MAX(SCM_WEEK) SCM_WEEK
        FOR RNO IN (1 AS W1, 2 AS W2, 3 AS W3, 4 AS W4, 5 AS W5, 6 AS W6, 7 AS W7, 8 AS W8, 9 AS W9
                  , 10 AS W10, 11 AS W11, 12 AS W12, 13 AS W13, 14 AS W14, 15 AS W15, 16 AS W16)
        )
</select>
<select id="selectSalesPlanAccuracyWeeklySummary" parameterType="Map" resultType="egovMap">
SELECT A.ORD, A.TEAM, A.YEAR AS PLAN_YEAR
     , A.W1, A.W2, A.W3, A.W4, A.W5, A.W6, A.W7, A.W8, A.W9, A.W10
     , A.W11, A.W12, A.W13, A.W14, A.W15, A.W16, A.W17, A.W18, A.W19, A.W20
     , A.W21, A.W22, A.W23, A.W24, A.W25, A.W26, A.W27, A.W28, A.W29, A.W30
     , A.W31, A.W32, A.W33, A.W34, A.W35, A.W36, A.W37, A.W38, A.W39, A.W40
     , A.W41, A.W42, A.W43, A.W44, A.W45, A.W46, A.W47, A.W48, A.W49, A.W50
     , A.W41, A.W42
  FROM (
        SELECT 1 AS ORD, 'DST' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 1 AND A.YEAR = Z.YEAR) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 2 AND A.YEAR = Z.YEAR) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 3 AND A.YEAR = Z.YEAR) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 4 AND A.YEAR = Z.YEAR) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 5 AND A.YEAR = Z.YEAR) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 6 AND A.YEAR = Z.YEAR) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 7 AND A.YEAR = Z.YEAR) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 8 AND A.YEAR = Z.YEAR) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 9 AND A.YEAR = Z.YEAR) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 10 AND A.YEAR = Z.YEAR) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 11 AND A.YEAR = Z.YEAR) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 12 AND A.YEAR = Z.YEAR) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 13 AND A.YEAR = Z.YEAR) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 14 AND A.YEAR = Z.YEAR) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 15 AND A.YEAR = Z.YEAR) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 16 AND A.YEAR = Z.YEAR) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 17 AND A.YEAR = Z.YEAR) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 18 AND A.YEAR = Z.YEAR) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 19 AND A.YEAR = Z.YEAR) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 20 AND A.YEAR = Z.YEAR) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 21 AND A.YEAR = Z.YEAR) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 22 AND A.YEAR = Z.YEAR) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 23 AND A.YEAR = Z.YEAR) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 24 AND A.YEAR = Z.YEAR) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 25 AND A.YEAR = Z.YEAR) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 26 AND A.YEAR = Z.YEAR) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 27 AND A.YEAR = Z.YEAR) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 28 AND A.YEAR = Z.YEAR) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 29 AND A.YEAR = Z.YEAR) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 30 AND A.YEAR = Z.YEAR) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 31 AND A.YEAR = Z.YEAR) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 32 AND A.YEAR = Z.YEAR) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 33 AND A.YEAR = Z.YEAR) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 34 AND A.YEAR = Z.YEAR) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 35 AND A.YEAR = Z.YEAR) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 36 AND A.YEAR = Z.YEAR) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 37 AND A.YEAR = Z.YEAR) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 38 AND A.YEAR = Z.YEAR) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 39 AND A.YEAR = Z.YEAR) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 40 AND A.YEAR = Z.YEAR) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 41 AND A.YEAR = Z.YEAR) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 42 AND A.YEAR = Z.YEAR) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 43 AND A.YEAR = Z.YEAR) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 44 AND A.YEAR = Z.YEAR) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 45 AND A.YEAR = Z.YEAR) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 46 AND A.YEAR = Z.YEAR) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 47 AND A.YEAR = Z.YEAR) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 48 AND A.YEAR = Z.YEAR) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 49 AND A.YEAR = Z.YEAR) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 50 AND A.YEAR = Z.YEAR) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 51 AND A.YEAR = Z.YEAR) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 52 AND A.YEAR = Z.YEAR) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 2 AS ORD, 'CODY' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 1 AND A.YEAR = Z.YEAR) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 2 AND A.YEAR = Z.YEAR) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 3 AND A.YEAR = Z.YEAR) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 4 AND A.YEAR = Z.YEAR) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 5 AND A.YEAR = Z.YEAR) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 6 AND A.YEAR = Z.YEAR) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 7 AND A.YEAR = Z.YEAR) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 8 AND A.YEAR = Z.YEAR) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 9 AND A.YEAR = Z.YEAR) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 10 AND A.YEAR = Z.YEAR) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 11 AND A.YEAR = Z.YEAR) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 12 AND A.YEAR = Z.YEAR) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 13 AND A.YEAR = Z.YEAR) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 14 AND A.YEAR = Z.YEAR) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 15 AND A.YEAR = Z.YEAR) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 16 AND A.YEAR = Z.YEAR) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 17 AND A.YEAR = Z.YEAR) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 18 AND A.YEAR = Z.YEAR) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 19 AND A.YEAR = Z.YEAR) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 20 AND A.YEAR = Z.YEAR) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 21 AND A.YEAR = Z.YEAR) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 22 AND A.YEAR = Z.YEAR) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 23 AND A.YEAR = Z.YEAR) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 24 AND A.YEAR = Z.YEAR) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 25 AND A.YEAR = Z.YEAR) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 26 AND A.YEAR = Z.YEAR) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 27 AND A.YEAR = Z.YEAR) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 28 AND A.YEAR = Z.YEAR) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 29 AND A.YEAR = Z.YEAR) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 30 AND A.YEAR = Z.YEAR) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 31 AND A.YEAR = Z.YEAR) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 32 AND A.YEAR = Z.YEAR) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 33 AND A.YEAR = Z.YEAR) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 34 AND A.YEAR = Z.YEAR) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 35 AND A.YEAR = Z.YEAR) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 36 AND A.YEAR = Z.YEAR) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 37 AND A.YEAR = Z.YEAR) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 38 AND A.YEAR = Z.YEAR) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 39 AND A.YEAR = Z.YEAR) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 40 AND A.YEAR = Z.YEAR) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 41 AND A.YEAR = Z.YEAR) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 42 AND A.YEAR = Z.YEAR) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 43 AND A.YEAR = Z.YEAR) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 44 AND A.YEAR = Z.YEAR) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 45 AND A.YEAR = Z.YEAR) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 46 AND A.YEAR = Z.YEAR) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 47 AND A.YEAR = Z.YEAR) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 48 AND A.YEAR = Z.YEAR) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 49 AND A.YEAR = Z.YEAR) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 50 AND A.YEAR = Z.YEAR) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 51 AND A.YEAR = Z.YEAR) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 52 AND A.YEAR = Z.YEAR) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 3 AS ORD, 'CS' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 1 AND A.YEAR = Z.YEAR) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 2 AND A.YEAR = Z.YEAR) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 3 AND A.YEAR = Z.YEAR) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 4 AND A.YEAR = Z.YEAR) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 5 AND A.YEAR = Z.YEAR) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 6 AND A.YEAR = Z.YEAR) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 7 AND A.YEAR = Z.YEAR) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 8 AND A.YEAR = Z.YEAR) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 9 AND A.YEAR = Z.YEAR) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 10 AND A.YEAR = Z.YEAR) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 11 AND A.YEAR = Z.YEAR) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 12 AND A.YEAR = Z.YEAR) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 13 AND A.YEAR = Z.YEAR) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 14 AND A.YEAR = Z.YEAR) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 15 AND A.YEAR = Z.YEAR) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 16 AND A.YEAR = Z.YEAR) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 17 AND A.YEAR = Z.YEAR) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 18 AND A.YEAR = Z.YEAR) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 19 AND A.YEAR = Z.YEAR) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 20 AND A.YEAR = Z.YEAR) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 21 AND A.YEAR = Z.YEAR) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 22 AND A.YEAR = Z.YEAR) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 23 AND A.YEAR = Z.YEAR) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 24 AND A.YEAR = Z.YEAR) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 25 AND A.YEAR = Z.YEAR) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 26 AND A.YEAR = Z.YEAR) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 27 AND A.YEAR = Z.YEAR) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 28 AND A.YEAR = Z.YEAR) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 29 AND A.YEAR = Z.YEAR) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 30 AND A.YEAR = Z.YEAR) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 31 AND A.YEAR = Z.YEAR) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 32 AND A.YEAR = Z.YEAR) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 33 AND A.YEAR = Z.YEAR) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 34 AND A.YEAR = Z.YEAR) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 35 AND A.YEAR = Z.YEAR) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 36 AND A.YEAR = Z.YEAR) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 37 AND A.YEAR = Z.YEAR) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 38 AND A.YEAR = Z.YEAR) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 39 AND A.YEAR = Z.YEAR) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 40 AND A.YEAR = Z.YEAR) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 41 AND A.YEAR = Z.YEAR) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 42 AND A.YEAR = Z.YEAR) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 43 AND A.YEAR = Z.YEAR) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 44 AND A.YEAR = Z.YEAR) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 45 AND A.YEAR = Z.YEAR) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 46 AND A.YEAR = Z.YEAR) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 47 AND A.YEAR = Z.YEAR) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 48 AND A.YEAR = Z.YEAR) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 49 AND A.YEAR = Z.YEAR) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 50 AND A.YEAR = Z.YEAR) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 51 AND A.YEAR = Z.YEAR) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 52 AND A.YEAR = Z.YEAR) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 4 AS ORD, 'ALL' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 1 AND A.YEAR = Z.YEAR) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 2 AND A.YEAR = Z.YEAR) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 3 AND A.YEAR = Z.YEAR) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 4 AND A.YEAR = Z.YEAR) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 5 AND A.YEAR = Z.YEAR) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 6 AND A.YEAR = Z.YEAR) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 7 AND A.YEAR = Z.YEAR) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 8 AND A.YEAR = Z.YEAR) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 9 AND A.YEAR = Z.YEAR) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 10 AND A.YEAR = Z.YEAR) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 11 AND A.YEAR = Z.YEAR) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 12 AND A.YEAR = Z.YEAR) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 13 AND A.YEAR = Z.YEAR) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 14 AND A.YEAR = Z.YEAR) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 15 AND A.YEAR = Z.YEAR) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 16 AND A.YEAR = Z.YEAR) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 17 AND A.YEAR = Z.YEAR) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 18 AND A.YEAR = Z.YEAR) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 19 AND A.YEAR = Z.YEAR) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 20 AND A.YEAR = Z.YEAR) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 21 AND A.YEAR = Z.YEAR) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 22 AND A.YEAR = Z.YEAR) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 23 AND A.YEAR = Z.YEAR) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 24 AND A.YEAR = Z.YEAR) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 25 AND A.YEAR = Z.YEAR) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 26 AND A.YEAR = Z.YEAR) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 27 AND A.YEAR = Z.YEAR) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 28 AND A.YEAR = Z.YEAR) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 29 AND A.YEAR = Z.YEAR) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 30 AND A.YEAR = Z.YEAR) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 31 AND A.YEAR = Z.YEAR) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 32 AND A.YEAR = Z.YEAR) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 33 AND A.YEAR = Z.YEAR) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 34 AND A.YEAR = Z.YEAR) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 35 AND A.YEAR = Z.YEAR) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 36 AND A.YEAR = Z.YEAR) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 37 AND A.YEAR = Z.YEAR) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 38 AND A.YEAR = Z.YEAR) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 39 AND A.YEAR = Z.YEAR) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 40 AND A.YEAR = Z.YEAR) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 41 AND A.YEAR = Z.YEAR) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 42 AND A.YEAR = Z.YEAR) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 43 AND A.YEAR = Z.YEAR) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 44 AND A.YEAR = Z.YEAR) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 45 AND A.YEAR = Z.YEAR) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 46 AND A.YEAR = Z.YEAR) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 47 AND A.YEAR = Z.YEAR) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 48 AND A.YEAR = Z.YEAR) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 49 AND A.YEAR = Z.YEAR) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 50 AND A.YEAR = Z.YEAR) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 51 AND A.YEAR = Z.YEAR) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 52 AND A.YEAR = Z.YEAR) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        ) A
 ORDER BY A.ORD
</select>
<select id="selectSalesPlanAccuracyMonthlySummary" parameterType="Map" resultType="egovMap">
SELECT #{planYear} AS PLAN_YEAR, A.TEAM, A.ORD
     , SUM(A.M1 ) AS M1 , SUM(A.M2 ) AS M2 , SUM(A.M3 ) AS M3 , SUM(A.M4 ) AS M4 , SUM(A.M5 ) AS M5, SUM(A.M6 ) AS M6
     , SUM(A.M7 ) AS M7 , SUM(A.M8 ) AS M8 , SUM(A.M9 ) AS M9 , SUM(A.M10) AS M10, SUM(A.M11) AS M11, SUM(A.M12) AS M12
  FROM (
        SELECT Z.TEAM
             , DECODE(Z.TEAM, 'DST', 1, 'CODY', 2, 'CS', 3, 'ALL', 4) AS ORD
             , CASE WHEN Z.SECT = 1 THEN Z.ACC ELSE 0 END AS M1
             , CASE WHEN Z.SECT = 2 THEN Z.ACC ELSE 0 END AS M2
             , CASE WHEN Z.SECT = 3 THEN Z.ACC ELSE 0 END AS M3
             , CASE WHEN Z.SECT = 4 THEN Z.ACC ELSE 0 END AS M4
             , CASE WHEN Z.SECT = 5 THEN Z.ACC ELSE 0 END AS M5
             , CASE WHEN Z.SECT = 6 THEN Z.ACC ELSE 0 END AS M6
             , CASE WHEN Z.SECT = 7 THEN Z.ACC ELSE 0 END AS M7
             , CASE WHEN Z.SECT = 8 THEN Z.ACC ELSE 0 END AS M8
             , CASE WHEN Z.SECT = 9 THEN Z.ACC ELSE 0 END AS M9
             , CASE WHEN Z.SECT = 10 THEN Z.ACC ELSE 0 END AS M10
             , CASE WHEN Z.SECT = 11 THEN Z.ACC ELSE 0 END AS M11
             , CASE WHEN Z.SECT = 12 THEN Z.ACC ELSE 0 END AS M12
          FROM SCM0063S Z
         WHERE Z.YEAR = #{planYear}
           AND Z.STOCK_CODE = 'SUM'
           AND Z.GBN = 2 /* MONTHLY */
        ) A
 GROUP BY A.TEAM, A.ORD
 ORDER BY A.ORD
</select>
<select id="selectWeekly16Week" parameterType="Map" resultType="egovMap">
SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK
     , (SELECT TO_CHAR(MIN(Z.SCM_WEEK_START), 'YYYYMMDD') FROM SCM0018M Z WHERE Z.SCM_YEAR = #{weeklyYear} AND Z.SCM_WEEK = #{weeklyWeek}) AS ORD_FROM
     , (SELECT TO_CHAR(MIN(Z.SCM_WEEK_START + 6), 'YYYYMMDD') FROM SCM0018M Z WHERE Z.SCM_YEAR = #{weeklyYear} AND Z.SCM_WEEK = #{weeklyWeek}) AS ORD_TO
  FROM SCM0018M A
     , (
        SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
             , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
          FROM (
                SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                  FROM SCM0018M A
                 WHERE A.SCM_YEAR = #{weeklyCalcYear}
                   AND A.SCM_WEEK = #{weeklyCalcWeek}
                ) A
        ) B
 WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
   AND A.SCM_MONTH || A.SCM_WEEK != '121'
 ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC
</select>
<select id="selectWeeklyStartEnd" parameterType="Map" resultType="egovMap">
SELECT 'W' || LPAD(CASE WHEN A.START_WEEK <![CDATA[ <= ]]> 0 THEN 52 + A.START_WEEK ELSE A.START_WEEK END, 2, '0') AS START_WEEK
     , 'W' || LPAD(CASE WHEN B.END_WEEK   <![CDATA[ <= ]]> 0 THEN 52 + B.END_WEEK   ELSE B.END_WEEK   END, 2, '0') AS END_WEEK
  FROM (SELECT #{week} - MIN(WEEK) AS START_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 1) A
     , (SELECT #{week} - MAX(WEEK) AS END_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 1) B
</select>
<select id="selectSalesPlanAccuracyWeeklyDetail" parameterType="Map" resultType="egovMap">
SELECT A.TEAM, A.STOCK_CODE, SUM(NVL(A.W0, 0)) AS SALES_ORD_QTY, A.ACC AS SALES_ACC_PER
     , #{startWeek} AS START_WEEK
     , #{endWeek} AS END_WEEK
     , SUM(A.W1 ) AS W1 , SUM(A.W2 ) AS W2 , SUM(A.W3 ) AS W3 , SUM(A.W4 ) AS W4 , SUM(A.W5 ) AS W5 , SUM(A.W6 ) AS W6 , SUM(A.W7 ) AS W7 , SUM(A.W8 ) AS W8
     , SUM(A.W9 ) AS W9 , SUM(A.W10) AS W10, SUM(A.W11) AS W11, SUM(A.W12) AS W12, SUM(A.W13) AS W13, SUM(A.W14) AS W14, SUM(A.W15) AS W15, SUM(A.W16) AS W16
  FROM (
        SELECT Z.TEAM, Z.STOCK_CODE, Z.ACC
             , CASE WHEN Z.TEAM = 'ALL' THEN (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    ELSE (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.TEAM = Z.TEAM AND X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    END AS W0
             , FN_GET_SALES_PLAN_QTY(#{planYear1},  #{planWeek1} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W1
             , FN_GET_SALES_PLAN_QTY(#{planYear2},  #{planWeek2} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W2
             , FN_GET_SALES_PLAN_QTY(#{planYear3},  #{planWeek3} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W3
             , FN_GET_SALES_PLAN_QTY(#{planYear4},  #{planWeek4} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W4
             , FN_GET_SALES_PLAN_QTY(#{planYear5},  #{planWeek5} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W5
             , FN_GET_SALES_PLAN_QTY(#{planYear6},  #{planWeek6} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W6
             , FN_GET_SALES_PLAN_QTY(#{planYear7},  #{planWeek7} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W7
             , FN_GET_SALES_PLAN_QTY(#{planYear8},  #{planWeek8} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W8
             , FN_GET_SALES_PLAN_QTY(#{planYear9},  #{planWeek9} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W9
             , FN_GET_SALES_PLAN_QTY(#{planYear10}, #{planWeek10}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W10
             , FN_GET_SALES_PLAN_QTY(#{planYear11}, #{planWeek11}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W11
             , FN_GET_SALES_PLAN_QTY(#{planYear12}, #{planWeek12}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W12
             , FN_GET_SALES_PLAN_QTY(#{planYear13}, #{planWeek13}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W13
             , FN_GET_SALES_PLAN_QTY(#{planYear14}, #{planWeek14}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W14
             , FN_GET_SALES_PLAN_QTY(#{planYear15}, #{planWeek15}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W15
             , FN_GET_SALES_PLAN_QTY(#{planYear16}, #{planWeek16}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W16
          FROM SCM0063S Z
         WHERE Z.YEAR = #{weeklyYear}
           AND Z.TEAM = #{team}
           AND Z.SECT = #{weeklyWeek}
           AND Z.GBN = 1
        ) A
 GROUP BY A.TEAM, A.STOCK_CODE, A.ACC
 ORDER BY A.TEAM, A.STOCK_CODE
</select>
<select id="selectMonthly16Week" parameterType="Map" resultType="egovMap">
SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK
     , #{monthlyYear} || LPAD(#{monthlyMonth}, 2, '0') || '01' AS ORD_FROM
     , #{monthlyYear} || LPAD(#{monthlyMonth}, 2, '0') || '31' AS ORD_TO
  FROM SCM0018M A
     , (
        SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
             , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
          FROM (
                SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                  FROM SCM0018M A
                 WHERE A.SCM_YEAR = #{monthlyCalcYear}
                   AND A.SCM_MONTH = #{monthlyCalcMonth}
                   AND A.IS_SPLT = 0
                ) A
        ) B
 WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
   AND A.SCM_MONTH || A.SCM_WEEK != '121'
 ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC
</select>
<select id="selectMonthlyStartEnd" parameterType="Map" resultType="egovMap">
SELECT 'W' || LPAD(CASE WHEN A.START_WEEK <![CDATA[ <= ]]> 0 THEN 52 + A.START_WEEK ELSE A.START_WEEK END, 2, '0') AS START_WEEK
     , 'W' || LPAD(CASE WHEN B.END_WEEK   <![CDATA[ <= ]]> 0 THEN 52 + B.END_WEEK   ELSE B.END_WEEK   END, 2, '0') AS END_WEEK
  FROM (SELECT #{week} - MIN(WEEK) AS START_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 2) A
     , (SELECT #{week} - MAX(WEEK) AS END_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 2) B
</select>
<select id="selectSalesPlanAccuracyMonthlyDetail" parameterType="Map" resultType="egovMap">
SELECT A.TEAM, A.STOCK_CODE, SUM(A.W0 ) AS SALES_ORD_QTY, A.ACC AS SALES_ACC_PER
     , #{startWeek} AS START_WEEK
     , #{endWeek} AS END_WEEK
     , SUM(A.W1 ) AS W1 , SUM(A.W2 ) AS W2 , SUM(A.W3 ) AS W3 , SUM(A.W4 ) AS W4 , SUM(A.W5 ) AS W5 , SUM(A.W6 ) AS W6 , SUM(A.W7 ) AS W7 , SUM(A.W8 ) AS W8
     , SUM(A.W9 ) AS W9 , SUM(A.W10) AS W10, SUM(A.W11) AS W11, SUM(A.W12) AS W12, SUM(A.W13) AS W13, SUM(A.W14) AS W14, SUM(A.W15) AS W15, SUM(A.W16) AS W16
  FROM (
        SELECT Z.TEAM, Z.STOCK_CODE, Z.ACC
             , (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.TEAM = Z.TEAM AND X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom}  AND #{ordTo} ) AS W0
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear1},  #{planWeek1} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W1
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear2},  #{planWeek2} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W2
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear3},  #{planWeek3} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W3
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear4},  #{planWeek4} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W4
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear5},  #{planWeek5} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W5
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear6},  #{planWeek6} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W6
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear7},  #{planWeek7} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W7
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear8},  #{planWeek8} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W8
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear9},  #{planWeek9} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W9
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear10}, #{planWeek10}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W10
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear11}, #{planWeek11}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W11
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear12}, #{planWeek12}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W12
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear13}, #{planWeek13}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W13
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear14}, #{planWeek14}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W14
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear15}, #{planWeek15}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W15
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear16}, #{planWeek16}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W16
          FROM SCM0063S Z
         WHERE Z.YEAR = #{monthlyYear}
           AND Z.TEAM = #{team}
           AND Z.SECT = #{monthlyMonth}
           AND Z.GBN = 2
        ) A
 GROUP BY A.TEAM, A.STOCK_CODE, A.ACC
 ORDER BY A.TEAM, A.STOCK_CODE
</select>

<!-- Ontime Delivery Report -->
<select id="selectOntimeDelivery" parameterType="Map" resultType="egovMap">
</select>

</mapper>