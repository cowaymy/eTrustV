<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.scm.impl.ScmReportMapper">

<!-- Business Plan Report -->
<select id="selectPlanVer" parameterType="Map" resultType="egovMap">
SELECT CASE WHEN A.ID = 1 THEN CASE WHEN A.ID = B.ID THEN B.ID ELSE A.ID END
            ELSE B.ID END AS ID
     , CASE WHEN A.ID = 1 THEN CASE WHEN A.ID = B.ID THEN B.NAME ELSE A.NAME END
            ELSE B.NAME END AS NAME
  FROM (SELECT 1 AS ID, '[1]' AS NAME FROM DUAL) A
  FULL OUTER JOIN (
        SELECT A.VER AS ID
             , '[' || A.VER || '] - ' || TO_CHAR(A.CRT_DT, 'DD/MM/YYYY') AS NAME
          FROM SCM0061M A
         WHERE A.YEAR = #{planYear}
        ) B ON (A.ID = B.ID)
 ORDER BY A.ID
</select>
<select id="selectBusinessPlanSummary" parameterType="Map" resultType="egovMap">
</select>
<select id="selectBusinessPlanDetail" parameterType="Map" resultType="egovMap">
</select>

<!-- Sales Plan Accuracy -->
<select id="selectSalesPlanAccuracyWeeklyDetailHeader" parameterType="Map" resultType="egovMap">
SELECT TEAM
     , STOCK_CODE
     , SALES_ORD_QTY
     , SALES_ACC_PER
     , START_WEEK
     , END_WEEK
     , W1_SCM_WEEK, W2_SCM_WEEK, W3_SCM_WEEK, W4_SCM_WEEK, W5_SCM_WEEK, W6_SCM_WEEK, W7_SCM_WEEK, W8_SCM_WEEK, W9_SCM_WEEK
     , W10_SCM_WEEK, W11_SCM_WEEK, W12_SCM_WEEK, W13_SCM_WEEK, W14_SCM_WEEK, W15_SCM_WEEK, W16_SCM_WEEK
  FROM (
        SELECT DECODE(A.RNO, 1, '1', 2, '2', 3, '3', 4, '4', 5, '5', 6, '6', 7, '7', 8, '8', 9, '9'
                           , 10, '10', 11, '11', 12, '12', 13, '13', 14, '14', 15, '15', 16, '16') AS RNO
             , A.TEAM, A.STOCK_CODE, A.SALES_ORD_QTY, A.SALES_ACC_PER, A.START_WEEK, A.END_WEEK, A.SCM_WEEK
          FROM (
                SELECT ROW_NUMBER() OVER (PARTITION BY A.SCM ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC) AS RNO
                     , 'team' AS TEAM
                     , 'stockCode' AS STOCK_CODE
                     , 'salesOrdQty' AS SALES_ORD_QTY
                     , 'salesAccPer' AS SALES_ACC_PER
                     , 'startWeek' AS START_WEEK
                     , 'endWeek' AS END_WEEK
                     , 'W' || LPAD(A.SCM_WEEK, 2, '0') AS SCM_WEEK
                  FROM (
                        SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK, 1 AS SCM
                          FROM SCM0018M A
                             , (
                                SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
                                     , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
                                  FROM (
                                        SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                                          FROM SCM0018M A
                                         WHERE A.SCM_YEAR = #{weeklyCalcYear}
                                           AND A.SCM_WEEK = #{weeklyCalcWeek}
                                        ) A
                                ) B
                         WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
                           AND A.SCM_MONTH || A.SCM_WEEK != '121'
                        ) A
                ) A
        )
 PIVOT (
        MAX(SCM_WEEK) SCM_WEEK
        FOR RNO IN (1 AS W1, 2 AS W2, 3 AS W3, 4 AS W4, 5 AS W5, 6 AS W6, 7 AS W7, 8 AS W8, 9 AS W9
                  , 10 AS W10, 11 AS W11, 12 AS W12, 13 AS W13, 14 AS W14, 15 AS W15, 16 AS W16)
        )
</select>
<select id="selectSalesPlanAccuracyMonthlyDetailHeader" parameterType="Map" resultType="egovMap">
SELECT TEAM
     , STOCK_CODE
     , SALES_ORD_QTY
     , SALES_ACC_PER
     , START_WEEK
     , END_WEEK
     , W1_SCM_WEEK, W2_SCM_WEEK, W3_SCM_WEEK, W4_SCM_WEEK, W5_SCM_WEEK, W6_SCM_WEEK, W7_SCM_WEEK, W8_SCM_WEEK, W9_SCM_WEEK
     , W10_SCM_WEEK, W11_SCM_WEEK, W12_SCM_WEEK, W13_SCM_WEEK, W14_SCM_WEEK, W15_SCM_WEEK, W16_SCM_WEEK
  FROM (
        SELECT DECODE(A.RNO, 1, '1', 2, '2', 3, '3', 4, '4', 5, '5', 6, '6', 7, '7', 8, '8', 9, '9'
                           , 10, '10', 11, '11', 12, '12', 13, '13', 14, '14', 15, '15', 16, '16') AS RNO
             , A.TEAM, A.STOCK_CODE, A.SALES_ORD_QTY, A.SALES_ACC_PER, A.START_WEEK, A.END_WEEK, A.SCM_WEEK
          FROM (
                SELECT ROW_NUMBER() OVER (PARTITION BY A.SCM ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC) AS RNO
                     , 'team' AS TEAM
                     , 'stockCode' AS STOCK_CODE
                     , 'salesOrdQty' AS SALES_ORD_QTY
                     , 'salesAccPer' AS SALES_ACC_PER
                     , 'startWeek' AS START_WEEK
                     , 'endWeek' AS END_WEEK
                     , 'W' || LPAD(A.SCM_WEEK, 2, '0') AS SCM_WEEK
                  FROM (
                        SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK, 1 AS SCM
                          FROM SCM0018M A
                             , (
                                SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
                                     , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
                                  FROM (
                                        SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                                             , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                                          FROM SCM0018M A
                                         WHERE A.SCM_YEAR = #{monthlyCalcYear}
                                           AND A.SCM_MONTH = #{monthlyCalcMonth}
                                           AND A.IS_SPLT = 0
                                        ) A
                                ) B
                         WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
                           AND A.SCM_MONTH || A.SCM_WEEK != '121'
                        ) A
                ) A
        )
 PIVOT (
        MAX(SCM_WEEK) SCM_WEEK
        FOR RNO IN (1 AS W1, 2 AS W2, 3 AS W3, 4 AS W4, 5 AS W5, 6 AS W6, 7 AS W7, 8 AS W8, 9 AS W9
                  , 10 AS W10, 11 AS W11, 12 AS W12, 13 AS W13, 14 AS W14, 15 AS W15, 16 AS W16)
        )
</select>
<select id="selectSalesPlanAccuracyWeeklySummary" parameterType="Map" resultType="egovMap">
SELECT A.ORD, A.TEAM, A.YEAR AS PLAN_YEAR
     , A.W1, A.W2, A.W3, A.W4, A.W5, A.W6, A.W7, A.W8, A.W9, A.W10
     , A.W11, A.W12, A.W13, A.W14, A.W15, A.W16, A.W17, A.W18, A.W19, A.W20
     , A.W21, A.W22, A.W23, A.W24, A.W25, A.W26, A.W27, A.W28, A.W29, A.W30
     , A.W31, A.W32, A.W33, A.W34, A.W35, A.W36, A.W37, A.W38, A.W39, A.W40
     , A.W41, A.W42, A.W43, A.W44, A.W45, A.W46, A.W47, A.W48, A.W49, A.W50
     , A.W51, A.W52
  FROM (
        SELECT 1 AS ORD, 'DST' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 1 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 2 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 3 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 4 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 5 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 6 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 7 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 8 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 9 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 13 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 14 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 15 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 16 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 17 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 18 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 19 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 20 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 21 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 22 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 23 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 24 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 25 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 26 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 27 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 28 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 29 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 30 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 31 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 32 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 33 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 34 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 35 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 36 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 37 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 38 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 39 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 40 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 41 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 42 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 43 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 44 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 45 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 46 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 47 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 48 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 49 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 50 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 51 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'DST' AND Z.SECT = 52 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 2 AS ORD, 'CODY' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 1 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 2 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 3 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 4 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 5 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 6 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 7 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 8 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 9 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 13 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 14 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 15 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 16 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 17 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 18 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 19 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 20 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 21 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 22 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 23 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 24 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 25 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 26 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 27 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 28 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 29 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 30 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 31 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 32 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 33 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 34 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 35 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 36 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 37 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 38 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 39 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 40 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 41 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 42 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 43 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 44 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 45 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 46 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 47 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 48 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 49 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 50 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 51 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CODY' AND Z.SECT = 52 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 3 AS ORD, 'CS' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 1 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 2 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 3 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 4 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 5 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 6 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 7 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 8 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 9 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 13 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 14 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 15 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 16 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 17 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 18 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 19 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 20 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 21 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 22 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 23 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 24 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 25 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 26 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 27 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 28 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 29 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 30 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 31 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 32 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 33 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 34 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 35 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 36 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 37 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 38 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 39 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 40 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 41 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 42 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 43 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 44 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 45 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 46 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 47 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 48 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 49 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 50 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 51 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'CS' AND Z.SECT = 52 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 4 AS ORD, 'ALL' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 1 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 2 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 3 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 4 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 5 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 6 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 7 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 8 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 9 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W12
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 13 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W13
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 14 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W14
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 15 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W15
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 16 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W16
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 17 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W17
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 18 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W18
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 19 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W19
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 20 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W20
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 21 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W21
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 22 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W22
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 23 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W23
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 24 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W24
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 25 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W25
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 26 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W26
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 27 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W27
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 28 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W28
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 29 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W29
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 30 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W30
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 31 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W31
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 32 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W32
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 33 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W33
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 34 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W34
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 35 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W35
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 36 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W36
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 37 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W37
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 38 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W38
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 39 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W39
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 40 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W40
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 41 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W41
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 42 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W42
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 43 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W43
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 44 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W44
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 45 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W45
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 46 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W46
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 47 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W47
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 48 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W48
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 49 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W49
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 50 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W50
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 51 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W51
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 1 AND Z.TEAM = 'ALL' AND Z.SECT = 52 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS W52
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        ) A
 ORDER BY A.ORD
</select>
<select id="selectSalesPlanAccuracyMonthlySummary" parameterType="Map" resultType="egovMap">
SELECT A.ORD, A.TEAM, A.YEAR AS PLAN_YEAR
     , A.M1, A.M2, A.M3, A.M4, A.M5, A.M6, A.M7, A.M8, A.M9, A.M10, A.M11, A.M12
  FROM (
        SELECT 1 AS ORD, 'DST' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 1 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 2 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 3 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 4 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 5 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 6 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 7 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 8 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 9 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'DST' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M12
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 2 AS ORD, 'CODY' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 1 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 2 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 3 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 4 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 5 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 6 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 7 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 8 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 9 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CODY' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M12
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 3 AS ORD, 'CS' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 1 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 2 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 3 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 4 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 5 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 6 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 7 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 8 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 9 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'CS' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M12
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        UNION ALL
        SELECT 4 AS ORD, 'ALL' AS TEAM, A.YEAR
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 1 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M1
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 2 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M2
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 3 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M3
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 4 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M4
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 5 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M5
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 6 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M6
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 7 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M7
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 8 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M8
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 9 AND A.YEAR  = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M9
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 10 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M10
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 11 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M11
             , (SELECT NVL(ROUND(AVG(Z.ACC), 0), 0) || '%' FROM SCM0063S Z WHERE Z.GBN = 2 AND Z.TEAM = 'ALL' AND Z.SECT = 12 AND A.YEAR = Z.YEAR<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''"> AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox} </if>) AS M12
          FROM (SELECT #{planYear} AS YEAR FROM DUAL) A
        ) A
 ORDER BY A.ORD
</select>
<select id="selectWeekly16Week" parameterType="Map" resultType="egovMap">
SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK
     , (SELECT TO_CHAR(MIN(Z.SCM_WEEK_START), 'YYYYMMDD') FROM SCM0018M Z WHERE Z.SCM_YEAR = #{weeklyYear} AND Z.SCM_WEEK = #{weeklyWeek}) AS ORD_FROM
     , (SELECT TO_CHAR(MIN(Z.SCM_WEEK_START + 6), 'YYYYMMDD') FROM SCM0018M Z WHERE Z.SCM_YEAR = #{weeklyYear} AND Z.SCM_WEEK = #{weeklyWeek}) AS ORD_TO
  FROM SCM0018M A
     , (
        SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
             , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
          FROM (
                SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                  FROM SCM0018M A
                 WHERE A.SCM_YEAR = #{weeklyCalcYear}
                   AND A.SCM_WEEK = #{weeklyCalcWeek}
                ) A
        ) B
 WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
   AND A.SCM_MONTH || A.SCM_WEEK != '121'
 ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC
</select>
<select id="selectWeeklyStartEnd" parameterType="Map" resultType="egovMap">
SELECT 'W' || LPAD(CASE WHEN A.START_WEEK <![CDATA[ <= ]]> 0 THEN 52 + A.START_WEEK ELSE A.START_WEEK END, 2, '0') AS START_WEEK
     , 'W' || LPAD(CASE WHEN B.END_WEEK   <![CDATA[ <= ]]> 0 THEN 52 + B.END_WEEK   ELSE B.END_WEEK   END, 2, '0') AS END_WEEK
  FROM (SELECT #{week} - MIN(WEEK) + 1 AS START_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 1) A
     , (SELECT #{week} - MAX(WEEK) + 1 AS END_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 1) B
</select>
<select id="selectSalesPlanAccuracyWeeklyDetail" parameterType="Map" resultType="egovMap">
SELECT A.TEAM, A.STOCK_CODE, SUM(NVL(A.W0, 0)) AS SALES_ORD_QTY, A.ACC || '%' AS SALES_ACC_PER
     , #{startWeek} AS START_WEEK
     , #{endWeek} AS END_WEEK
     , SUM(A.W1 ) AS W1 , SUM(A.W2 ) AS W2 , SUM(A.W3 ) AS W3 , SUM(A.W4 ) AS W4 , SUM(A.W5 ) AS W5 , SUM(A.W6 ) AS W6 , SUM(A.W7 ) AS W7 , SUM(A.W8 ) AS W8
     , SUM(A.W9 ) AS W9 , SUM(A.W10) AS W10, SUM(A.W11) AS W11, SUM(A.W12) AS W12, SUM(A.W13) AS W13, SUM(A.W14) AS W14, SUM(A.W15) AS W15, SUM(A.W16) AS W16
  FROM (
        SELECT Z.TEAM, Z.STOCK_CODE, Z.ACC
             , CASE WHEN Z.TEAM = 'ALL' THEN (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    ELSE (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.TEAM = Z.TEAM AND X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    END AS W0
             , FN_GET_SALES_PLAN_QTY(#{planYear1},  #{planWeek1} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W1
             , FN_GET_SALES_PLAN_QTY(#{planYear2},  #{planWeek2} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W2
             , FN_GET_SALES_PLAN_QTY(#{planYear3},  #{planWeek3} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W3
             , FN_GET_SALES_PLAN_QTY(#{planYear4},  #{planWeek4} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W4
             , FN_GET_SALES_PLAN_QTY(#{planYear5},  #{planWeek5} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W5
             , FN_GET_SALES_PLAN_QTY(#{planYear6},  #{planWeek6} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W6
             , FN_GET_SALES_PLAN_QTY(#{planYear7},  #{planWeek7} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W7
             , FN_GET_SALES_PLAN_QTY(#{planYear8},  #{planWeek8} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W8
             , FN_GET_SALES_PLAN_QTY(#{planYear9},  #{planWeek9} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W9
             , FN_GET_SALES_PLAN_QTY(#{planYear10}, #{planWeek10}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W10
             , FN_GET_SALES_PLAN_QTY(#{planYear11}, #{planWeek11}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W11
             , FN_GET_SALES_PLAN_QTY(#{planYear12}, #{planWeek12}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W12
             , FN_GET_SALES_PLAN_QTY(#{planYear13}, #{planWeek13}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W13
             , FN_GET_SALES_PLAN_QTY(#{planYear14}, #{planWeek14}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W14
             , FN_GET_SALES_PLAN_QTY(#{planYear15}, #{planWeek15}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W15
             , FN_GET_SALES_PLAN_QTY(#{planYear16}, #{planWeek16}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W16
          FROM SCM0063S Z
         WHERE Z.YEAR = #{weeklyYear}
           AND Z.TEAM = #{team}
           AND Z.SECT = #{weeklyWeek}
	<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''">
           AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox}
	</if>
           AND Z.GBN = 1
        ) A
 GROUP BY A.TEAM, A.STOCK_CODE, A.ACC
 ORDER BY A.TEAM, A.STOCK_CODE
</select>
<select id="selectMonthly16Week" parameterType="Map" resultType="egovMap">
SELECT DISTINCT A.SCM_YEAR, A.SCM_WEEK
     , #{monthlyYear} || LPAD(#{monthlyMonth}, 2, '0') || '01' AS ORD_FROM
     , #{monthlyYear} || LPAD(#{monthlyMonth}, 2, '0') || '31' AS ORD_TO
  FROM SCM0018M A
     , (
        SELECT (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.TO_YEAR AND Z.SCM_WEEK = A.TO_WEEK) AS TO_CAL_ID
             , (SELECT MIN(Z.CAL_ID) FROM SCM0018M Z WHERE Z.SCM_YEAR = A.FROM_YEAR AND Z.SCM_WEEK = A.FROM_WEEK) AS FROM_CAL_ID
          FROM (
                SELECT MAX(SCM_YEAR) AS TO_YEAR, MAX(A.SCM_WEEK) AS TO_WEEK
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_YEAR) - 1 ELSE MAX(SCM_YEAR) END AS FROM_YEAR
                     , CASE WHEN MAX(A.SCM_WEEK) - 16 <![CDATA[ <= ]]> 0 THEN MAX(A.SCM_WEEK) - 15 + 52 ELSE MAX(A.SCM_WEEK) - 15 END AS FROM_WEEK
                  FROM SCM0018M A
                 WHERE A.SCM_YEAR = #{monthlyCalcYear}
                   AND A.SCM_MONTH = #{monthlyCalcMonth}
                   AND A.IS_SPLT = 0
                ) A
        ) B
 WHERE A.CAL_ID BETWEEN B.FROM_CAL_ID AND B.TO_CAL_ID
   AND A.SCM_MONTH || A.SCM_WEEK != '121'
 ORDER BY A.SCM_YEAR DESC, A.SCM_WEEK DESC
</select>
<select id="selectMonthlyStartEnd" parameterType="Map" resultType="egovMap">
SELECT 'W' || LPAD(CASE WHEN A.START_WEEK <![CDATA[ <= ]]> 0 THEN 52 + A.START_WEEK ELSE A.START_WEEK END, 2, '0') AS START_WEEK
     , 'W' || LPAD(CASE WHEN B.END_WEEK   <![CDATA[ <= ]]> 0 THEN 52 + B.END_WEEK   ELSE B.END_WEEK   END, 2, '0') AS END_WEEK
  FROM (SELECT #{week} - MIN(WEEK) AS START_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 2) A
     , (SELECT #{week} - MAX(WEEK) AS END_WEEK FROM SCM0062M WHERE YEAR = #{year} AND GBN = 2) B
</select>
<select id="selectSalesPlanAccuracyMonthlyDetail" parameterType="Map" resultType="egovMap">
SELECT A.TEAM, A.STOCK_CODE, SUM(NVL(A.W0, 0)) AS SALES_ORD_QTY, A.ACC || '%' AS SALES_ACC_PER
     , #{startWeek} AS START_WEEK
     , #{endWeek} AS END_WEEK
     , SUM(A.W1 ) AS W1 , SUM(A.W2 ) AS W2 , SUM(A.W3 ) AS W3 , SUM(A.W4 ) AS W4 , SUM(A.W5 ) AS W5 , SUM(A.W6 ) AS W6 , SUM(A.W7 ) AS W7 , SUM(A.W8 ) AS W8
     , SUM(A.W9 ) AS W9 , SUM(A.W10) AS W10, SUM(A.W11) AS W11, SUM(A.W12) AS W12, SUM(A.W13) AS W13, SUM(A.W14) AS W14, SUM(A.W15) AS W15, SUM(A.W16) AS W16
  FROM (
        SELECT Z.TEAM, Z.STOCK_CODE, Z.ACC
             , CASE WHEN Z.TEAM = 'ALL' THEN (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    ELSE (SELECT SUM(X.ORD_QTY) FROM SCM0050S X WHERE X.TEAM = Z.TEAM AND X.STOCK_CODE = Z.STOCK_CODE AND X.ORD_DT BETWEEN #{ordFrom} AND #{ordTo})
                    END AS W0
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear1},  #{planWeek1} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W1
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear2},  #{planWeek2} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W2
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear3},  #{planWeek3} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W3
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear4},  #{planWeek4} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W4
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear5},  #{planWeek5} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W5
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear6},  #{planWeek6} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W6
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear7},  #{planWeek7} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W7
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear8},  #{planWeek8} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W8
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear9},  #{planWeek9} , Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W9
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear10}, #{planWeek10}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W10
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear11}, #{planWeek11}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W11
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear12}, #{planWeek12}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W12
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear13}, #{planWeek13}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W13
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear14}, #{planWeek14}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W14
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear15}, #{planWeek15}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W15
             , FN_GET_SALES_PLAN_QTY_MON(#{planYear16}, #{planWeek16}, Z.TEAM, Z.STOCK_CODE, Z.YEAR, Z.SECT) AS W16
          FROM SCM0063S Z
         WHERE Z.YEAR = #{monthlyYear}
           AND Z.TEAM = #{team}
           AND Z.SECT = #{monthlyMonth}
	<if test="scmStockTypeCbBox != null and scmStockTypeCbBox != ''">
           AND Z.STOCK_TYPE_ID = #{scmStockTypeCbBox}
	</if>
           AND Z.GBN = 2
        ) A
 GROUP BY A.TEAM, A.STOCK_CODE, A.ACC
 ORDER BY A.TEAM, A.STOCK_CODE
</select>
<select id="selectSalesPlanAccuracyMaster" parameterType="Map" resultType="egovMap">
SELECT A.YEAR, A.GBN, A.GBN_NM
     , A.W1, A.W2 , A.W3 , A.W4 , A.W5 , A.W6 , A.W7 , A.W8
     , A.W9, A.W10, A.W11, A.W12, A.W13, A.W14, A.W15, A.W16
  FROM (
        SELECT A.YEAR, A.GBN, A.GBN_NM
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 1), 0) AS W1
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 2), 0) AS W2
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 3), 0) AS W3
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 4), 0) AS W4
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 5), 0) AS W5
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 6), 0) AS W6
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 7), 0) AS W7
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 8), 0) AS W8
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 9), 0) AS W9
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 10), 0) AS W10
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 11), 0) AS W11
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 12), 0) AS W12
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 13), 0) AS W13
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 14), 0) AS W14
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 15), 0) AS W15
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 16), 0) AS W16
          FROM (SELECT DISTINCT YEAR, 1 AS GBN, 'Weekly' AS GBN_NM FROM SCM0062M) A
        UNION ALL
        SELECT A.YEAR, A.GBN, A.GBN_NM
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 1), 0) AS W1
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 2), 0) AS W2
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 3), 0) AS W3
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 4), 0) AS W4
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 5), 0) AS W5
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 6), 0) AS W6
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 7), 0) AS W7
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 8), 0) AS W8
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 9), 0) AS W9
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 10), 0) AS W10
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 11), 0) AS W11
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 12), 0) AS W12
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 13), 0) AS W13
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 14), 0) AS W14
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 15), 0) AS W15
             , NVL((SELECT Z.WEEK FROM SCM0062M Z WHERE A.YEAR = Z.YEAR AND A.GBN = Z.GBN AND Z.WEEK = 16), 0) AS W16
          FROM (SELECT DISTINCT YEAR, 2 AS GBN, 'Monthly' AS GBN_NM FROM SCM0062M) A
        ) A
 ORDER BY A.YEAR DESC, A.GBN
</select>
<update id="deleteSalesPlanAccuracyMaster" parameterType="Map">
DELETE FROM SCM0062M
 WHERE YEAR = #{year}
   AND GBN = #{gbn}
</update>
<insert id="insertSalesPlanAccuracyMaster" parameterType="Map">
INSERT INTO SCM0062M
(
       YEAR
     , GBN
     , WEEK
 )
VALUES
(
       #{year}
     , #{gbn}
     , #{week}
 )
</insert>
<resultMap id="salesPlanAccuracyMap" type="egovMap"></resultMap>
<select id="executeSalesPlanAccuracy" parameterType="Map" resultType="egovMap" statementType="CALLABLE">
{
     call SP_SCM_0063S_EXECUTE(#{year}, #{gbn}
                             , #{retValue, mode=OUT, jdbcType=VARCHAR, javaType=STRING, resultMap=salesPlanAccuracyMap})
 }
</select>

<!-- Ontime Delivery Report -->
<select id="selectOntimeDeliverySummary" parameterType="Map" resultType="egovMap">
SELECT A.GBN
     , A.ORD
     , A.PLAN_YEAR
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M1, 0) || '%' ELSE TO_CHAR(ROUND(A.M1, 0)) END AS M1
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M2, 0) || '%' ELSE TO_CHAR(ROUND(A.M2, 0)) END AS M2
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M3, 0) || '%' ELSE TO_CHAR(ROUND(A.M3, 0)) END AS M3
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M4, 0) || '%' ELSE TO_CHAR(ROUND(A.M4, 0)) END AS M4
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M5, 0) || '%' ELSE TO_CHAR(ROUND(A.M5, 0)) END AS M5
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M6, 0) || '%' ELSE TO_CHAR(ROUND(A.M6, 0)) END AS M6
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M7, 0) || '%' ELSE TO_CHAR(ROUND(A.M7, 0)) END AS M7
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M8, 0) || '%' ELSE TO_CHAR(ROUND(A.M8, 0)) END AS M8
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M9, 0) || '%' ELSE TO_CHAR(ROUND(A.M9, 0)) END AS M9
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M10, 0) || '%' ELSE TO_CHAR(ROUND(A.M10, 0)) END AS M10
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M11, 0) || '%' ELSE TO_CHAR(ROUND(A.M11, 0)) END AS M11
     , CASE WHEN A.ORD = 3 THEN ROUND(A.M12, 0) || '%' ELSE TO_CHAR(ROUND(A.M12, 0)) END AS M12
  FROM (
        SELECT 'Total PO' AS GBN, 1 AS ORD, Z.PLAN_YEAR
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 1) AS M1
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 2) AS M2
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 3) AS M3
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 4) AS M4
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 5) AS M5
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 6) AS M6
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 7) AS M7
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 8) AS M8
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 9) AS M9
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 10) AS M10
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 11) AS M11
             , (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 12) AS M12
          FROM (SELECT #{planYear} AS PLAN_YEAR FROM DUAL) Z
        UNION ALL
        SELECT 'On-Time GR' AS GBN, 2 AS ORD, Z.PLAN_YEAR
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 1) AS M1
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 2) AS M2
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 3) AS M3
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 4) AS M4
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 5) AS M5
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 6) AS M6
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 7) AS M7
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 8) AS M8
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 9) AS M9
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 10) AS M10
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 11) AS M11
             , FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 12) AS M12
          FROM (SELECT #{planYear} AS PLAN_YEAR FROM DUAL) Z
        UNION ALL
        SELECT 'Rate' AS GBN, 3 AS ORD, Z.PLAN_YEAR
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 1) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 1) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 1) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 1) * 100 END AS M1
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 2) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 2) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 2) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 2) * 100 END AS M2
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 3) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 3) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 3) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 3) * 100 END AS M3
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 4) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 4) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 4) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 4) * 100 END AS M4
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 5) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 5) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 5) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 5) * 100 END AS M5
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 6) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 6) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 6) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 6) * 100 END AS M6
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 7) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 7) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 7) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 7) * 100 END AS M7
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 8) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 8) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 8) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 8) * 100 END AS M8
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 9) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 9) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 9) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 9) * 100 END AS M9
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 10) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 10) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 10) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 10) * 100 END AS M10
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 11) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 11) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 11) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 11) * 100 END AS M11
             , CASE WHEN (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 12) = 0
                      OR FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 12) = 0 THEN 0
                    ELSE FN_GET_ON_TIME_QTY_MON(Z.PLAN_YEAR, 12) / (SELECT COUNT(*) FROM SCM0052M X LEFT OUTER JOIN SCM0053D Y ON (X.PO_ID = Y.PO_ID) WHERE X.PO_YEAR = Z.PLAN_YEAR AND X.PO_MONTH = 12) * 100 END AS M12
          FROM (SELECT #{planYear} AS PLAN_YEAR FROM DUAL) Z
        ) A
 ORDER BY A.ORD
</select>
<select id="selectOntimeDeliveryDetail" parameterType="Map" resultType="egovMap">
SELECT A.PO_NO
     , A.PO_ITEM_NO
     , A.SAP_PO_NO
     , A.SAP_PO_ITEM_NO
     , A.STOCK_CODE
     , A.STOCK_NAME
     , A.PO_ISS_DT
     , A.PLAN_GR_WEEK
     , A.FST_GR_WEEK
     , A.LST_GR_WEEK
     , A.PO_QTY
     , FN_GET_ON_TIME_QTY(A.PO_NO, A.PO_ITEM_NO, A.SAP_PO_NO, A.SAP_PO_ITEM_NO, A.STOCK_CODE) AS ON_TIME_GR_QTY
     , CASE WHEN A.PLAN_GR_YEAR || LPAD(A.PLAN_GR_WEEK, 2, '0') <![CDATA[ < ]]> NVL(A.LST_GR_YEAR, '9999') || NVL(A.LST_GR_WEEK, '99') THEN 0 ELSE 1 END AS ON_TIME_CHK
     , '' AS ETC
  FROM (
        SELECT B.PO_NO
             , B.PO_ITEM_NO
             , D.SAP_PO_NO
             , D.SAP_PO_ITEM_NO
             , B.STOCK_CODE
             , C.STK_DESC AS STOCK_NAME
             , TO_CHAR(B.CRT_DT, 'DD/MM/YYYY') AS PO_ISS_DT
             , A.PLAN_GR_YEAR, A.PLAN_GR_MONTH, A.PLAN_GR_WEEK
             , FN_GET_GR_WEEK(D.SAP_PO_NO, D.SAP_PO_ITEM_NO, D.STOCK_CODE, 1, 1) AS FST_GR_YEAR
             , FN_GET_GR_WEEK(D.SAP_PO_NO, D.SAP_PO_ITEM_NO, D.STOCK_CODE, 1, 2) AS FST_GR_WEEK
             , FN_GET_GR_WEEK(D.SAP_PO_NO, D.SAP_PO_ITEM_NO, D.STOCK_CODE, 2, 1) AS LST_GR_YEAR
             , FN_GET_GR_WEEK(D.SAP_PO_NO, D.SAP_PO_ITEM_NO, D.STOCK_CODE, 2, 2) AS LST_GR_WEEK
             , B.PO_QTY
          FROM SCM0052M A
          LEFT OUTER JOIN SCM0053D B ON (A.PO_ID = B.PO_ID)
          LEFT OUTER JOIN SYS0026M C ON (B.STOCK_CODE = C.STK_CODE)
          LEFT OUTER JOIN SCM0039M D ON (B.PO_NO = D.PO_NO AND B.PO_ITEM_NO = D.PO_ITEM_NO AND B.STOCK_CODE = D.STOCK_CODE)
         WHERE A.PO_YEAR = #{planYear}
           AND A.PO_MONTH = #{planMonth}
        ) A
 ORDER BY A.PO_NO, A.PO_ITEM_NO
</select>
<select id="selectOntimeDeliveryPopup" parameterType="Map" resultType="egovMap">
SELECT A.GR_YEAR
     , A.GR_MONTH
     , A.GR_WEEK
     , TO_CHAR(TO_DATE(A.GR_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS GR_DT
     , A.AP_QTY
     , A.GR_QTY
     , TO_CHAR(TO_DATE(A.CI_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS CI_DT
     , TO_CHAR(TO_DATE(A.SHIP_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS SHIP_DT
  FROM SCM0012D A
 WHERE A.SAP_PO_NO = #{sapPoNo}
   AND A.SAP_PO_ITEM_NO = #{sapPoItemNo}
   AND A.STOCK_CODE = #{stockCode}
 ORDER BY NVL(A.GR_DT, '00000000') DESC, A.CI_DT DESC, A.SHIP_DT DESC
</select>

<!-- Inventory Report -->
<select id="selectInventoryReportTotal" parameterType="Map" resultType="egovMap">
SELECT A.STOCK_TYPE_ID
     , A.STOCK_TYPE_NAME
     , SUM(A.TOT_PREV_QTY) AS TOT_PREV_QTY
     , SUM(A.TOT_CURR_QTY) AS TOT_CURR_QTY
     , SUM(A.TOT_CURR_QTY) - SUM(A.TOT_PREV_QTY) AS TOT_GAP_QTY
     , SUM(A.TRAN_PREV_QTY) AS TRAN_PREV_QTY
     , SUM(A.TRAN_CURR_QTY) AS TRAN_CURR_QTY
     , SUM(A.TRAN_CURR_QTY) - SUM(A.TRAN_PREV_QTY) AS TRAN_GAP_QTY
     , SUM(A.HAND_PREV_QTY) AS HAND_PREV_QTY
     , SUM(A.HAND_CURR_QTY) AS HAND_CURR_QTY
     , SUM(A.HAND_CURR_QTY) - SUM(A.HAND_PREV_QTY) AS HAND_GAP_QTY
     , B.DAYS_QTY AS DAYS_PREV_QTY
     , C.DAYS_QTY AS DAYS_CURR_QTY
     , C.DAYS_QTY - B.DAYS_QTY AS DAYS_GAP_QTY
     , SUM(A.AGE_PREV_QTY) AS AGE_PREV_QTY
     , SUM(A.AGE_CURR_QTY) AS AGE_CURR_QTY
     , SUM(A.AGE_CURR_QTY) - SUM(A.AGE_PREV_QTY) AS AGE_GAP_QTY
     , SUM(A.STKB_PREV_QTY) AS STKB_PREV_QTY
     , SUM(A.STKB_CURR_QTY) AS STKB_CURR_QTY
     , SUM(A.STKB_CURR_QTY) - SUM(A.STKB_PREV_QTY) AS STKB_GAP_QTY
  FROM (
        SELECT 'TOT' AS STOCK_CODE
             , TO_NUMBER(60) AS STOCK_TYPE_ID
             , TO_CHAR('Total') AS STOCK_TYPE_NAME
             , 0 AS TOT_PREV_QTY
             , SUM(A.TOT_QTY) AS TOT_CURR_QTY
             , 0 AS TRAN_PREV_QTY
             , SUM(A.TRAN_QTY) AS TRAN_CURR_QTY
             , 0 AS HAND_PREV_QTY
             , SUM(A.HAND_QTY) AS HAND_CURR_QTY
             , 0 AS AGE_PREV_QTY
             , SUM(A.AGE_QTY) AS AGE_CURR_QTY
             , 0 AS STKB_PREV_QTY
             , SUM(A.STKB_QTY) AS STKB_CURR_QTY
          FROM SCM0057L A
          LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
         WHERE A.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -1), 'YYYYMM')
           AND B.STK_TYPE_ID IN (61, 62, 63, 64)
        UNION ALL
        SELECT 'TOT' AS STOCK_CODE
             , TO_NUMBER(60) AS STOCK_TYPE_ID
             , TO_CHAR('Total') AS STOCK_TYPE_NAME
             , SUM(A.TOT_QTY) AS TOT_PREV_QTY
             , 0 AS TOT_CURR_QTY
             , SUM(A.TRAN_QTY) AS TRAN_PREV_QTY
             , 0 AS TRAN_CURR_QTY
             , SUM(A.HAND_QTY) AS HAND_PREV_QTY
             , 0 AS HAND_CURR_QTY
             , SUM(A.AGE_QTY) AS AGE_PREV_QTY
             , 0 AS AGE_CURR_QTY
             , SUM(A.STKB_QTY) AS STKB_PREV_QTY
             , 0 AS STKB_CURR_QTY
          FROM SCM0057L A
          LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
         WHERE A.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -2), 'YYYYMM')
           AND B.STK_TYPE_ID IN (61, 62, 63, 64)
        UNION ALL
        SELECT CASE WHEN TO_NUMBER(B.STK_TYPE_ID) = 61 THEN 'STK'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 62 THEN 'FLT'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 63 THEN 'SPR'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 64 THEN 'MSC'
                    END AS STOCK_CODE
             , TO_NUMBER(B.STK_TYPE_ID) AS STOCK_TYPE_ID
             , TO_CHAR(C.CODE_NAME) AS STOCK_TYPE_NAME
             , 0 AS TOT_PREV_QTY
             , SUM(A.TOT_QTY) AS TOT_CURR_QTY
             , 0 AS TRAN_PREV_QTY
             , SUM(A.TRAN_QTY) AS TRAN_CURR_QTY
             , 0 AS HAND_PREV_QTY
             , SUM(A.HAND_QTY) AS HAND_CURR_QTY
             , 0 AS AGE_PREV_QTY
             , SUM(A.AGE_QTY) AS AGE_CURR_QTY
             , 0 AS STKB_PREV_QTY
             , SUM(A.STKB_QTY) AS STKB_CURR_QTY
          FROM SCM0057L A
          LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
          LEFT OUTER JOIN SYS0013M C ON (B.STK_TYPE_ID = C.CODE_ID AND C.CODE_MASTER_ID = 15) /* 15 : Spare Part Type */
         WHERE A.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -1), 'YYYYMM')
           AND B.STK_TYPE_ID IN (61, 62, 63, 64)
         GROUP BY B.STK_TYPE_ID, C.CODE_NAME
        UNION ALL
        SELECT CASE WHEN TO_NUMBER(B.STK_TYPE_ID) = 61 THEN 'STK'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 62 THEN 'FLT'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 63 THEN 'SPR'
                    WHEN TO_NUMBER(B.STK_TYPE_ID) = 64 THEN 'MSC'
                    END AS STOCK_CODE
             , TO_NUMBER(B.STK_TYPE_ID) AS STOCK_TYPE_ID
             , TO_CHAR(C.CODE_NAME) AS STOCK_TYPE_NAME
             , SUM(A.TOT_QTY) AS TOT_PREV_QTY
             , 0 AS TOT_CURR_QTY
             , SUM(A.TRAN_QTY) AS TRAN_PREV_QTY
             , 0 AS TRAN_CURR_QTY
             , SUM(A.HAND_QTY) AS HAND_PREV_QTY
             , 0 AS HAND_CURR_QTY
             , SUM(A.AGE_QTY) AS AGE_PREV_QTY
             , 0 AS AGE_CURR_QTY
             , SUM(A.STKB_QTY) AS STKB_PREV_QTY
             , 0 AS STKB_CURR_QTY
          FROM SCM0057L A
          LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
          LEFT OUTER JOIN SYS0013M C ON (B.STK_TYPE_ID = C.CODE_ID AND C.CODE_MASTER_ID = 15) /* 15 : Spare Part Type */
         WHERE A.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -2), 'YYYYMM')
           AND B.STK_TYPE_ID IN (61, 62, 63, 64)
         GROUP BY B.STK_TYPE_ID, C.CODE_NAME
        ) A
  LEFT OUTER JOIN SCM0058L B ON (B.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -2), 'YYYYMM') AND A.STOCK_CODE = B.STOCK_CODE)
  LEFT OUTER JOIN SCM0058L C ON (C.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -1), 'YYYYMM') AND A.STOCK_CODE = C.STOCK_CODE)
 GROUP BY A.STOCK_TYPE_ID, A.STOCK_TYPE_NAME, B.DAYS_QTY, C.DAYS_QTY
 ORDER BY A.STOCK_TYPE_ID
</select>
<select id="selectInventoryReportDetail" parameterType="Map" resultType="egovMap">
SELECT D.CODE_NAME AS STOCK_TYPE_NAME
     , C.CODE_NAME AS STOCK_CATEGORY_NAME
     , A.STOCK_CODE
     , B.STK_DESC AS STOCK_NAME
     , A.PURCH_PRC
     , A.TOT_AMT
     , A.TRAN_AMT
     , A.HAND_AMT
     , CASE WHEN E.DAYS_AMT <![CDATA[ > ]]> 999 THEN 999 ELSE E.DAYS_AMT END AS DAYS_AMT
     , A.AGE_AMT
     , A.STKB_AMT
     , A.TOT_QTY
     , A.TRAN_QTY
     , A.HAND_QTY
     , CASE WHEN E.DAYS_AMT <![CDATA[ > ]]> 999 THEN 999 ELSE E.DAYS_AMT END AS DAYS_QTY
     , A.AGE_QTY
     , A.STKB_QTY
     , A.MM6_ISS_QTY
     , A.MM5_ISS_QTY
     , A.MM4_ISS_QTY
     , A.MM3_ISS_QTY
     , A.MM2_ISS_QTY
     , A.MM1_ISS_QTY
     , A.M0_PLAN_QTY
     , A.M1_PLAN_QTY
     , A.M2_PLAN_QTY
     , A.AVG_FORW_QTY
  FROM SCM0057L A
  LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
  LEFT OUTER JOIN SYS0013M C ON (B.STK_CTGRY_ID = C.CODE_ID AND C.CODE_MASTER_ID = 11) /* 11 : Stock Category */
  LEFT OUTER JOIN SYS0013M D ON (B.STK_TYPE_ID = D.CODE_ID AND D.CODE_MASTER_ID = 15) /* 15 : Spare Part Type */
  LEFT OUTER JOIN SCM0058L E ON (A.YEAR_MONTH = E.YEAR_MONTH AND A.STOCK_CODE = E.STOCK_CODE)
 WHERE A.YEAR_MONTH = TO_CHAR(ADD_MONTHS(TO_DATE(#{planYearMonth} || '01', 'YYYYMMDD'), -1), 'YYYYMM')
	<if test="stockTypeId != null and stockTypeId != ''">
   AND D.CODE_ID = #{stockTypeId}
	</if>
 ORDER BY B.STK_TYPE_ID, B.STK_CTGRY_ID, A.STOCK_CODE
</select>
<select id="selectScmCurrency" parameterType="Map" resultType="egovMap">
SELECT A.CODE_ID
     , TO_NUMBER(A.CODE) AS CURR
  FROM SYS0013M A
 WHERE A.CODE_MASTER_ID = 407
</select>
<update id="updateScmCurrency" parameterType="Map">
UPDATE SYS0013M
   SET CODE = #{curr}
 WHERE CODE_ID = #{codeId}
</update>
<resultMap id="scmInventoryMap" type="egovMap"></resultMap>
<select id="executeScmInventory" parameterType="Map" resultType="egovMap" statementType="CALLABLE">
{
     call SP_SCM_0057L_ITF0190(#{staValue, mode=OUT, jdbcType=INTEGER, javaType=int, resultMap=scmInventoryMap}
                             , #{retValue, mode=OUT, jdbcType=VARCHAR, javaType=STRING, resultMap=scmInventoryMap})
 }
</select>
<resultMap id="scmDaysInInventoryMap" type="egovMap"></resultMap>
<select id="executeScmDaysInInventory" parameterType="Map" resultType="egovMap" statementType="CALLABLE">
{
     call SP_SCM_0058L_INSERT(#{staValue, mode=OUT, jdbcType=INTEGER, javaType=int, resultMap=scmInventoryMap}
                            , #{retValue, mode=OUT, jdbcType=VARCHAR, javaType=STRING, resultMap=scmDaysInInventoryMap})
 }
</select>

</mapper>