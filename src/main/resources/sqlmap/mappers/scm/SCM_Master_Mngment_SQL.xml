<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.scm.impl.ScmMasterMngMentMapper"> 

  <!-- SCM MASTER MANAGEMENT -->
  <select id="selectMasterMngmentSearch" parameterType="Map" resultType="egovMap">
			  SELECT 
			        STK_CTGRY_CODE
			      , STOCK_CODE
			      , STOCK_DESC  
			      , DEFAULTSTOCKNAME DEFAUT_STOCK_NAME  
			      , IS_TRGET   
			      , MEMO   
			      , TO_CHAR(START_DT,'DD-MM-YYYY') START_DT
			      , TO_CHAR(END_DT,'DD-MM-YYYY') END_DT
			      , KL_TARGET   
			      , JB_TARGET   
			      , KK_TARGET   
			      , PN_TARGET   
			      , KC_TARGET        
			      , TO_CHAR(KL_MOQ, 'fm999,999') KL_MOQ      
			      , TO_CHAR(JB_MOQ, 'fm999,999') JB_MOQ   
			      , TO_CHAR(KK_MOQ, 'fm999,999') KK_MOQ   
			      , TO_CHAR(PN_MOQ, 'fm999,999') PN_MOQ   
			      , TO_CHAR(KC_MOQ, 'fm999,999') KC_MOQ    
			      , SAFETY_STOCK   
			      , LEAD_TM   
			      , LOADING_QTY
			         
			      , MIN_ORD_QTY       
			      , STK_CTGRY_ID  
			      , STK_CTGRY_NAME   
			      , STK_TYPE_ID   
			      , STK_TYPE_NAME  
			      , STOCK_ID   
			      , DFLT_STOCK   
			 FROM SCM0046V  
			 WHERE STOCK_ID > 0 
		<if test="stockCodeCbBox != null and stockCodeCbBox !=''">
			   AND STOCK_ID = #{stockCodeCbBox}
		</if>
			 ORDER BY STK_CTGRY_CODE
			         ,STOCK_DESC	 
  </select> 

  <!-- WARE HOUSE MAPPING -->
  <select id="selectCdcWareMapping" parameterType="Map" resultType="egovMap">
		SELECT 'delete' FLAG
		      ,t0.WH_ID
		      ,t0.CDC 
		      ,t1.WH_LOC_CODE WH_CODE
		      ,t1.WH_LOC_DESC WH_NAME  
		  FROM SCM0022M  t0
		         LEFT JOIN SYS0028M t1   ON t1.WH_LOC_ID = t0.WH_ID
		 WHERE  t1.WH_LOC_CODE NOT LIKE 'CT%' 
	 <if test="cdcCbBox != null and cdcCbBox !=''">
		   AND t0.CDC= #{cdcCbBox} 
	 </if>
	 
  </select> 
  
  <select id="selectWhLocationMapping" parameterType="Map" resultType="egovMap">
		SELECT WH_LOC_ID WH_ID 
		      , ' ' CDC  
		      , WH_LOC_CODE WH_CODE 
		      , WH_LOC_DESC WH_NAME  
		  FROM SYS0028M 
		 WHERE WH_LOC_CODE LIKE 'DSC%'
		   AND WH_LOC_ID NOT IN ( SELECT WH_ID 
		                            FROM SCM0022M  
		                        )
   
  </select> 
  
  <insert id="insetCdcWhMapping" parameterType="Map">
     INSERT INTO SCM0022M
       (
         WH_ID
        ,CDC
       )
     VALUES
       (
         #{whId}
        ,#{cdc}
       )
  </insert>  
  
  <insert id="deleteCdcWhMapping" parameterType="Map">
     DELETE FROM SCM0022M WHERE  WH_ID = #{whId} AND CDC = #{cdc}
  </insert>  

  <!-- Business Plan Manager -->
  <select id="selectBizPlanManager" parameterType="Map" resultType="egovMap">
		SELECT DISTINCT 
		      PLAN_ID CODE_VALUE 
		    , CDC     CODE_VIEW
	  FROM SCM0005M 
	 WHERE PLAN_YEAR  = #{planYear}  
	 <if test="planMonth != null and planMonth !=''">
	   AND PLAN_MONTH = #{planMonth}  
	 </if>
	   AND PLAN_WEEK  = #{planWeek}  
	   AND PLAN_STUS  = 4
	 ORDER BY PLAN_ID
  </select> 
  
  
  
    
</mapper>