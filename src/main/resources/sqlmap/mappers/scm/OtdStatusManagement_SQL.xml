<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.scm.impl.OtdStatusManagementMapper">

<select id="selectOtdStatus" parameterType="Map" resultType="egovMap">
SELECT A.PO_NO
     , A.PO_ITEM_NO
     , A.STOCK_CODE
     , B.STK_DESC AS NAME
     , B.STK_TYPE_ID AS TYPE_ID
     , C.CODE_NAME AS TYPE
     , A.PO_DT
     , A.PO_QTY
     , A.PO_ITEM_STUS_ID
     , A.SO_NO
     , A.SO_ITEM_NO
     , A.SO_QTY
     , A.SO_DT
     , A.GR_DT
     , A.PP_PLAN_QTY
     , A.PP_PROD_QTY
     , A.PP_PROD_START_DT
     , A.PP_PROD_END_DT
     , A.GI_QTY
     , A.GI_DT
     , A.SBO_PO_QTY
     , A.SBO_AP_QTY
     , A.SBO_GR_QTY
  FROM SCM0039M A
  LEFT OUTER JOIN SYS0026M B ON (A.STOCK_CODE = B.STK_CODE)
  LEFT OUTER JOIN SYS0013M C ON (B.STK_TYPE_ID = C.CODE_ID AND C.CODE_MASTER_ID = 15) /* 15 : Spare Part Type */
 WHERE A.PO_DT BETWEEN '20170101' AND '20171231'
	<if test="poItemStusId != null and poItemStusId != ''">
   AND A.PO_ITEM_STUS_ID = #{poItemStusId}
	</if>
   AND A.PO_NO LIKE '%' || #{poNo} || '%'
	<if test="scmStockTypeCbBox != null and ! scmStockTypeCbBox.isEmpty">
   AND B.STK_TYPE_ID IN
		<foreach item="item" collection="scmStockTypeCbBox" index="index" open="(" separator="," close=")">
		#{item}
		</foreach>
	</if>
 ORDER BY B.STK_CODE
</select>

</mapper>