<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.scm.impl.OtdStatusManagementMapper">

<select id="selectOtdStatus" parameterType="Map" resultType="egovMap">
SELECT B.STK_CODE AS ID
     , B.STK_CODE || ' - ' || B.STK_DESC AS NAME
  FROM SCM0008M A
  LEFT OUTER JOIN SYS0026M B ON (A.STOCK_ID = B.STK_ID)
 WHERE A.IS_TRGET = 1
   AND A.STUS_CODE_ID = 1
   AND B.IS_NCV = 0
   AND B.STUS_CODE_ID = 1
	<if test="scmStockCategory != null and scmStockCategory != ''">
   AND B.STK_CTGRY_ID IN (SELECT REGEXP_SUBSTR (#{scmStockCategory}, '[^,]+', 1, LEVEL) FROM DUAL CONNECT BY REGEXP_SUBSTR (#{scmStockCategory}, '[^,]+', 1, LEVEL) IS NOT NULL)
	</if>
	<if test="scmStockType != null and scmStockType != ''">
   AND B.STK_TYPE_ID IN (SELECT REGEXP_SUBSTR (#{scmStockType}, '[^,]+', 1, LEVEL) FROM DUAL CONNECT BY REGEXP_SUBSTR (#{scmStockType}, '[^,]+', 1, LEVEL) IS NOT NULL)
	</if>
 ORDER BY B.STK_CODE
</select>

</mapper>