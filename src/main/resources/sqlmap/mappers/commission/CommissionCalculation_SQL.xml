<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.commission.calculation.impl.CommissionCalculationMapper">
    
	<!-- searchCommission Procedure Gruop Code All List -->
    <select id="selectCommPrdGroupListl" parameterType="Map" resultType="EgovMap">
		SELECT  CODE FROM(
		  SELECT SUBSTR(CODE,1,2) CODE ,
		  CODE_ID
		  FROM SYS0013M 
		  WHERE CODE_MASTER_ID=#{mstId}
		)
		<![CDATA[
		  WHERE CODE NOT IN ( 'BS'  , 'BA')
		]]>
		GROUP BY CODE
		ORDER BY CODE
    </select>
    
    <!-- searchOrganization Gruop Code All List -->
    <select id="selectOrgCdListAll" parameterType="Map" resultType="EgovMap">
    <![CDATA[
    SELECT
    ORG_CD ,
    ORG_NM 
    FROM CMM0041C
    WHERE 1=1
      AND START_YEARMONTH < END_YEARMONTH
     ]]>
        <if test="orgRgCombo != null and orgRgCombo != ''">
            AND ORG_GR_CD = #{orgRgCombo}
        </if>    
    <![CDATA[
    GROUP BY ORG_CD, ORG_NM
    ORDER BY ORG_CD
     ]]>
    </select>
    
    <!-- search Calculation Procedure List -->
    <select id="selectCalculationList" parameterType="Map" resultType="EgovMap">
    <![CDATA[
	   SELECT 
		    T1.CODE_MASTER_ID , 
		    T2.CODE_ID ,
		    substr(T2.CODE,0,7) code, 
		    T2.CODE_NAME , 
		    T2.CODE_DESC AS CDDS, 
		    T4.CAL_STATE,
		    (CASE T4.CAL_STATE WHEN '0' THEN 'SUCCESS'
                    WHEN '1' THEN 'RODING'
                    WHEN '9' THEN 'FAIL'
                    WHEN '8' THEN 'STOP'
            END) stateNm,
		    TO_CHAR(T4.CAL_START_TIME,'yyyy-mm-dd hh24:mi:ss') CAL_START_TIME,
		    SUBSTR(T2.CODE,0,2)  CD, SUBSTR(T2.CODE,9,9) NM
		FROM SYS0012M T1 JOIN SYS0013M T2 
		        ON T1.CODE_MASTER_ID = T2.CODE_MASTER_ID 
		    LEFT JOIN (
		        SELECT  CAL_CODE,MAX(CAL_SEQ) AS CAL_SEQ 
		        FROM CMM0053M 
		        WHERE CAL_YEAR_MONTH=#{searchDt}
		        GROUP BY CAL_CODE
		    )  T3
		        ON T2.CODE_ID = T3.CAL_CODE
		   LEFT JOIN CMM0053M T4 ON T4.CAL_SEQ = T3.CAL_SEQ
        WHERE 1=1
           AND T2.DISAB =0
         ]]>
        <if test="mstId != null and mstId != ''">
            AND T1.CODE_MASTER_ID=#{mstId}
        </if>
        <if test="ItemGrCd != null and ItemGrCd != ''">
            AND T2.CODE LIKE #{ItemGrCd} ||'%'
        </if>
            AND CODE NOT LIKE 'BS%'
        ORDER BY CD, NM
    </select>
    
    <!-- search Basic Procedure List -->
    <select id="selectBasicList" parameterType="Map" resultType="EgovMap">
    <![CDATA[
        SELECT 
		    T1.CODE_MASTER_ID , T2.CODE_ID ,
		    substr(T2.CODE,0,7) code, T2.CODE_NAME , T2.CODE_DESC AS CDDS, SUBSTR(T2.CODE,9,9) NM 
		FROM SYS0012M T1 JOIN SYS0013M T2 
		        ON T1.CODE_MASTER_ID = T2.CODE_MASTER_ID 
		WHERE 1=1
         ]]>
        <if test="mstId != null and mstId != ''">
            AND T1.CODE_MASTER_ID=#{mstId}
        </if>
            AND CODE LIKE 'BSD%'
            AND T2.DISAB =0
        ORDER BY NM
    </select>
    <select id="selectBasicStatus" parameterType="Map" resultType="Map">
        SELECT 
			TO_CHAR(T1.CAL_START_TIME,'yyyy-mm-dd hh24:mi:ss') CAL_START_TIME,
			(CASE T1.CAL_STATE WHEN '0' THEN 'SUCCESS'
                    WHEN '1' THEN 'RODING'
                    WHEN '9' THEN 'FAIL'
                    WHEN '8' THEN 'STOP'
            END) stateNm
		FROM CMM0053M t1 join (
		        SELECT MAX(CAL_SEQ) CAL_SEQ 
		        FROM CMM0053M 
		        WHERE CAL_CODE=2455
		          AND CAL_YEAR_MONTH = #{searchDt}
		    ) T2 ON T1.CAL_SEQ = T2.CAL_SEQ
    </select>
    
   	<!-- proceduar Log Insert -->
    <insert id="callCommPrdLogIns" parameterType="Map">
        INSERT INTO CMM0053M(CAL_SEQ, CAL_CODE, CAL_NAME, CAL_STATE, CAL_START_TIME, CAL_CHECK_LAST_YN, CRT_USER_ID, CRT_DT,CAL_YEAR_MONTH)
            VALUES(CMM0053M_CAL_SEQ.nextval, ${codeId}, #{procedureNm}, #{state}, sysdate, 'Y', #{loginId}, sysdate,#{calYM})
    </insert> 
    
    <!-- proceduar Last Log Extraction Select -->
    <select id="selectCommRunningPrdLog" parameterType="Map" resultType="EgovMap">
        SELECT 
            CAL_SEQ, CAL_CODE, CAL_NAME, CAL_STATE, CAL_START_TIME, 
            CAL_CHECK_LAST_YN, CRT_USER_ID, CRT_DT,CAL_YEAR_MONTH
        FROM CMM0053M
        WHERE 1=1
            <if test="codeId != null and codeId != ''">
                AND CAL_CODE = #{codeId} 
            </if>
            AND CAL_CHECK_LAST_YN = 'Y' AND CAL_STATE= 1
        ORDER BY CAL_START_TIME DESC
    </select>  
    
    <!-- proceduar Log  Last Update -->
    <update id="callCommLogUpdate">
        UPDATE CMM0053M SET  
            CAL_CHECK_LAST_YN = 'N' ,
            UPD_USER_ID = #{loginId} ,
            UPD_DT = sysdate
        WHERE CAL_CODE = #{codeId}
    </update>
    
    <!-- proceduar Log Update -->
    <update id="callCommPrdLog" parameterType="Map">
        UPDATE CMM0053M SET  
			CAL_CHECK_LAST_YN = 'Y' ,
			CAL_END_TIME = sysdate ,
            <if test="v_sqlcode != null and v_sqlcode != ''">
			CAL_ERROR_CODE =#{v_sqlcode},
			</if>
			<if test="v_sqlcont != null and v_sqlcont != ''">
			 CAL_ERROR_CONTENTS =#{v_sqlcont},
			</if>
			CAL_STATE = #{state} 
        WHERE CAL_CODE = #{codeId}
            AND CAL_SEQ= #{calSeq}
    </update> 
    
    
    <!-- proceduar call -->
    <select id="callCommProcedure" parameterType="Map"  statementType="CALLABLE" resultType="EgovMap">
        {
        call  ${procedureNm}(${taskId},#{searchDt},${loginId},#{v_procname,mode=OUT,jdbcType=VARCHAR},#{v_result,mode=OUT,jdbcType=VARCHAR}, #{ v_sqlcode,mode=OUT,jdbcType=VARCHAR} , #{ v_sqlcont,mode=OUT,jdbcType=VARCHAR})
        }
    </select>
    
    <!-- Log List select -->
    <select id="selectLogList" parameterType="Map" resultType="EgovMap">
        SELECT 
		  SUBSTR(T2.CODE,1,3) CODE, 
		  T2.CODE_NAME, 
		  T2.CODE_DESC , 
		  to_char(T1.CAL_START_TIME, 'yyyy-mm-dd hh24:mi:ss') CAL_START_TIME, 
		  to_char(T1.CAL_END_TIME, 'yyyy-mm-dd hh24:mi:ss') CAL_END_TIME,
		  T1.CAL_STATE,
		  (CASE T1.CAL_STATE WHEN '0' THEN 'SUCCESS'
                    WHEN '1' THEN 'RODING'
                    WHEN '9' THEN 'FAIL'
                    WHEN '8' THEN 'STOP'
            END) stateNm,
		  T1.CAL_ERROR_CODE, 
		  T1.CAL_ERROR_CONTENTS,
		  T1.CRT_USER_ID,
		  T1.CAL_YEAR_MONTH
		FROM CMM0053M T1 JOIN SYS0013M T2 
		ON T1.CAL_CODE=T2.CODE_ID
		WHERE 1=1
		<if test="codeId != null and codeId != ''">
		  and T1.CAL_CODE= #{codeId}
		</if>
		<if test="calName != null and calName != ''">
          and T1.CAL_NAME LIKE #{calName}||'%'
        </if>
		ORDER BY T1.CAL_SEQ DESC
    </select>

    <!-- searchOrganization Gruop List -->
    <select id="selectOrgGrList" parameterType="Map" resultType="EgovMap">
       <![CDATA[
        SELECT
        T2.CODE_MASTER_ID AS mstId ,
        T1.CODE_MASTER_NAME AS mstNm,
        T2.CODE_ID AS cdId,
        T2.CODE AS cd,
        T2.CODE_NAME AS cdNm,
        T2.CODE_DESC AS cdDs
        FROM SYS0012M T1
        JOIN SYS0013M T2
        ON T1.CODE_MASTER_ID = T2.CODE_MASTER_ID
        WHERE 1=1
         ]]>
        <if test="mstId != null and mstId != ''">
            AND T1.CODE_MASTER_ID = #{mstId}
            AND T2.CODE_ID IN (1,2,3)
        </if>
         <![CDATA[
        ORDER BY T2.CODE
         ]]>
    </select>
    
    
    
    <!-- ########################################################## -->
    <!--                                                   CMM0028D                                                     -->
    <!-- ########################################################## -->
    <select id="cntCMM0028D" parameterType="Map" resultType="integer">
        SELECT 
          count(*) cnt
        FROM CMM0028D T1 JOIN ORG0001D T2 
              ON T1.EMPLY_ID = T2.MEM_ID
          JOIN SYS0013M T3
              ON T2.MEM_TYPE = T3.CODE_ID
          JOIN CMM0006T T4 
              ON T1.EMPLY_ID= T4.EMPLY_ID
                  AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
          AND T3.CODE = #{codeGruop}
          AND T4.EMPLY_LEV = #{emplyLev}
          <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    
    <select id="selectCMM0028DCT" parameterType="Map" resultType="EgovMap">
		SELECT 
		  T1.TASK_ID,T1.RUN_ID,T1.EMPLY_ID,T4.EMPLY_CODE ,T2.MEM_TYPE MEM_TYPE,
		  nvl(V1,'0') v1,nvl(V2,'0') v2,nvl(V3,'0') v3,nvl(V4,'0') v4,nvl(V5,'0') v5,
		  nvl(V6,'0') v6,nvl(V7,'0') v7,nvl(V8,'0') v8,nvl(V9,'0') v9,nvl(V10,'0') v10,
		  nvl(V11,'0') v11,nvl(V12,'0') v12,nvl(V13,'0') v13,nvl(V14,'0') v14 
		FROM CMM0028D T1 JOIN ORG0001D T2 
		      ON T1.EMPLY_ID = T2.MEM_ID
		  JOIN SYS0013M T3
		      ON T2.MEM_TYPE = T3.CODE_ID
		  JOIN CMM0006T T4 
		      ON T1.EMPLY_ID= T4.EMPLY_ID
		          AND T4.COMM_TASK_ID = #{taskId}
		WHERE T1.TASK_ID = #{taskId}
		  AND T3.CODE = #{codeGruop}
		  AND T4.EMPLY_LEV = #{emplyLev}
		  <if test="memberCd != null and memberCd != ''">
		      AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
		  </if>
    </select>
    <select id="selectCMM0028DCD" parameterType="Map" resultType="EgovMap">
        SELECT 
          T1.TASK_ID,T1.RUN_ID,T1.EMPLY_ID,T4.EMPLY_CODE ,T2.MEM_TYPE MEM_TYPE,
          nvl(V1,'0') v1,nvl(V2,'0') v2,nvl(V3,'0') v3,nvl(V4,'0') v4,nvl(V5,'0') v5,
          nvl(V6,'0') v6,nvl(V7,'0') v7,nvl(V8,'0') v8,nvl(V9,'0') v9,nvl(V10,'0') v10,
          nvl(V11,'0') v11,nvl(V12,'0') v12,nvl(V13,'0') v13,nvl(V14,'0') v14,nvl(V15,'0') v15,
          nvl(V16,'0') v16,nvl(V17,'0') v17,nvl(V18,'0') v18,nvl(V19,'0') v19,nvl(V20,'0') v20,
          nvl(V21,'0') v21,nvl(V22,'0') v22,nvl(V23,'0') v23,nvl(V24,'0') v24,nvl(V25,'0') v25,
          nvl(V26,'0') v26,nvl(V27,'0') v27,nvl(V29,'0') v29,nvl(V30,'0') v30,
          nvl(V31,'0') v31,nvl(V32,'0') v32,nvl(V33,'0') v33
        FROM CMM0028D T1 JOIN ORG0001D T2 
              ON T1.EMPLY_ID = T2.MEM_ID
          JOIN SYS0013M T3
              ON T2.MEM_TYPE = T3.CODE_ID
          JOIN CMM0006T T4 
              ON T1.EMPLY_ID= T4.EMPLY_ID
                  AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
          AND T3.CODE = #{codeGruop}
          AND T4.EMPLY_LEV = #{emplyLev}
          <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    <select id="selectCMM0028DHP" parameterType="Map" resultType="EgovMap">
        SELECT 
          T1.TASK_ID,T1.RUN_ID,T1.EMPLY_ID,T4.EMPLY_CODE ,T2.MEM_TYPE MEM_TYPE,
          nvl(V1,'0') v1,nvl(V8,'0') v8,nvl(V9,'0') v9,nvl(V13,'0') v13,nvl(V14,'0') v14,
          nvl(V15,'0') v15,nvl(V16,'0') v16,nvl(V17,'0') v17,nvl(V18,'0') v18,nvl(V19,'0') v19,
          nvl(V20,'0') v20, nvl(V21,'0') v21,nvl(V22,'0') v22,nvl(V24,'0') v24,nvl(V25,'0') v25,
          nvl(V26,'0') v26,nvl(V27,'0') v27,nvl(V28,'0') v28
        FROM CMM0028D T1 JOIN ORG0001D T2 
              ON T1.EMPLY_ID = T2.MEM_ID
          JOIN SYS0013M T3
              ON T2.MEM_TYPE = T3.CODE_ID
          JOIN CMM0006T T4 
              ON T1.EMPLY_ID= T4.EMPLY_ID
                  AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
          AND T3.CODE = #{codeGruop}
          AND T4.EMPLY_LEV = #{emplyLev}
          <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    
    <!-- ########################################################## -->
    <!--                                                   CMM0029D                                                     -->
    <!-- ########################################################## -->
    <select id="cntCMM0029D" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0029D T1 JOIN ORG0001D T2 
                ON T1.EMPLY_ID = T2.MEM_ID
            JOIN SYS0013M T3
                ON T2.MEM_TYPE = T3.CODE_ID
            JOIN CMM0006T T4 
                ON T1.EMPLY_ID= T4.EMPLY_ID
                     AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
            AND T3.CODE = #{codeGruop}
            AND T4.EMPLY_LEV = #{emplyLev}
            <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    
    <select id="selectCMM0029DCT" parameterType="Map" resultType="EgovMap">
        SELECT T1.TASK_ID, T1. EMPLY_ID, T4. EMPLY_CODE,T1.RUN_ID,T2.MEM_TYPE MEM_TYPE,
            nvl(T1.R1,'0') r1,nvl(T1.R2,'0') r2,nvl(T1.R3,'0') r3,nvl(T1.R4,'0') r4,nvl(T1.R5,'0') r5,
            nvl(T1.R6,'0') r6,nvl(T1.R7 ,'0') r7,nvl(T1.R8 ,'0') r8
		FROM CMM0029D T1 JOIN ORG0001D T2 
		        ON T1.EMPLY_ID = T2.MEM_ID
		    JOIN SYS0013M T3
		        ON T2.MEM_TYPE = T3.CODE_ID
		    JOIN CMM0006T T4 
		        ON T1.EMPLY_ID= T4.EMPLY_ID
		             AND T4.COMM_TASK_ID = #{taskId}
		WHERE T1.TASK_ID = #{taskId}
		    AND T3.CODE = #{codeGruop}
		    AND T4.EMPLY_LEV = #{emplyLev}
		    <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    <select id="selectCMM0029DCD" parameterType="Map" resultType="EgovMap">
        SELECT T1.TASK_ID, T1. EMPLY_ID, T4. EMPLY_CODE,T1.RUN_ID,T2.MEM_TYPE MEM_TYPE,
            nvl(T1.R1,'0') r1,nvl(T1.R2,'0') r2,nvl(T1.R3,'0') r3 ,nvl(T1.R4,'0') r4,nvl(T1.R5,'0') r5,
            nvl(T1.R6,'0') r6,nvl(T1.R7,'0') r7,nvl(T1.R8,'0') r8,nvl(T1.R10,'0') r10,nvl(T1.R11,'0')r11,
            nvl(T1.R13,'0') r13,nvl(T1.R18,'0') r18,nvl(T1.R19,'0') r19,nvl(T1.R20,'0') r20, nvl(T1.R21,'0') r21,
            nvl(T1.R22,'0') r22,nvl(T1.R23,'0') r23,nvl(T1.R24,'0') r24,nvl(T1.R26,'0') r26,nvl(T1.R27,'0') r27,
            nvl(T1.R28,'0') r28,nvl(T1.R29,'0') r29,nvl(T1.R30,'0') r30,nvl(T1.R31,'0') r31,nvl(T1.R32,'0') r32,
            nvl(T1.R33,'0') r33,nvl(T1.R34,'0') r34,nvl(T1.R35,'0') r35,nvl(T1.R36,'0') r36,nvl(T1.R38,'0') r38,
            nvl(T1.R39,'0') r39,nvl(T1.R40,'0') r40,nvl(T1.R41,'0') r41,nvl(T1.R42,'0') r42,nvl(T1.R99,'0') r99
        FROM CMM0029D T1 JOIN ORG0001D T2 
                ON T1.EMPLY_ID = T2.MEM_ID
            JOIN SYS0013M T3
                ON T2.MEM_TYPE = T3.CODE_ID
            JOIN CMM0006T T4 
                ON T1.EMPLY_ID= T4.EMPLY_ID
                     AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
            AND T3.CODE = #{codeGruop}
            AND T4.EMPLY_LEV = #{emplyLev}
            <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    <select id="selectCMM0029DHP" parameterType="Map" resultType="EgovMap">
        SELECT T1.TASK_ID, T1. EMPLY_ID, T4. EMPLY_CODE,T1.RUN_ID,T2.MEM_TYPE MEM_TYPE,
            nvl(T1.R1,'0') r1,nvl(T1.R2,'0') r2,nvl(T1.R3,'0') r3,nvl(T1.R4,'0') r4,nvl(T1.R5,'0') r5,
            nvl(T1.R13,'0') r13,nvl(T1.R18,'0') r18,nvl(T1.R19,'0') r19,nvl(T1.R20,'0') r20,nvl(T1.R21,'0') r21,
            nvl(T1.R22,'0') r22,nvl(T1.R25,'0') r25,nvl(T1.R28,'0') r28,nvl(T1.R29,'0') r29,nvl(T1.R30,'0') r30,
            nvl(T1.R31,'0') r31,nvl(T1.R32,'0') r32,nvl(T1.R33,'0') r33,nvl(T1.R34,'0') r34,nvl(T1.R35,'0') r35,
            nvl(T1.R36,'0') r36,nvl(T1.R39,'0') r39,nvl(T1.R40,'0') r40,nvl(T1.R41,'0') r41,nvl(T1.R42,'0') r42,
            nvl(T1.R99,'0') r99
        FROM CMM0029D T1 JOIN ORG0001D T2 
                ON T1.EMPLY_ID = T2.MEM_ID
            JOIN SYS0013M T3
                ON T2.MEM_TYPE = T3.CODE_ID
            JOIN CMM0006T T4 
                ON T1.EMPLY_ID= T4.EMPLY_ID
                     AND T4.COMM_TASK_ID = #{taskId}
        WHERE T1.TASK_ID = #{taskId}
            AND T3.CODE = #{codeGruop}
            AND T4.EMPLY_LEV = #{emplyLev}
            <if test="memberCd != null and memberCd != ''">
              AND T4.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
          </if>
    </select>
    
    
    <!-- ########################################################## -->
    <!--                                                        BAISC                                                      -->
    <!-- ########################################################## -->
    <select id="cntCMM0006T" parameterType="Map" resultType="int">
        SELECT COUNT(*) FROM(
	        SELECT T1.COMM_TASK_ID,T1.IS_EXCLUDE
	        FROM CMM0006T T1 JOIN ORG0001D T2 
	                ON T1.EMPLY_ID = T2.MEM_ID
	            JOIN SYS0013M T3
	                ON T2.MEM_TYPE = T3.CODE_ID
	         WHERE T1.COMM_TASK_ID = #{taskId} 
	            <if test="codeId != null and codeId != ''">
	              AND T3.CODE_ID= #{codeId}
	            </if>
	            <if test="memberCd != null and memberCd != ''">
                  AND T1.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
                </if>
            ) scr
            WHERE scr.COMM_TASK_ID = #{taskId}
            <if test="useYnCombo != null and useYnCombo != ''">
              AND  scr.IS_EXCLUDE = #{useYnCombo}
            </if>
    </select>
    <select id="selectCMM0006T" parameterType="Map" resultType="EgovMap">
        SELECT 
            NVL( DEPT_CODE,' ') DEPT_CODE,
			NVL( MANGR_ID,0) mangrId,
			NVL( MEM_ID,0) MEM_ID,
			NVL( EMPLY_TYPE_CODE ,' ') EMPLY_TYPE_CODE,
			NVL( joinDt,' ') joinDt,
			NVL( EMPLY_LEV,0) EMPLY_LEV,
			NVL(EMPLY_LEV_AGE,0) EMPLY_LEV_AGE,
			NVL( WORKING_MONTH,0) WORKING_MONTH,
			NVL(SPONS_CODE,' ') SPONS_CODE,
			NVL(EMPLY_STUS_ID,0) EMPLY_STUS_ID,
			NVL( EMPLY_STUS_CODE,' ') EMPLY_STUS_CODE,
			NVL(EMPLY_LEV_RANK,0) EMPLY_LEV_RANK,
			NVL(EMPLY_VEH,0) emplyVeh,
			NVL(EMPLY_BIZ_TYPE_ID,0) EMPLY_BIZ_TYPE_ID,
			NVL(MANGR_CODE ,' ') mangrCode,
			NVL(EMPLY_CODE,' ') emplyCode,
			NVL(PAY_STUS,0) payStus,
			NVL(IS_HSPTLZ,0) isHsptlz,
			NVL( RUN_ID,0) RUN_ID,
			NVL(COMM_TASK_ID,0) taskId,
			NVL(IS_EXCLUDE  ,0) IS_EXCLUDE
         FROM(
	        SELECT 
	          T1.DEPT_CODE, T1.MANGR_ID, T2.MEM_ID,T1.EMPLY_TYPE_CODE,TO_CHAR(T1.JOIN_DT,'yyyy-mm-dd') joinDt,
	          T1.EMPLY_LEV,T1.EMPLY_LEV_AGE,T1.WORKING_MONTH,T1.SPONS_CODE,T1.EMPLY_STUS_ID,
	          T1.EMPLY_STUS_CODE,T1.EMPLY_LEV_RANK,T1.EMPLY_VEH,T1.EMPLY_BIZ_TYPE_ID, 
	          T1.MANGR_CODE, T1.EMPLY_CODE, T1.PAY_STUS, T1.IS_HSPTLZ,
	          T1.RUN_ID,T1.COMM_TASK_ID,nvl(T1.IS_EXCLUDE,'0') IS_EXCLUDE
	        FROM CMM0006T T1 JOIN ORG0001D T2 
	                ON T1.EMPLY_ID = T2.MEM_ID
	            JOIN SYS0013M T3
	                ON T2.MEM_TYPE = T3.CODE_ID
	         WHERE T1.COMM_TASK_ID = #{taskId} 
	            <if test="codeId != null and codeId != ''">
	              AND T3.CODE_ID= #{codeId}
	            </if>
	            <if test="memberCd != null and memberCd != ''">
	              AND T1.EMPLY_CODE LIKE '%'|| #{memberCd} ||'%'
	            </if>
            ) scr
            WHERE scr.COMM_TASK_ID = #{taskId}
            <if test="useYnCombo != null and useYnCombo != ''">
              AND  scr.IS_EXCLUDE = #{useYnCombo}
            </if>
         ORDER BY scr.RUN_ID
    </select>
    
    <select id="cntCMM0007T" parameterType="Map" resultType="integer">
        SELECT COUNT(*) cnt FROM(
	        SELECT  T1.TASK_ID,T1.IS_EXCLUDE
	        FROM CMM0007T T1 JOIN ORG0001D T2 
	                ON T1.SALES_EMPLY_ID = T2.MEM_ID
	            JOIN SYS0013M T3
	                ON T2.MEM_TYPE = T3.CODE_ID
	         WHERE T1.TASK_ID = #{taskId}  
	             <if test="codeId != null and codeId != ''">
	              AND T3.CODE_ID= #{codeId}
	            </if>
	            <if test="memberCd != null and memberCd != ''">
	              AND T2.MEM_CODE LIKE '%'|| #{memberCd} ||'%' 
	            </if>
	            <if test="ordId != null and ordId != ''">
	              AND T1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
	            </if>
            ) scr
            WHERE scr.TASK_ID=#{taskId}  
            <if test="useYnCombo != null and useYnCombo != ''">
              AND  scr.IS_EXCLUDE = #{useYnCombo} 
            </if>
    </select>
    <select id="selectCMM0007T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(ORD_ID,'0') ORD_ID,
			nvl(MEM_ID,'0') MEM_ID,
			nvl(CODE,'0') CODE,
			nvl(ORD_TYPE_ID,'0') ORD_TYPE_ID,
			nvl(PRODUCT_ID,'0') PRODUCT_ID,
			nvl(UNIT_VALU,'0') UNIT_VALU,
			nvl(PRC,'0') PRC,
			nvl(PV_VALU,'0') PV_VALU,
			nvl(RUN_ID,'0') RUN_ID,
			nvl(TASK_ID,'0') TASK_ID,
			nvl(IS_EXCLUDE,'0') IS_EXCLUDE
         FROM(
            SELECT 
	            T1.ORD_ID, T2.MEM_ID,T3.CODE,  T1.ORD_TYPE_ID, T1.PRODUCT_ID, T1.UNIT_VALU,
	            T1.PRC, T1.PV_VALU,T1.RUN_ID,T1.TASK_ID, T1.IS_EXCLUDE
			FROM CMM0007T T1 JOIN ORG0001D T2 
			        ON T1.SALES_EMPLY_ID = T2.MEM_ID
			    JOIN SYS0013M T3
			        ON T2.MEM_TYPE = T3.CODE_ID
			 WHERE T1.TASK_ID = #{taskId}  
			     <if test="codeId != null and codeId != ''">
	              AND T3.CODE_ID= #{codeId}
	            </if>
			    <if test="memberCd != null and memberCd != ''">
			      AND T2.MEM_CODE LIKE '%'|| #{memberCd} ||'%' 
			    </if>
			    <if test="ordId != null and ordId != ''">
			      AND T1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
			    </if>
		    )scr
		    WHERE scr.TASK_ID=#{taskId}  
		    <if test="useYnCombo != null and useYnCombo != ''">
		      AND  scr.IS_EXCLUDE = #{useYnCombo} 
		    </if>
         ORDER BY scr.RUN_ID
    </select>
    
    <select id="cntCMM0008T" parameterType="Map" resultType="integer">
         SELECT 
            count(*) cnt
        FROM CMM0008T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0008T s1 JOIN CMM0006T s2 
                  ON s1.SVC_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId}  
                  <if test="svcPersonCd != null and svcPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{svcPersonCd} ||'%'   
                  </if>
                  <if test="codeId != null and codeId != ''">
                    AND s2.EMPLY_TYPE_ID = #{codeId}
                  </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}  
            <if test="useYnCombo != null and useYnCombo != ''">
              AND T2.IS_EXCLUDE = #{useYnCombo}
            </if>
    </select>
    <select id="selectCMM0008T" parameterType="Map" resultType="EgovMap">
		 SELECT 
		    nvl(T1.BS_SCHDUL_ID,'0') BS_SCHDUL_ID,
			nvl(T1.SVC_PERSON_ID,'0') SVC_PERSON_ID,
			nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
			nvl(T1.BS_STUS_ID,'0') BS_STUS_ID,
			nvl(T1.CRDIT_POINT,'0') CRDIT_POINT,
			nvl(T1.RUN_ID,'0') RUN_ID,
			nvl(T1.TASK_ID,'0') TASK_ID,
			nvl(T2.IS_EXCLUDE, '0') IS_EXCLUDE
		FROM CMM0008T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0008T s1 JOIN CMM0006T s2 
                  ON s1.SVC_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId}  
                  <if test="svcPersonCd != null and svcPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{svcPersonCd} ||'%'   
                  </if>
                  <if test="codeId != null and codeId != ''">
                    AND s2.EMPLY_TYPE_ID = #{codeId}
                  </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
		WHERE T1.TASK_ID = #{taskId}  
			<if test="useYnCombo != null and useYnCombo != ''">
	          AND T2.IS_EXCLUDE = #{useYnCombo}
	        </if>
		ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0009T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0009T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0009T s1 JOIN CMM0006T s2 
                  ON s1.SVC_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId} 
                <if test="svcPersonCd != null and svcPersonCd != ''"> 
                  AND s2.EMPLY_CODE LIKE '%'|| #{svcPersonCd} ||'%'     
                </if>
                <if test="ordId != null and ordId != ''">
                  AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID
        WHERE T1.TASK_ID = #{taskId} 
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0009T" parameterType="Map" resultType="EgovMap">
		SELECT 
		    nvl(T1.SVC_PERSON_ID,'0') SVC_PERSON_ID,
			nvl(T1.HAPY_CALL_ID,'0') HAPY_CALL_ID ,
			nvl(T1.ORD_ID,'0') ORD_ID ,
			nvl(T1.CUST_RESPNS_ID,'0') CUST_RESPNS_ID,
			nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
			nvl(T1.PNCTULT,'0') PNCTULT,
			nvl(T1.APPRAN,'0') APPRAN,
			nvl(T1.XPLNT,'0') XPLNT,
			nvl(T1.QLY,'0') QLY,
			nvl(T1.OVERAL,'0')OVERAL ,
			nvl(T1.RUN_ID,'0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0009T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0009T s1 JOIN CMM0006T s2 
                  ON s1.SVC_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID=#{taskId} 
		        <if test="svcPersonCd != null and svcPersonCd != ''"> 
		          AND s2.EMPLY_CODE LIKE '%'|| #{svcPersonCd} ||'%'     
		        </if>
		        <if test="ordId != null and ordId != ''">
		          AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
		        </if>
		        <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID
		WHERE T1.TASK_ID = #{taskId} 
		<if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
		ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0010T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0010T T1 JOIN (
                SELECT s1.RUN_ID, nvl(s1.IS_EXCLUDE,'0') IS_EXCLUDE
                FROM CMM0010T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId} 
                <if test="salesPersonCd != null and salesPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%'   
                </if>
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
        )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID =#{taskId} 
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0010T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.SALES_PERSON_ID,'0') SALES_PERSON_ID ,
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
			nvl(T1.MBRSH_ID,'0') MBRSH_ID ,
			nvl(T1.ORD_ID,'0') ORD_ID ,
			nvl(T1.MBRSH_AMT,'0')MBRSH_AMT ,
			nvl(T1.RUN_ID,'0') RUN_ID,
			nvl(T1.TASK_ID,'0') TASK_ID,
			nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE 
		FROM CMM0010T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0010T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId} 
	            <if test="salesPersonCd != null and salesPersonCd != ''">
	                AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%'   
	            </if>
	            <if test="ordId != null and ordId != ''">
	                AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
	            </if>
	            <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
	    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID =#{taskId} 
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
         ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0011T" parameterType="Map" resultType="integer">
        SELECT 
             count(*) cnt
         FROM CMM0011T T1 JOIN (
                SELECT s1.RCORD_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0011T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId} 
                <if test="salesPersonCd != null and salesPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%'   
                </if>
                 <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RCORD_ID=t2.RCORD_ID 
         WHERE T1.TASK_ID = #{taskId} 
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0011T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.RCORD_ID, '0') RCORD_ID,
            nvl(T1.ORD_ID , '0') ORD_ID,
            nvl(T1.SALES_PERSON_ID, '0') SALES_PERSON_ID,
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
            nvl(T1.INSTLMT, '0') INSTLMT,
            nvl(T1.PV, '0') PV,
            nvl(T1.PRC ,'0') PRC,
		    nvl(T1.ORD_TYPE_ID, '0') ORD_TYPE_ID,
		    nvl(T1.BILL_RUN_ID,'0') runId, 
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0011T T1 JOIN (
		        SELECT s1.RCORD_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0011T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId} 
		        <if test="salesPersonCd != null and salesPersonCd != ''">
		            AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%'   
		        </if>
		         <if test="ordId != null and ordId != ''">
		            AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
		        </if>
		        <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RCORD_ID=t2.RCORD_ID 
         WHERE T1.TASK_ID = #{taskId} 
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
         ORDER BY t1.BILL_RUN_ID
    </select>
    
    <select id="cntCMM0012T" parameterType="Map" resultType="integer">
        SELECT 
	        count(*) cnt
        FROM CMM0012T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0012T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                <if test="clctrCd != null and clctrCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{clctrCd} ||'%'   
                </if>
                <if test="ordId != null and ordId != ''">
                  AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0012T" parameterType="Map" resultType="EgovMap">
        SELECT 
	       nvl(T1.CLCTR_ID, 0) CLCTR_ID,
	       nvl(T1.ORD_ID, 0) ORD_ID,
	       nvl(T1.TRGET_AMT, 0) TRGET_AMT,
	       nvl(T1.COLCT_AMT, 0) COLCT_AMT,
	       nvl(T1.CUST_RACE_ID , 0) CUST_RACE_ID,
		   nvl(T1.RENT_PAY_MODE_ID,  0) RENT_PAY_MODE_ID,
		   nvl(T1.CUST_ID, 0) CUST_ID,
		   nvl(T2.EMPLY_CODE, ' ') EMPLY_CODE,
		   nvl(T1.RUN_ID, 0) RUN_ID,
		   nvl(T1.TASK_ID, 0) TASK_ID,
		   nvl(T2.IS_EXCLUDE, 0) IS_EXCLUDE
		FROM CMM0012T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0012T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		        <if test="clctrCd != null and clctrCd != ''">
		          AND s2.EMPLY_CODE LIKE '%'|| #{clctrCd} ||'%'   
		        </if>
		        <if test="ordId != null and ordId != ''">
		          AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
		        </if>
		        <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
         ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0013T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0013T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0013T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
                <if test="clctrCd != null and clctrCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{clctrCd} ||'%'   
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0013T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.CLCTR_ID, '0') CLCTR_ID,
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.STRTG_OS, '0') STRTG_OS,
            nvl(T1.CLOS_OS, '0') CLOS_OS,
            nvl(T1.IS_DROP,'0') IS_DROP,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0013T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0013T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		        <if test="ordId != null and ordId != ''">
		            AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'   
		        </if>
		        <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
                <if test="clctrCd != null and clctrCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{clctrCd} ||'%'   
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
         ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0014T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0014T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE ,s2.EMPLY_CODE
                FROM CMM0014T s1 JOIN CMM0006T s2 
                  ON s1.EMPLY_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                <if test="emplyCd != null and emplyCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0014T" parameterType="Map" resultType="EgovMap">
		SELECT 
		    nvl(T1.EMPLY_ID, '0') EMPLY_ID,
		    nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
		    nvl(T1.SPONS_ID, '0') SPONS_ID,
		    nvl(T1.INSTLMT, '0') INSTLMT,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID,'0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0014T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE ,s2.EMPLY_CODE
		        FROM CMM0014T s1 JOIN CMM0006T s2 
                  ON s1.EMPLY_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		        <if test="emplyCd != null and emplyCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
		WHERE T1.TASK_ID = #{taskId}
		<if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
		ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0015T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0015T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0015T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                <if test="ordId != null and ordId != ''">
                  AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="emplyCd != null and emplyCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0015T" parameterType="Map" resultType="EgovMap">
		SELECT 
		    nvl(T1.PAY_ID, '0') PAY_ID,
		    nvl(T1.ORD_ID, '0') ORD_ID,
		    nvl(T1.CLCTR_ID,'0') CLCTR_ID,
		    nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
		    nvl(T1. AMT,'0') AMT,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID , '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0015T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0015T s1 JOIN CMM0006T s2 
                  ON s1.CLCTR_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		        <if test="ordId != null and ordId != ''">
		          AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="emplyCd != null and emplyCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
		WHERE T1.TASK_ID = #{taskId}
		<if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0016T" parameterType="Map" resultType="integer">
        SELECT 
          count(*) cnt 
        FROM CMM0016T t1 JOIN CMM0006T t2 
               ON t1.P_MEM_ID=t2.EMPLY_ID 
                   AND t2.IS_EXCLUDE=0 
                   AND t2.COMM_TASK_ID=#{taskId}
        WHERE t1.TASK_ID = #{taskId}
            <if test="pMemCd != null and pMemCd != ''">
              AND t2.EMPLY_CODE LIKE '%'|| #{pMemCd} ||'%' 
            </if>
    </select>
    <select id="selectCMM0016T" parameterType="Map" resultType="EgovMap">
        SELECT 
		  nvl(T1.TASK_ID, '0') TASK_ID,
		  nvl(T1.CMMS_DT, sysdate) CMMS_DT,
		  nvl(T1.C_MEM_ID, '0') C_MEM_ID,
		  nvl(T1.C_MEM_LEV, '0') C_MEM_LEV,
		  nvl(T1.P_MEM_ID,'0') P_MEM_ID,
		  nvl(T1.P_MEM_LEV, '0') P_MEM_LEV,
		  nvl(T1.TBB_LEV, '0') TBB_LEV,
		  nvl(T1.CNS_UNIT, '0') CNS_UNIT,
		  nvl(T1.CNSPV_TOT, '0') CNSPV_TOT,
		  nvl(T1.PNS_UNIT, '0') PNS_UNIT,
		  nvl(T1.TBB_TOT, '0') TBB_TOT,
		  nvl(T1.RUN_ID, '0') RUN_ID,
		  nvl(T2.EMPLY_CODE,'0') EMPLY_CODE
		FROM CMM0016T t1 JOIN CMM0006T t2 
               ON t1.P_MEM_ID=t2.EMPLY_ID 
                   AND t2.IS_EXCLUDE=0 
                   AND t2.COMM_TASK_ID=#{taskId}
		WHERE t1.TASK_ID = #{taskId}
	        <if test="pMemCd != null and pMemCd != ''">
              AND t2.EMPLY_CODE LIKE '%'|| #{pMemCd} ||'%' 
            </if>
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0017T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0017T T1 JOIN (
                SELECT RUN_ID, IS_EXCLUDE, MEM_CODE
                FROM CMM0017T  
                WHERE TASK_ID= #{taskId}
                <if test="ordId != null and ordId != ''">
                    AND ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="memCd != null and memCd != ''">
                    AND MEM_CODE LIKE '%'|| #{memCd} ||'%'  
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0017T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.TRGET_AMT, '0') TRGET_AMT,
            nvl(T1.COLCT_AMT, '0') COLCT_AMT,
            nvl(T2.MEM_CODE, '0') MEM_CODE,
            nvl(T1.HM_CODE, '0') HM_CODE,
		    nvl(T1.SM_CODE, '0') SM_CODE,
		    nvl(T1.GM_CODE, '0') GM_CODE,
		    nvl(T1.RCM_YEAR, '0') RCM_YEAR,
		    nvl(T1.RCM_MONTH, '0') RCM_MONTH,
		    nvl(T1.RUN_ID,'0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0017T T1 JOIN (
		        SELECT RUN_ID, IS_EXCLUDE, MEM_CODE
		        FROM CMM0017T  
		        WHERE TASK_ID= #{taskId}
		        <if test="ordId != null and ordId != ''">
		            AND ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="memCd != null and memCd != ''">
                    AND MEM_CODE LIKE '%'|| #{memCd} ||'%'  
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0018T" parameterType="Map" resultType="integer">
        SELECT 
          count(*) cnt
        FROM CMM0018T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0018T s1 JOIN CMM0006T s2 
                  ON s1.INST_PERSON_ID=s2.EMPLY_ID  
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId}
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="instPersonCd != null and instPersonCd != ''">
                    and s2.EMPLY_CODE LIKE '%'|| #{instPersonCd} ||'%'  
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID= #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0018T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.TASK_ID ,'0') TASK_ID,
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.INST_ID ,'0') INST_ID,
            nvl(T1.STOCK_ID ,'0') STOCK_ID,
            nvl(T1.APP_TYPE_ID ,'0') APP_TYPE_ID,
		    nvl(T1.INST_PERSON_ID ,'0') INST_PERSON_ID,
		    nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
		    nvl(T1.PRC, '0') PRC,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0018T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0018T s1 JOIN CMM0006T s2 
                  ON s1.INST_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID=#{taskId}
		        <if test="ordId != null and ordId != ''">
		            AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="instPersonCd != null and instPersonCd != ''">
		            and s2.EMPLY_CODE LIKE '%'|| #{instPersonCd} ||'%'  
		        </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID= #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
          AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
         order by T1.RUN_ID
    </select>
    
    <select id="cntCMM0019T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0019T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0019T s1 JOIN CMM0006T s2 
                  ON s1.BS_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                 <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="bsPersonCd != null and bsPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{bsPersonCd} ||'%'  
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
    </select>
    <select id="selectCMM0019T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.BSR_ID, '0') BSR_ID,
            nvl(T1.STOCK_ID, '0') STOCK_ID,
            nvl(T1.APP_TYPE_ID, '0') APP_TYPE_ID,
            nvl(T1.BS_PERSON_ID, '0') BS_PERSON_ID,
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
		    nvl(T1.PRC, '0') PRC,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0019T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0019T s1 JOIN CMM0006T s2 
                  ON s1.BS_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		         <if test="ordId != null and ordId != ''">
		            AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="bsPersonCd != null and bsPersonCd != ''">
		            AND s2.EMPLY_CODE LIKE '%'|| #{bsPersonCd} ||'%'  
		        </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if>
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0020T" parameterType="Map" resultType="integer">
       SELECT 
            count(*) cnt
        FROM CMM0020T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0020T s1 JOIN CMM0006T s2 
                  ON s1.AS_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID= #{taskId}
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="asEntryCd != null and asEntryCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{asEntryCd} ||'%'  
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
    </select>
    <select id="selectCMM0020T" parameterType="Map" resultType="EgovMap">
       SELECT 
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.AS_ENTRY_ID, '0') AS_ENTRY_ID,
            nvl(T1.ASR_ID, '0') ASR_ID,
            nvl(T1.STOCK_ID, '0') STOCK_ID,
            nvl(T1.APP_TYPE_ID, '0') APP_TYPE_ID,
		    nvl(T1.AS_PERSON_ID,'0') AS_PERSON_ID,
		    nvl(T2.EMPLY_CODE,'0') EMPLY_CODE, 
		    nvl(T1.PRC, '0') PRC,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0020T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0020T s1 JOIN CMM0006T s2 
                  ON s1.AS_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID= #{taskId}
		        <if test="ordId != null and ordId != ''">
		            AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="asEntryCd != null and asEntryCd != ''">
		            AND s2.EMPLY_CODE LIKE '%'|| #{asEntryCd} ||'%'  
		        </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0021T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0021T T1 JOIN (
                SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0021T s1 JOIN CMM0006T s2 
                  ON s1.RET_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId}
                <if test="ordId != null and ordId != ''">
                  AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
                </if>
                <if test="retPCd != null and retPCd != ''">
                  AND s2.EMPLY_CODE LIKE '%'|| #{retPCd} ||'%'  
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
    </select>
    <select id="selectCMM0021T" parameterType="Map" resultType="EgovMap">
        SELECT 
			nvl(T1.ORD_ID, '0') ORD_ID,
			nvl(T1.RET_ID, '0') RET_ID,
			nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
			nvl(T1.STOCK_ID, '0') STOCK_ID,
			nvl(T1.APP_TYPE_ID, '0') APP_TYPE_ID,
			nvl(T1.RET_PERSON_ID,'0') RET_PERSON_ID,
		    nvl(T1.PRC,0) prc, 
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0021T T1 JOIN (
		        SELECT s1.RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0021T s1 JOIN CMM0006T s2 
                  ON s1.RET_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID=#{taskId}
	            <if test="ordId != null and ordId != ''">
		          AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%'  
		        </if>
		        <if test="retPCd != null and retPCd != ''">
		          AND s2.EMPLY_CODE LIKE '%'|| #{retPCd} ||'%'  
		        </if>
		        <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON t1.RUN_ID=t2.RUN_ID 
		WHERE T1.TASK_ID = #{taskId}
		<if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0022T" parameterType="Map" resultType="integer">
        SELECT 
            count(*) cnt
        FROM CMM0022T T1 JOIN (
                SELECT s1.BILL_RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
                FROM CMM0022T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
                WHERE s1.TASK_ID=#{taskId}
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
                </if>
                <if test="salesPersonCd != null and salesPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )T2 ON T1.BILL_RUN_ID = T2.BILL_RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
    </select>
    <select id="selectCMM0022T" parameterType="Map" resultType="EgovMap">
        SELECT 
            nvl(T1.ORD_ID,'0') ORD_ID,
            nvl(T1.SRV_CNTRCT_ID,'0') SRV_CNTRCT_ID,
            nvl(T1.SRV_CNTRCT_NO, '0') SRV_CNTRCT_NO,
            nvl(T1.SALES_PERSON_ID,'0') SALES_PERSON_ID, 
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE, 
            nvl(T1.INSTLMT, '0') INSTLMT,
		    nvl(T1.PV, '0') PV,
		    nvl(T1.PRC, '0') PRC,
		    nvl(T1.ORD_TYPE_ID, '0') ORD_TYPE_ID,
		    nvl(T1.BILL_RUN_ID,'0')  runId,  
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0022T T1 JOIN (
		        SELECT s1.BILL_RUN_ID, s1.IS_EXCLUDE, s2.EMPLY_CODE
		        FROM CMM0022T s1 JOIN CMM0006T s2 
                  ON s1.SALES_PERSON_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		        WHERE s1.TASK_ID=#{taskId}
	            <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
                </if>
                <if test="salesPersonCd != null and salesPersonCd != ''">
                    AND s2.EMPLY_CODE LIKE '%'|| #{salesPersonCd} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON T1.BILL_RUN_ID=T2.BILL_RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
        ORDER BY T1.BILL_RUN_ID
    </select>
    
    <select id="cntCMM0023T" parameterType="Map" resultType="integer">
       SELECT 
            count(*) cnt
        FROM CMM0023T T1 JOIN (
              SELECT s1.RUN_ID, s1.IS_EXCLUDE
              FROM CMM0023T s1 JOIN CMM0006T s2 
                  ON s1.MEM_CODE=s2.EMPLY_CODE 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
              WHERE s1.TASK_ID=#{taskId}
                <if test="ordId != null and ordId != ''">
                    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
                </if>
                <if test="memCode != null and memCode != ''">
                    AND s1.MEM_CODE LIKE '%'|| #{memCode} ||'%' 
                </if>
                <if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
            )t2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
    </select>
    <select id="selectCMM0023T" parameterType="Map" resultType="EgovMap">
       SELECT 
            nvl(T1.ORD_ID ,'0') ORD_ID,
            nvl(T1.TRGET_AMT, '0') TRGET_AMT,
            nvl(T1.COLCT_AMT, '0') COLCT_AMT,
            nvl(T1.MEM_CODE, '0') MEM_CODE,
            nvl(T1.HM_CODE, '0') HM_CODE,
		    nvl(T1.SM_CODE,'0') SM_CODE, 
		    nvl(T1.GM_CODE , '0') GM_CODE,
		    nvl(T1.RCM_YEAR ,'0') RCM_YEAR,
		    nvl(T1.RCM_MONTH, '0') RCM_MONTH,
		    nvl(T1.SRV_CNTRCT_ID, '0') SRV_CNTRCT_ID,
		    nvl(T1.RUN_ID, '0') RUN_ID,
		    nvl(T1.TASK_ID, '0') TASK_ID,
		    nvl(t2.IS_EXCLUDE,'0') IS_EXCLUDE
        FROM CMM0023T T1 JOIN (
		      SELECT s1.RUN_ID, s1.IS_EXCLUDE
		      FROM CMM0023T s1 JOIN CMM0006T s2 
                  ON s1.MEM_CODE=s2.EMPLY_CODE 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
		      WHERE s1.TASK_ID=#{taskId}
				<if test="ordId != null and ordId != ''">
				    AND s1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
				</if>
				<if test="memCode != null and memCode != ''">
				    AND s1.MEM_CODE LIKE '%'|| #{memCode} ||'%' 
				</if>
				<if test="codeId != null and codeId != ''">
                  AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )t2 ON t1.RUN_ID=t2.RUN_ID 
        WHERE T1.TASK_ID = #{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0024T" parameterType="Map" resultType="integer">
        SELECT 
           count(*) cnt
        FROM CMM0024T t1 JOIN CMM0006T t2 
                  ON t1.MEM_CODE=t2.EMPLY_CODE 
                      AND t2.IS_EXCLUDE=0 
                      AND t2.COMM_TASK_ID=#{taskId}
        WHERE t1.TASK_ID=#{taskId}
        <if test="emplyCd != null and emplyCd != ''">
          AND t1.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
        </if>
        <if test="codeId != null and codeId != ''">
          AND t2.EMPLY_TYPE_ID = #{codeId}
        </if>
    </select>
    <select id="selectCMM0024T" parameterType="Map" resultType="EgovMap">
        SELECT 
			nvl(t1.EMPLY_ID,'0') EMPLY_ID,
			nvl(t1.EMPLY_CODE, '0') EMPLY_CODE,
			nvl(t1.PRFOM_PRCNT, '0') PRFOM_PRCNT,
			nvl(t1.PRFOMNC_RANK, '0') PRFOMNC_RANK,
			nvl(t1.TOT_EMPLY, '0') TOT_EMPLY,
			nvl(t1.CUMLT_DSTRIB, '0') CUMLT_DSTRIB,
			nvl(t1.PAYOUT_PRCNT, '0') PAYOUT_PRCNT,
			nvl(t1.PAYOUT_AMT,'0') PAYOUT_AMT,
			nvl(t1.TASK_ID,'0') TASK_ID
		FROM CMM0024T t1 JOIN CMM0006T t2 
                  ON t1.MEM_CODE=t2.EMPLY_CODE 
                      AND t2.IS_EXCLUDE=0 
                      AND t2.COMM_TASK_ID=#{taskId}
		WHERE t1.TASK_ID=#{taskId}
		<if test="emplyCd != null and emplyCd != ''">
		  AND t1.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%' 
		</if>
		<if test="codeId != null and codeId != ''">
          AND t2.EMPLY_TYPE_ID = #{codeId}
        </if>
        ORDER BY t1.EMPLY_CODE
    </select>
    
    <select id="cntCMM0025T" parameterType="Map" resultType="integer">
       SELECT 
            count(*) cnt
        FROM CMM0025T t1 JOIN CMM0006T t2 
              ON t1.EMPLY_ID=t2.EMPLY_ID 
                  AND t2.IS_EXCLUDE=0 
                  AND t2.COMM_TASK_ID=#{taskId}
        WHERE t1.TASK_ID = #{taskId}
        <if test="ordId != null and ordId != ''">
            AND t1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
        </if>
        <if test="emplyCd != null and emplyCd != ''">
            AND t2.EMPLY_CODE = #{emplyCd} 
        </if>
        <if test="codeId != null and codeId != ''">
          AND t2.EMPLY_TYPE_ID = #{codeId}
        </if>
    </select>
    <select id="selectCMM0025T" parameterType="Map" resultType="EgovMap">
       SELECT 
            nvl(T1.EMPLY_ID, '0') EMPLY_ID,
            nvl(T2.EMPLY_CODE,'0') EMPLY_CODE,
            nvl(T1.ORD_ID, '0') ORD_ID,
            nvl(T1.STOCK_ID, '0') STOCK_ID,
            nvl(T1.PROMT_ID, '0') PROMT_ID,
            nvl(T1.PAID_MONTH, '0') PAID_MONTH,
            nvl(T1.PAID_AMT,'0') PAID_AMT,
            nvl(T1.RUN_ID,'0') RUN_ID,
            nvl(T1.TASK_ID,'0') TASK_ID
        FROM CMM0025T t1 JOIN CMM0006T t2 
              ON t1.EMPLY_ID=t2.EMPLY_ID 
                  AND t2.IS_EXCLUDE=0 
                  AND t2.COMM_TASK_ID=#{taskId}
        WHERE t1.TASK_ID = #{taskId}
        <if test="ordId != null and ordId != ''">
            AND t1.ORD_ID LIKE '%'|| #{ordId} ||'%' 
        </if>
        <if test="emplyCd != null and emplyCd != ''">
            AND t2.EMPLY_CODE = #{emplyCd} 
        </if>
        <if test="codeId != null and codeId != ''">
          AND t2.EMPLY_TYPE_ID = #{codeId}
        </if>
        ORDER BY T1.RUN_ID
    </select>
    
    <select id="cntCMM0026T" parameterType="Map" resultType="integer">
       SELECT 
        count(*) cnt
        FROM CMM0056M T1 JOIN (
           SELECT s1.EMPLY_ID, s1.IS_EXCLUDE
           FROM CMM0056M  s1 JOIN CMM0006T s2 
                  ON s1.EMPLY_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
            WHERE s1.TASK_ID= #{taskId}
            <if test="emplyCd != null and emplyCd != ''">
                AND s1.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%'
            </if>
            <if test="codeId != null and codeId != ''">
               AND s2.EMPLY_TYPE_ID = #{codeId}
             </if>
            )T2 ON T1.EMPLY_ID=T2.EMPLY_ID 
        WHERE T1.TASK_ID=#{taskId}
        <if test="useYnCombo != null and useYnCombo != ''">
           AND T2.IS_EXCLUDE = #{useYnCombo}
       </if> 
    </select>
    <select id="selectCMM0026T" parameterType="Map" resultType="EgovMap">
       SELECT
		    NVL(T1.EMPLY_ID, '0') EMPLY_ID,
		    NVL(T1.EMPLY_CODE, '0') EMPLY_CODE,
		    NVL(T1.WEEK_1, '0') WEEK_1,
		    NVL(T1.WEEK_2,'0') WEEK_2,
		    NVL(T1.WEEK_3, '0') WEEK_3,
		    NVL(T1.WEEK_4, '0') WEEK_4,
		    NVL(T1.WEEK_5, '0') WEEK_5,
		    NVL(T1.TOT_LV, '0') TOT_LV,
		    NVL(T1.WEEKLY_LV, '0') WEEKLY_LV,
		    NVL(T1.MONTH_LV, '0') MONTH_LV,
		    NVL(T1.WEEKLY_LV_R,'0') weekLylvR, 
		    NVL(T1.MONTH_LV_R, '0') MONTH_LV_R,
		    NVL(T1.RUN_ID, '0') RUN_ID,
		    NVL(T1.TASK_ID, '0') TASK_ID,
		    NVL(T2.IS_EXCLUDE,'0') IS_EXCLUDE
		FROM CMM0056M T1 JOIN (
	        SELECT s1.EMPLY_ID, s1.IS_EXCLUDE
	        FROM CMM0056M  s1 JOIN CMM0006T s2 
                  ON s1.EMPLY_ID=s2.EMPLY_ID 
                      AND s2.IS_EXCLUDE=0 
                      AND s2.COMM_TASK_ID=#{taskId}
	        WHERE s1.TASK_ID= #{taskId}
		        <if test="emplyCd != null and emplyCd != ''">
	                AND s1.EMPLY_CODE LIKE '%'|| #{emplyCd} ||'%'
	            </if>
	            <if test="codeId != null and codeId != ''">
	               AND s2.EMPLY_TYPE_ID = #{codeId}
                </if>
		    )T2 ON T1.EMPLY_ID=T2.EMPLY_ID 
		WHERE T1.TASK_ID=#{taskId}
		<if test="useYnCombo != null and useYnCombo != ''">
            AND T2.IS_EXCLUDE = #{useYnCombo}
        </if> 
        ORDER BY T1.RUN_ID
    </select>
    
    <!-- ########################################################## -->
    <!-- 												Is Exclude Update													-->
    <!-- ########################################################## -->
     
    <update id="udtDataCMM0006T" parameterType="Map">
        UPDATE CMM0006T SET IS_EXCLUDE = #{isExclude}
        WHERE COMM_TASK_ID= #{taskid}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0007T" parameterType="Map">
        UPDATE CMM0007T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0008T" parameterType="Map">
        UPDATE CMM0008T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0009T" parameterType="Map">
        UPDATE CMM0009T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0010T" parameterType="Map">
        UPDATE CMM0010T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0011T" parameterType="Map">
        UPDATE CMM0011T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RCORD_ID=#{rcordId}
    </update>
    
    <update id="udtDataCMM0012T" parameterType="Map">
        UPDATE CMM0012T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0013T" parameterType="Map">
        UPDATE CMM0013T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0014T" parameterType="Map">
        UPDATE CMM0014T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0015T" parameterType="Map">
        UPDATE CMM0015T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0017T" parameterType="Map">
        UPDATE CMM0017T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0018T" parameterType="Map">
        UPDATE CMM0018T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0019T" parameterType="Map">
        UPDATE CMM0019T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0020T" parameterType="Map">
        UPDATE CMM0020T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0021T" parameterType="Map">
        UPDATE CMM0021T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0022T" parameterType="Map">
        UPDATE CMM0022T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND BILL_RUN_ID=#{runid}
    </update>
    
    <update id="udtDataCMM0023T" parameterType="Map">
        UPDATE CMM0023T SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
    
    <update id="udtDataCMM0026T" parameterType="Map">
        UPDATE CMM0056M SET IS_EXCLUDE = #{isExclude}
        WHERE TASK_ID= #{taskId}
        AND RUN_ID=#{runId}
    </update>
  
    <select id="adjustmentCodeList" parameterType="Map" resultType="EgovMap">
    <![CDATA[
	    SELECT 
	        CODE_ID, CODE, CODE_NAME, CODE_DESC 
	    FROM SYS0013M 
	    WHERE CODE_MASTER_ID=#{mstId}
	    AND CODE_ID <> '1157'
	  ]]>  
    </select>
    
    <select id="memberInfoSearch" parameterType="Map" resultType="Map">
        SELECT
            MEM_ID memId,
            MEM_CODE memCode
        FROM ORG0001D 
        WHERE MEM_CODE=#{memCode} AND ROWNUM=1
    </select>
    
    <select id="ordNoInfoSearch" parameterType="Map" resultType="Map">
	    SELECT 
			SALES_ORD_ID ordId, 
			SALES_ORD_NO ordNo
		FROM SAL0001D 
		WHERE SALES_ORD_NO=#{ordNo}
		AND ROWNUM=1
   </select>
   
   <insert id="adjustmentInsert" parameterType="Map">
	   INSERT INTO CMM0026T(ID,TASK_ID,ORD_ID,AYEAR,AMONTH,EMPLY_ID,A_TYPE_ID,PRC,TYPE_DESC,UPD_USER_ID,UPD_DT) 
	       VALUES(CMM0026T_ID_SEQ.nextval, #{taskId}, #{ordId}, #{aYear}, #{aMonth},#{memId}, #{adjustmentType}, #{adjustmentAmt}, #{adjustmentDesc}, #{loginId}, sysdate)
   </insert>
   
   <delete id="neoProDel" parameterType="Map">
        DELETE FROM ORG0011D
        WHERE PV_MONTH =#{pvMonth} and PV_YEAR = #{pvYear}
    </delete>
   
   <insert id="neoProInsert" parameterType="Map">
       INSERT INTO ORG0011D(HP_CODE, HP_TYPE, PV_MONTH, PV_YEAR, USER_ADD, DT_ADD, JOIN_DT, IS_NW, HP_RANK_ID) 
           VALUES(#{hpCode},#{hpType},#{pvMonth},#{pvYear},#{loginId},sysdate,to_date(#{joinDt},'yyyy-mm-dd'),#{isNw},ORG0011D_HP_RANK_ID_SEQ.nextval)
   </insert>
   
   <delete id="ctUploadDel" parameterType="Map">
        DELETE FROM CMM0002D
        WHERE F_MONTH =#{fMonth} and F_YEAR = #{fYear}
   </delete>
   
   <insert id="ctUploadInsert" parameterType="Map">
       INSERT INTO CMM0002D(ID, F_BATCH_ID, F_CT_CODE, F_CT_RANK, F_CT_PER_FAC, F_CFF_CMPLMT, F_CFF_CMPLNT, F3C, F_ATT_LAT, F_ATT_EL, F_ATT_MC, F_DT_ALLOW, F_ADJ, F_CFF_REWRD, F_YEAR, F_MONTH) 
           VALUES(CMM0002D_ID_SEQ.nextval, #{fBatchId}, #{fCtCode}, #{fCtRank}, #{fCtPerFac}, #{fCffCmplmt}, #{fCffCmplnt}, #{f3c}, #{fAttLat}, #{fAttEl}, #{fAttMc}, #{fDtAllow}, #{fAdj}, #{fCffRewrd}, #{fYear}, #{fMonth})
   </insert>
</mapper>