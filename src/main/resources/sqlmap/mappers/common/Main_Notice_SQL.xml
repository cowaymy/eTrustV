<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.common.impl.MainNoticeMapper">

	<select id="selectDailyCount" parameterType="Map" resultType="egovMap">
	<![CDATA[
			SELECT (SELECT COUNT(1) FROM SAL1058V ) NEO_SALES
			 , (SELECT COUNT(1)
				  FROM SAL0001D
				 WHERE TO_CHAR(CRT_DT,'YYYY')= TO_CHAR(SYSDATE,'YYYY')
				   AND TO_CHAR(CRT_DT,'MM') = TO_CHAR(SYSDATE,'MM')
				   AND 8 <> STUS_CODE_ID
				   AND APP_TYPE_ID IN (66,67,68)) SALES
			 , NVL(A.RENTAL, 0) RENTAL
			 , NVL(A.OUT_RIGHT, 0) OUT_RIGHT
			 , NVL(A.INSTALLMENT, 0) INSTALLMENT
			 , NVL(A.RENTAL, 0) + NVL(A.OUT_RIGHT, 0) + NVL(A.INSTALLMENT, 0) AS TOTAL
		  FROM
		  (
			SELECT SUM(CASE WHEN APP_TYPE_ID = 66 THEN 1
							ELSE 0 END) AS RENTAL
				 , SUM(CASE WHEN APP_TYPE_ID = 67 THEN 1
							ELSE 0 END) AS OUT_RIGHT
				 , SUM(CASE WHEN APP_TYPE_ID = 68 THEN 1
							ELSE 0 END) AS INSTALLMENT
			  FROM SAL0001D
			 WHERE PV_YEAR= TO_CHAR(SYSDATE,'YYYY')
			   AND PV_MONTH = TO_NUMBER(TO_CHAR(SYSDATE,'MM'))
		  ) A
	]]>
	</select>


	<select id="selectMainNotice" parameterType="Map" resultType="egovMap">
		<![CDATA[
		SELECT *
		FROM (
				SELECT   NTCE_NO
						,NTCE_SUBJECT
						,RGST_USER_NM
						,READ_CNT
						,CRT_DT
						,EMGNCY_FLAG
						,SYSDATE
						,CASE
							WHEN SYSDATE - CRT_DT >= 1
							   THEN 'N'
							ELSE 'Y'
						 END IMG_FLAG
					FROM SYS0069M
				   WHERE STUS_FLAG = 'N'
					 AND (    SYSDATE >= NVL (NTCE_START_DT, TO_DATE ('19900101', 'YYYYMMDD') )
						  AND SYSDATE < NVL (NTCE_END_DT, TO_DATE ('29900101', 'YYYYMMDD') ) + 1
						 )
				ORDER BY NVL (EMGNCY_FLAG, 'N') DESC, NTCE_NO DESC
		) TBL
		WHERE ROWNUM < 5
		]]>
	</select>

	<select id="selectTagStatus" parameterType="Map" resultType="egovMap">
	SELECT Z.customer,
               Z.main_inquiry,
               Z.sub_inquiry,
               Z.sales_order,
               Z.main_department,
               Z.sub_department,
               Z.claim_note,
               Z.status
	  FROM ( SELECT A.CUST_NO as customer,
							D.CD_NM as main_inquiry,
							E.CD_NM as sub_inquiry,
							A.ORD_NO as sales_order,
							B.CODE_NAME as main_department,
							C.CODE_NAME as sub_department,
							F.MEMO as claim_note,
							'Active' as status
					FROM CALLCENTERUSER.T_CUR_HIST A,
					        SYS0013M B,
						    SYS0013M C,
						    CALLCENTERUSER.T_CNSL_CD  D,
						    CALLCENTERUSER.T_CNSL_CD  E,
						    CALLCENTERUSER.T_RMK_HIST F
				  WHERE B.CODE            = A.DEPT_CODE
					  AND C.CODE            = A.SUB_DEPT_CDE
					  AND A.CNSL_LRGCLAS_CD = D.CNSL_CD
					  AND A.CUR_SEQNO       = F.CUR_SEQNO
					  AND A.TR_DVCD         = 'T'
				   ORDER BY A.REG_DTM DESC
			   ) Z
     WHERE 1=1
         <if test="initYn != null and initYn !=''">
         <![CDATA[
         AND ROWNUM < 5
	     ]]>
	     </if>
    </select>

    <select id="selectDailyPerformance" parameterType="Map" resultType="egovMap">
        SELECT A.DIV_CODE
				 , A.DIV_NAME
				 , A.PERIOD
                 , A.KEY_IN_QTY_TODAY
				 , A.KEY_IN_QTY_ACCUM
				 , A.KEY_IN_QTY_MONTH_END
				 , A.BY_PRD_CTGRY_WPURIFIER
				 , A.BY_PRD_CTGRY_APURIFIER
				 , A.BY_PRD_CTGRY_BIDET
				 , A.BY_PRD_CTGRY_SOFTNER
				 , A.BY_SALES_CTGRY_RENTAL
				 , A.BY_SALES_CTGRY_OUT_INS
				 , A.BY_SALES_CTGRY_MBR_SHIP
				 , A.BY_SALES_CTGRY_EXTRADE
				 , A.NET_SALES_ACCUM
				 , A.NET_SALES_MONTH_END
          FROM SYS0083S A
    </select>

</mapper>