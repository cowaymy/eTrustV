<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.services.as.impl.ASManagementListMapper">


    <select id="selectASManagementList" parameterType="Map" resultType="egovMap">
    <![CDATA[
            SELECT Project2.C1 C1  ,
		       Project2.AS_ID AS_ID  ,
		       Project2.AS_NO AS_NO  ,
		       Project2.AS_STUS_ID AS_STUS_ID  ,
		       Project2.CODE1 CODE  ,
		       Project2.AS_REQST_DT AS_REQST_DT  ,
		       Project2.C2 C2  ,
		       Project2.C3 C3  ,
		       Project2.AS_SO_ID AS_SO_ID  ,
		       Project2.SALES_ORD_NO SALES_ORD_NO  ,
		       Project2.CODE2 CODE1  ,
		       Project2.NAME NAME  ,
		       Project2.NRIC NRIC  ,
		       Project2.AS_TYPE_ID AS_TYPE_ID  ,
		       Project2.CODE CODE2  ,
		       Project2.C4 C4  ,
		       Project2.C5 C5  
		  FROM ( SELECT Project2.AS_ID AS_ID  ,
		                Project2.AS_NO AS_NO  ,
		                Project2.AS_SO_ID AS_SO_ID  ,
		                Project2.AS_REQST_DT AS_REQST_DT  ,
		                Project2.AS_STUS_ID AS_STUS_ID  ,
		                Project2.AS_TYPE_ID AS_TYPE_ID  ,
		                Project2.CODE CODE  ,
		                Project2.CODE1 CODE1  ,
		                Project2.SALES_ORD_NO SALES_ORD_NO  ,
		                Project2.CODE2 CODE2  ,
		                Project2.NAME NAME  ,
		                Project2.NRIC NRIC  ,
		                Project2.C1 C1  ,
		                Project2.C2 C2  ,
		                Project2.C3 C3  ,
		                Project2.C4 C4  ,
		                Project2.C5 C5  ,
		                ROW_NUMBER() OVER ( ORDER BY Project2.AS_ID ASC  ) ROW_NUMBER  
		         FROM ( SELECT Distinct1.AS_ID AS_ID  ,
		                       Distinct1.AS_NO AS_NO  ,
		                       Distinct1.AS_SO_ID AS_SO_ID  ,
		                       Distinct1.AS_REQST_DT AS_REQST_DT  ,
		                       Distinct1.AS_STUS_ID AS_STUS_ID  ,
		                       Distinct1.AS_TYPE_ID AS_TYPE_ID  ,
		                       Distinct1.CODE CODE  ,
		                       Distinct1.CODE1 CODE1  ,
		                       Distinct1.SALES_ORD_NO SALES_ORD_NO  ,
		                       Distinct1.CODE2 CODE2  ,
		                       Distinct1.NAME NAME  ,
		                       Distinct1.NRIC NRIC  ,
		                       Distinct1.C1 C1  ,
		                       Distinct1.C2 C2  ,
		                       Distinct1.C3 C3  ,
		                       Distinct1.C4 C4  ,
		                       Distinct1.C5 C5  
		                FROM ( SELECT DISTINCT Extent1.AS_ID AS_ID  ,
		                                       Extent1.AS_NO AS_NO  ,
		                                       Extent1.AS_SO_ID AS_SO_ID  ,
		                                        TO_CHAR(Extent1.AS_REQST_DT,'DD-MM-YYYY') AS_REQST_DT  ,
		                                       Extent1.AS_STUS_ID AS_STUS_ID  ,
		                                       Extent1.AS_TYPE_ID AS_TYPE_ID  ,
		                                       Extent2.CODE CODE  ,
		                                       Extent3.CODE CODE1  ,
		                                       Extent4.SALES_ORD_NO SALES_ORD_NO  ,
		                                       Extent5.CODE CODE2  ,
		                                       Extent6.NAME NAME  ,
		                                       Extent6.NRIC NRIC  ,
		                                       1 C1  ,
		                                       CASE 
		                                            WHEN ( Extent7.AS_RESULT_ID IS NOT NULL ) THEN Extent7.AS_RESULT_ID
		                                       ELSE 0
		                                          END C2  ,
		                                       CASE 
		                                            WHEN ( Extent7.AS_RESULT_ID IS NOT NULL ) THEN Extent7.AS_RESULT_NO
		                                       ELSE ' - '
		                                          END C3  ,
		                                       CASE 
		                                            WHEN ( Extent8.USER_ID IS NOT NULL ) THEN Extent8.USER_NAME
		                                       ELSE ' -' 
		                                          END C4  ,
		                                       CASE 
		                                            WHEN ( Extent7.AS_RESULT_ID IS NOT NULL ) THEN Extent7.AS_TOT_AMT
		                                       ELSE 0
		                                          END C5  
		                       FROM SVC0001D Extent1
		                              JOIN SYS0013M Extent2   ON Extent1.AS_TYPE_ID = Extent2.CODE_ID
		                              JOIN SYS0038M Extent3   ON Extent1.AS_STUS_ID = Extent3.STUS_CODE_ID
		                              JOIN SAL0001D Extent4   ON Extent1.AS_SO_ID = Extent4.SALES_ORD_ID
		                              JOIN SYS0013M Extent5   ON Extent4.APP_TYPE_ID = Extent5.CODE_ID
		                              JOIN SAL0029D Extent6   ON Extent4.CUST_ID = Extent6.CUST_ID
		                              LEFT JOIN SVC0004D Extent7   ON ( Extent1.AS_ID = Extent7.AS_ENTRY_ID )
		                              AND ( 457 = Extent7.AS_RESULT_TYPE_ID )
		                              AND ( 1 = Extent7.AS_RESULT_IS_CURR )
		                              LEFT JOIN SYS0047M Extent8   ON Extent1.AS_CRT_USER_ID = Extent8.USER_ID
		                        WHERE  ( 8 <> Extent1.AS_STUS_ID )
		                                 AND ( Extent1.AS_TYPE_ID IN ( 675,674 )
		                                )
		                                 AND ( 1 = Extent1.AS_STUS_ID )
		                                 AND ( Extent1.AS_REQST_DT >= TO_DATE('2017-05-18','YYYY-MM-DD') ) ) Distinct1 ) Project2 ) Project2
		            ORDER BY Project2.AS_ID ASC
              ]]>
    </select>
    <select id="selectOrderBasicInfo" parameterType="Map" resultType="egovMap">
    <![CDATA[
            SELECT Extent1.ORD_ID ORD_ID  ,
		       Extent1.ORD_NO ORD_NO  ,
		       Extent1.RENTAL_STUS RENTAL_STUS  ,
		       Extent1.ORD_STUS_ID ORD_STUS_ID  ,
		       Extent1.ORD_STUS_CODE ORD_STUS_CODE  ,
		       Extent1.ORD_STUS_NAME ORD_STUS_NAME  ,
		       Extent1.ORD_DT ORD_DT  ,
		       Extent1.INSTLMT_PRIOD INSTLMT_PRIOD  ,
		       Extent1.ORD_AMT ORD_AMT  ,
		       Extent1.ORD_MTH_RENTAL ORD_MTH_RENTAL  ,
		       Extent1.ORD_PV ORD_PV  ,
		       Extent1.ORD_PV_MONTH ORD_PV_MONTH  ,
		       Extent1.ORD_PV_YEAR ORD_PV_YEAR  ,
		       Extent1.ORD_REF_NO ORD_REF_NO  ,
		       Extent1.ORD_PO_NO ORD_PO_NO  ,
		       Extent1.ORD_DEPT_CODE ORD_DEPT_CODE  ,
		       Extent1.ORD_GRP_CODE ORD_GRP_CODE  ,
		       Extent1.ORD_ORG_CODE ORD_ORG_CODE  ,
		       Extent1.ORD_CRT_USER_ID ORD_CRT_USER_ID  ,
		       Extent1.ORD_CRT_DT ORD_CRT_DT  ,
		       Extent1.APP_TYPE_ID APP_TYPE_ID  ,
		       Extent1.APP_TYPE_CODE APP_TYPE_CODE  ,
		       Extent1.APP_TYPE_DESC APP_TYPE_DESC  ,
		       Extent1.STOCK_ID STOCK_ID  ,
		       Extent1.STOCK_CODE STOCK_CODE  ,
		       Extent1.STOCK_DESC STOCK_DESC  ,
		       Extent1.CUST_ID CUST_ID  ,
		       Extent1.CUST_TYPE CUST_TYPE  ,
		       Extent1.CUST_NAME CUST_NAME  ,
		       Extent1.CUST_NRIC CUST_NRIC  ,
		       Extent1.CUST_DOB CUST_DOB  ,
		       Extent1.CUST_NATION CUST_NATION  ,
		       Extent1.CUST_GENDER CUST_GENDER  ,
		       Extent1.CUST_RACE CUST_RACE  ,
		       Extent1.CUST_EMAIL CUST_EMAIL  ,
		       Extent1.CUST_VA_NO CUST_VA_NO  ,
		       Extent1.CUST_PASSPORT_EXPR CUST_PASSPORT_EXPR  ,
		       Extent1.CUST_VISA_EXPR CUST_VISA_EXPR  ,
		       Extent1.ORD_PROMO_ID ORD_PROMO_ID  ,
		       Extent1.ORD_PROMO_CODE ORD_PROMO_CODE  ,
		       Extent1.ORD_PROMO_DESC ORD_PROMO_DESC  ,
		       Extent1.ORD_MEM_ID ORD_MEM_ID  ,
		       Extent1.ORD_MEM_CODE ORD_MEM_CODE  ,
		       Extent1.ORD_MEM_NAME ORD_MEM_NAME  ,
		       Extent1.ORD_MEM_NRIC ORD_MEM_NRIC  ,
		       Extent1.ORD_MEM_TYPE_ID ORD_MEM_TYPE_ID  ,
		       Extent1.ORD_MEM_TYPE_CODE ORD_MEM_TYPE_CODE  ,
		       Extent1.ORD_MEM_TYPE_NAME ORD_MEM_TYPE_NAME  ,
		       Extent1.COOL_OFF_PRIOD COOL_OFF_PRIOD  ,
		       Extent1.KEYIN_BRNCH_ID KEYIN_BRNCH_ID  ,
		       Extent1.KEYIN_BRNCH_CODE KEYIN_BRNCH_CODE  ,
		       Extent1.KEYIN_BRNCH_NAME KEYIN_BRNCH_NAME  ,
		       Extent1.ORD_REM ORD_REM  ,
		       Extent1.RENT_CHK_ID RENT_CHK_ID  ,
		       Extent1.ORD_HM_ID ORD_HM_ID  ,
		       Extent1.ORD_SM_ID ORD_SM_ID  ,
		       Extent1.ORD_GM_ID ORD_GM_ID  ,
		       Extent1.ORD_ADDR_ID ORD_ADDR_ID  ,
		       Extent1.ORD_CNTC_ID ORD_CNTC_ID  ,
		       Extent1.ORD_PROMO_RELATED_NO ORD_PROMO_RELATED_NO  ,
		       Extent1.UPD_DT UPD_DT  ,
		       Extent1.UPD_USER_ID UPD_USER_ID  ,
		       Extent1.JOM_PAY_REF JOM_PAY_REF  ,
		       Extent1.STK_CTGRY_ID STK_CTGRY_ID  ,
		       Extent1.STK_CTGRY_NAME STK_CTGRY_NAME  ,
		       Extent1.CUST_TYPE_ID CUST_TYPE_ID  ,
		       Extent1.CUST_BILL_ID CUST_BILL_ID  ,
		       Extent1.OBLIGT_YEAR OBLIGT_YEAR  
		  FROM ( SELECT vOrderBasicInfo.ORD_ID ORD_ID  ,
		                vOrderBasicInfo.ORD_NO ORD_NO  ,
		                vOrderBasicInfo.RENTAL_STUS RENTAL_STUS  ,
		                vOrderBasicInfo.ORD_STUS_ID ORD_STUS_ID  ,
		                vOrderBasicInfo.ORD_STUS_CODE ORD_STUS_CODE  ,
		                vOrderBasicInfo.ORD_STUS_NAME ORD_STUS_NAME  ,
		                vOrderBasicInfo.ORD_DT ORD_DT  ,
		                vOrderBasicInfo.INSTLMT_PRIOD INSTLMT_PRIOD  ,
		                vOrderBasicInfo.ORD_AMT ORD_AMT  ,
		                vOrderBasicInfo.ORD_MTH_RENTAL ORD_MTH_RENTAL  ,
		                vOrderBasicInfo.ORD_PV ORD_PV  ,
		                vOrderBasicInfo.ORD_PV_MONTH ORD_PV_MONTH  ,
		                vOrderBasicInfo.ORD_PV_YEAR ORD_PV_YEAR  ,
		                vOrderBasicInfo.ORD_REF_NO ORD_REF_NO  ,
		                vOrderBasicInfo.ORD_PO_NO ORD_PO_NO  ,
		                vOrderBasicInfo.ORD_DEPT_CODE ORD_DEPT_CODE  ,
		                vOrderBasicInfo.ORD_GRP_CODE ORD_GRP_CODE  ,
		                vOrderBasicInfo.ORD_ORG_CODE ORD_ORG_CODE  ,
		                vOrderBasicInfo.ORD_CRT_USER_ID ORD_CRT_USER_ID  ,
		                vOrderBasicInfo.ORD_CRT_DT ORD_CRT_DT  ,
		                vOrderBasicInfo.APP_TYPE_ID APP_TYPE_ID  ,
		                vOrderBasicInfo.APP_TYPE_CODE APP_TYPE_CODE  ,
		                vOrderBasicInfo.APP_TYPE_DESC APP_TYPE_DESC  ,
		                vOrderBasicInfo.STOCK_ID STOCK_ID  ,
		                vOrderBasicInfo.STOCK_CODE STOCK_CODE  ,
		                vOrderBasicInfo.STOCK_DESC STOCK_DESC  ,
		                vOrderBasicInfo.CUST_ID CUST_ID  ,
		                vOrderBasicInfo.CUST_TYPE CUST_TYPE  ,
		                vOrderBasicInfo.CUST_NAME CUST_NAME  ,
		                vOrderBasicInfo.CUST_NRIC CUST_NRIC  ,
		                vOrderBasicInfo.CUST_DOB CUST_DOB  ,
		                vOrderBasicInfo.CUST_NATION CUST_NATION  ,
		                vOrderBasicInfo.CUST_GENDER CUST_GENDER  ,
		                vOrderBasicInfo.CUST_RACE CUST_RACE  ,
		                vOrderBasicInfo.CUST_EMAIL CUST_EMAIL  ,
		                vOrderBasicInfo.CUST_VA_NO CUST_VA_NO  ,
		                vOrderBasicInfo.CUST_PASSPORT_EXPR CUST_PASSPORT_EXPR  ,
		                vOrderBasicInfo.CUST_VISA_EXPR CUST_VISA_EXPR  ,
		                vOrderBasicInfo.ORD_PROMO_ID ORD_PROMO_ID  ,
		                vOrderBasicInfo.ORD_PROMO_CODE ORD_PROMO_CODE  ,
		                vOrderBasicInfo.ORD_PROMO_DESC ORD_PROMO_DESC  ,
		                vOrderBasicInfo.ORD_MEM_ID ORD_MEM_ID  ,
		                vOrderBasicInfo.ORD_MEM_CODE ORD_MEM_CODE  ,
		                vOrderBasicInfo.ORD_MEM_NAME ORD_MEM_NAME  ,
		                vOrderBasicInfo.ORD_MEM_NRIC ORD_MEM_NRIC  ,
		                vOrderBasicInfo.ORD_MEM_TYPE_ID ORD_MEM_TYPE_ID  ,
		                vOrderBasicInfo.ORD_MEM_TYPE_CODE ORD_MEM_TYPE_CODE  ,
		                vOrderBasicInfo.ORD_MEM_TYPE_NAME ORD_MEM_TYPE_NAME  ,
		                vOrderBasicInfo.COOL_OFF_PRIOD COOL_OFF_PRIOD  ,
		                vOrderBasicInfo.KEYIN_BRNCH_ID KEYIN_BRNCH_ID  ,
		                vOrderBasicInfo.KEYIN_BRNCH_CODE KEYIN_BRNCH_CODE  ,
		                vOrderBasicInfo.KEYIN_BRNCH_NAME KEYIN_BRNCH_NAME  ,
		                vOrderBasicInfo.ORD_REM ORD_REM  ,
		                vOrderBasicInfo.RENT_CHK_ID RENT_CHK_ID  ,
		                vOrderBasicInfo.ORD_HM_ID ORD_HM_ID  ,
		                vOrderBasicInfo.ORD_SM_ID ORD_SM_ID  ,
		                vOrderBasicInfo.ORD_GM_ID ORD_GM_ID  ,
		                vOrderBasicInfo.ORD_ADDR_ID ORD_ADDR_ID  ,
		                vOrderBasicInfo.ORD_CNTC_ID ORD_CNTC_ID  ,
		                vOrderBasicInfo.ORD_PROMO_RELATED_NO ORD_PROMO_RELATED_NO  ,
		                vOrderBasicInfo.UPD_DT UPD_DT  ,
		                vOrderBasicInfo.UPD_USER_ID UPD_USER_ID  ,
		                vOrderBasicInfo.JOM_PAY_REF JOM_PAY_REF  ,
		                vOrderBasicInfo.STK_CTGRY_ID STK_CTGRY_ID  ,
		                vOrderBasicInfo.STK_CTGRY_NAME STK_CTGRY_NAME  ,
		                vOrderBasicInfo.CUST_TYPE_ID CUST_TYPE_ID  ,
		                vOrderBasicInfo.CUST_BILL_ID CUST_BILL_ID  ,
		                vOrderBasicInfo.OBLIGT_YEAR OBLIGT_YEAR  
		         FROM SAL1006V vOrderBasicInfo ) Extent1
		 WHERE  ( Extent1.ORD_NO = #{orderNo} )
		          AND ( Extent1.ORD_STUS_ID = 4 ) AND ROWNUM <= 1
             ]]>
    </select>
    
</mapper>