<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.services.as.impl.AsFromCodyApiServiceMapper">

  <insert id="insertAsFromCodyRequest" parameterType="Map"  >
    INSERT  /* [.com/coway/trust/biz/services/as/impl/AsFromCodyApiServiceMapper.java] */
    INTO SVC0130D( AS_CD_SEQ
                          , SALES_ORDER_NO
                          , STUS
                          , CUST_NAME
                          , PRODUCT_CODE
                          , PRODUCT_NAME
                          , APP_TYPE
                          , SALES_PROMOTION
                          , CONTRACT_DURATION
                          , OUTSTANDING
                          , SIRIM_NO
                          , SERIAL_NO
                          , MEMBERSHIP_CONTRACT_EXPIRY
                          , DSC_CODE
                          , PROD_CAT
                          , REG_ID
                          , DEFECT_CODE
                          , DEFECT_DESC
                          , CRT_USER_ID
                          , CRT_DT
                          , UPD_USER_ID
                          , UPD_DT

    ) VALUES ( SVC0130D_ID_SEQ.NEXTVAL
                  ,#{salesOrderNo}
                  ,#{stus}
                  ,#{custName}
                  ,#{productCode}
                  ,#{productName}
                  ,#{appType}
                  ,#{salesPromotion}
                  ,#{contractDuration}
                  ,#{outstanding}
                  ,#{sirimNo}
                  ,#{serialNo}
                  ,#{membershipContractExpiry}
                  ,#{dscCode}
                  ,#{prodCat}
                  ,#{regId}
                  ,#{defectCode}
                  ,#{defectDesc}
                  ,#{crtUserId}
                  ,SYSDATE
                  ,#{updUserId}
                  ,SYSDATE
    )
  </insert>



  <select id="selectSubmissionRecords" parameterType="Map" resultType="egovMap">
<![CDATA[

SELECT DISTINCT SALES_ORDER_NO FROM SVC0130D
WHERE EXTRACT(MONTH FROM CRT_DT) IN (SELECT EXTRACT(MONTH FROM SYSDATE) FROM dual)
AND EXTRACT(YEAR FROM CRT_DT) IN (SELECT EXTRACT(YEAR FROM SYSDATE) FROM dual)
AND SALES_ORDER_NO = #{salesOrderNo}

]]>
</select>


  <select id="selectOrderInfo" parameterType="Map" resultType="egovMap">
<![CDATA[


                  SELECT DISTINCT A.SALES_ORD_NO AS SALES_ORDER_NO
                        ,A.APP_TYPE_ID AS APP_TYPE
                        ,D.TYPE_ID AS customer_Type
                        ,D.CORP_TYPE_ID AS CORP_TYPE_ID
                        ,F.STK_CODE AS product_Code



                  from SAL0001D A
                    JOIN SAL0002D B ON B.SALES_ORD_ID = A.SALES_ORD_ID
                    JOIN SAL0027D C ON C.CUST_ID = A.CUST_ID
                    JOIN SAL0029D D ON D.CUST_ID = A.CUST_ID
                    JOIN SAL0095D E ON E.SRV_SALES_ORD_ID = A.SALES_ORD_ID
                    JOIN SYS0026M F ON B.ITM_STK_ID = F.STK_ID
                    LEFT JOIN PAY0053S S ON S.ACC_DEBT_ORD_ID = A.SALES_ORD_ID

                  where A.SALES_ORD_NO = #{salesOrderNo}
                  AND C.STUS_CODE_ID = 9

]]>
</select>

</mapper>