<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.services.performanceMgmt.impl.SurveyMgmtMapper">
    
    <select id="selectMemberTypeList"  parameterType="Map" resultType="egovMap">
        SELECT CODE_NAME 
        FROM SYS0013M 
        WHERE CODE_MASTER_ID = 1
    </select>
    
    <select id="selectSurveyStusList"  parameterType="Map" resultType="egovMap">
        SELECT CODE_NAME 
        FROM SYS0013M 
        WHERE CODE_MASTER_ID = 388
    </select>
    
    
    <select id="selectSurveyEventList" parameterType="Map" resultType="egovMap">
	<![CDATA[
		SELECT A.EVT_TYPE_DESC, B.MEM_CODE, C.CODE_DESC, A.EVT_DT
        FROM CCR0001D A, ORG0001D B, SYS0013M C
        WHERE A.HC_TYPE_ID = 2718
        AND A.EVT_MEM_ID = B.MEM_ID
        AND B.MEM_TYPE = C.CODE_ID
        AND B.MEM_TYPE = 1
		]]>
		<if test="cmbMemberTypeId != null and cmbMemberTypeId != '' ">
        AND C.CODE_DESC = #{cmbMemberTypeId}
        </if>
		<if test="eventName != null and eventName != '' ">
		AND A.EVT_TYPE_DESC LIKE '%' || #{eventName} || '%'
		</if>
		<if test="eventDate != null and eventDate != '' ">
		<![CDATA[ AND TO_DATE(TO_CHAR(A.EVT_DT,'YYYY-MM-DD'),'YYYY-MM-DD') > TO_DATE(#{eventDate}, 'DD/MM/YYYY') ]]>
		</if>
		<if test="eventMemCode != null and eventMemCode != '' ">
		AND B.MEM_CODE = #{eventMemCode}
		</if>
	</select>
	
	
	<insert id="addSurveyEventCreate" parameterType="Map">
        INSERT INTO CCR0001D (
            HC_ID
            , HCSOID
            , HC_CALL_ENTRY_ID
            , HC_TYPE_NO
            , HC_TYPE_ID
            , HC_STUS_ID
            , HC_COMMENT_TYPE_ID
            , HC_COMMENT_GID
            , HC_COMMENT_SID
            , HC_COMMENT_DID
            , CRT_USER_ID
            , CRT_DT
            , UPD_USER_ID
            , UPD_DT
            , HC_NO_SVC
            , HC_LOK
            , HC_CLOS_ID
            , EVT_COMP_RQST_DATE
            , EVT_COMP_RATE
            , EVT_TYPE_DESC
            , EVT_MEM_ID
            , EVT_DT
        )
       VALUES(
           CCR0001D_HC_ID_SEQ.NEXTVAL
           , 2718
           , 0
           , 2718
           , 2718
           , 33
           , 0
           , 0
           , 0
           , 0
           , #{crtUserId}
           , SYSDATE
           , #{updUserId}
           , SYSDATE        
           , 0
           , 1
           , 81
           , #{evtCompRqstDate}
           , #{evtCompRate}
           , #{evtTypeDesc}
           , #{evtMemId}
           , #{evtDt}
       )
	</insert>
	
	 <select id="selectCodeNameList" parameterType="Map" resultType="egovMap">
        SELECT CODE_NAME 
        FROM SYS0013M 
        WHERE CODE_MASTER_ID = 102
    </select>
    
</mapper>