<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.payment.otherpayment.service.impl.OtherPaymentMapper">
    
    <select id="selectBankStatementList" parameterType="Map" resultType="egovMap">
              SELECT
                       A.F_TRNSC_ID id,
                       C.NAME BANK,
                       D.ACC_DESC BANK_ACC_NAME,
                       A.F_TRNSC_DT TRNSC_DT,
                       A.F_TRNSC_REF_CHQ_NO CHQ_NO,
                       A.F_TRNSC_REF_VA_NO,
                       A.F_TRNSC_REF3 REF3,
                       A.F_TRNSC_REF1 REF1,
                       A.F_TRNSC_REF4 REF4,
                       A.F_TRNSC_REF2 REF2,
                       A.F_TRNSC_REF6 REF6,
                       A.F_TRNSC_REM TYPE,
                       A.F_TRNSC_DEBT_AMT DEBT,
                       A.F_TRNSC_CRDIT_AMT CRDIT,
                       <!--(CASE WHEN B.F_BANK_JRNL_STUS_ID = 1  THEN 'Mapped' ELSE 'UnMapped' END) STUS
                        B.POSTNG_DT MTCH_DT,-->
                       (CASE WHEN A.OTH_KEYIN_STUS_ID = 4 THEN 'Mapped' ELSE 'UnMapped' END) STUS,
                       A.OTH_KEYIN_MAPPING_DT,
                       A.F_TRNSC_TELLER_ID,
                       A.F_TRNSC_NEW_CHQ_NO
              FROM PAY0081D A 
              JOIN PAY0079D B on A.F_BANK_JRNL_ID = B.F_BANK_JRNL_ID
         LEFT JOIN SYS0004M C on B.BANK_ID = C.BANK_ID
         LEFT JOIN SYS0001M D on B.F_BANK_JRNL_ACC_ID = D.ACC_ID <!-- AND (D.IS_PAY_CASH = 1 OR D.IS_PAY_ONLINE = 1 OR IS_PAY_CHQ = 1)-->
         WHERE A.F_TRNSC_REM IN ('ONL','CSH','CHQ')
		 <if test="bankDateFr != null and bankDateFr != '' and bankDateTo != null and bankDateTo != '' ">
		        AND A.F_TRNSC_DT  <![CDATA[>= ]]> TO_DATE(#{bankDateFr}, 'DD/MM/YYYY')
		        AND A.F_TRNSC_DT  <![CDATA[<]]> TO_DATE(#{bankDateTo}, 'DD/MM/YYYY') + 1
		 </if>
		 <if test="searchPayType != null and searchPayType != '' and searchPayType != 'ALL' ">
		        AND A.F_TRNSC_REM = #{searchPayType}
		 </if>
		 <if test="searchBankAcc != null and searchBankAcc != '' ">
		        AND B.F_BANK_JRNL_ACC_ID = #{searchBankAcc}
		 </if>
		 <if test="searchVa != null and searchVa != '' ">
		        AND A.F_TRNSC_REF_VA_NO = #{searchVa}
		 </if> 
    </select>

</mapper>