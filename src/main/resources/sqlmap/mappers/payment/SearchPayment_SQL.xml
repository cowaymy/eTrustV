<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.coway.trust.biz.payment.payment.service.impl.SearchPaymentMapper">
      
    <!--CRC Statement Transaction 리스트 조회  -->
    <select id="selectOrderList" parameterType="Map" resultType="egovMap">
        SELECT
            TRX_ID,
			TRX_DT,
			TRX_AMT,
			PAY_ID,
			OR_NO,
			TR_NO,
			PAY_DT,
			LAST_UPD_DT,
			PAY_TYPE_ID,
			PAY_TYPE_NAME,
			LAST_UPD_USER_ID,
			LAST_UPD_USER_NAME,
			SALES_ORD_ID,
			SALES_ORD_NO,
			OR_AMT,
			PO_NO,
			CLCTR_BRNCH_ID,
			CLCTR_BRNCH_CODE,
			CLCTR_BRNCH_NAME,
			CUST_ID,
			CUST_NAME,
			CUST_IC,
			CUST_TYPE_ID,
			CUST_TYPE_NAME,
			PRODUCT_CTGRY_ID,
			PRODUCT_CTGRY_NAME,
			PRODUCT_ID,
			PRODUCT_CODE,
			PRODUCT_DESC,
			KEYIN_USER_ID,
			KEYIN_USER_NAME,
			APP_TYPE_ID,
			APP_TYPE_NAME,
			CLCTR_NAME,
			CLCTR_CODE,
			KEYIN_BRNCH_ID,
			KEYIN_BRNCH_CODE,
			KEYIN_BRNCH_NAME,
			DEBTOR_ACC_ID,
			DEBTOR_ACC_CODE,
			DEBTOR_ACC_DESC,
			SALES_MEM_ID,
			SALES_MEM_CODE,
			SALES_MEM_NAME,
			VIRTL_ACC_NO,
			HP_CODE,
			HP_NAME,
			HP_ID,
			CLCTR_ID,
			ALLOW_COMM,
			ADV_MONTH,
			TR_ISSU_DT,
			BATCH_PAY_ID
    FROM           
        PAY1001V 
    WHERE
        1=1
        <if test="orderNo != ''">
		  AND SALES_ORD_NO = #{orderNo}
        </if>
        <if test="payDate1 != '' and payDate2 != '' "> 
			AND PAY_DT  <![CDATA[   >= ]]> TO_DATE(TO_CHAR(TO_DATE(#{payDate1},'DD/MM/YYYY'),'YYYYMMDD') || '000000','yyyymmddhh24miss')
	        AND PAY_DT  <![CDATA[  < ]]>  TO_DATE(TO_CHAR(TO_DATE(#{payDate2},'DD/MM/YYYY'),'YYYYMMDD') || '000000','yyyymmddhh24miss') + 1
		</if>
        <if test="applicationType != ''"> 
		AND APP_TYPE_ID = #{applicationType}
		</if>
        <if test="orNo != ''"> 
		AND OR_NO = #{orNo} 
		</if>
        <if test="poNo != ''">
		AND PO_NO = #{poNo} 
		</if>
        <if test="paymentType != ''">
		AND PAY_TYPE_ID = #{paymentType}
		</if>
        <if test="customerId != ''"> 
		AND CUST_ID = #{customerId}
		</if>
        <if test="branchId != ''"> 
		AND KEYIN_BRNCH_ID = #{branchId}
		</if>
        <if test="userId != ''"> 
		AND KEYIN_USER_ID = #{userId}
		</if>
        <if test="customerName != ''"> 
		AND CUST_NAME LIKE '%' || #{customerName} || '%'
		</if>
        <if test="customerIC != ''">
		AND CUST_IC = #{customerIC}
		</if>
        <if test="trNo != ''"> 
		AND TR_NO = #{trNo}
		</if>
        <if test="chequeNo != ''"> 
		AND PAY_ID IN (SELECT PAY_ID from PAY0065D WHERE PAY_ITM_CHQ_NO = #{chequeNo})
		</if>
        <if test="crcNo != ''">
		AND PAY_ID IN (SELECT PAY_ID from PAY0065D WHERE PAY_ITM_ORI_CC_NO = #{crcNo})
		</if>
        <if test="bankAccount != ''">
		AND PAY_ID IN (SELECT PAY_ID from PAY0065D WHERE PAY_ITM_ISSU_BANK_ID = #{bankAccount})
		</if>
        <if test="batchPaymentId != '' ">
		AND BATCH_PAY_ID = #{batchPaymentId}
		</if>
                      
    </select>
     
 

</mapper>